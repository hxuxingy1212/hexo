<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="å¾é‘«"><meta name="copyright" content="å¾é‘«"><meta name="generator" content="Hexo 5.4.2"><meta name="theme" content="hexo-theme-yun"><title>mysql | å¾é‘«çš„ç¬”è®°</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.3.3/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":"å¾é‘«çš„ç¬”è®°","version":"1.10.6","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="åŸºç¡€ç¯‡SQL1.ä»€ä¹ˆæ˜¯SQLï¼Ÿ     Structured Query Languageï¼šç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€     å…¶å®å°±æ˜¯å®šä¹‰äº†æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ã€‚æ¯ä¸€ç§æ•°æ®åº“æ“ä½œçš„æ–¹å¼å­˜åœ¨ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œç§°ä¸ºâ€œæ–¹è¨€â€ã€‚      2.SQLé€šç”¨è¯­æ³•     1. SQL è¯­å¥å¯ä»¥å•è¡Œæˆ–å¤šè¡Œä¹¦å†™ï¼Œä»¥åˆ†å·ç»“å°¾ã€‚     2. å¯ä½¿ç”¨ç©ºæ ¼å’Œç¼©è¿›æ¥å¢å¼ºè¯­å¥çš„å¯è¯»æ€§ã€‚     3. MySQL">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql">
<meta property="og:url" content="http://example.com/2022/10/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/index.html">
<meta property="og:site_name" content="å¾é‘«çš„ç¬”è®°">
<meta property="og:description" content="åŸºç¡€ç¯‡SQL1.ä»€ä¹ˆæ˜¯SQLï¼Ÿ     Structured Query Languageï¼šç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€     å…¶å®å°±æ˜¯å®šä¹‰äº†æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ã€‚æ¯ä¸€ç§æ•°æ®åº“æ“ä½œçš„æ–¹å¼å­˜åœ¨ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œç§°ä¸ºâ€œæ–¹è¨€â€ã€‚      2.SQLé€šç”¨è¯­æ³•     1. SQL è¯­å¥å¯ä»¥å•è¡Œæˆ–å¤šè¡Œä¹¦å†™ï¼Œä»¥åˆ†å·ç»“å°¾ã€‚     2. å¯ä½¿ç”¨ç©ºæ ¼å’Œç¼©è¿›æ¥å¢å¼ºè¯­å¥çš„å¯è¯»æ€§ã€‚     3. MySQL">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220606144953211.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220606145351734.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220606171518133.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220606173029853.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220606173722658.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220606180128967.png">
<meta property="og:image" content="https://hexo.xuxin.world/mysql/image-20220607170326819.png">
<meta property="og:image" content="https://hexo.xuxin.world/mysql/image-20220607172639423.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220607173942982.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220607224756131.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220607225025706.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220607230211908.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220607230506451.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220607230826013.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220607231021039.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220608000646347.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220608000758020.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220608001308148.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220609181121685.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220609181148669.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220609181210985.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220609191955401.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220611230435016.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220613021834174.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220613021847582.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220613023057649.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220613025941308.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220613030048567.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220613222348015.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220614010615268.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220614010919117.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220614011234113.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220620164103763.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220620170315495.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220620170930571.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220620171105766.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220620171422232.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220620171438199.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220620172159103.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220621132624873.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220621162235073.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220621163153114.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220622101706490.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220622104826321.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220622144220884.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220622151841459.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220622163256618.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220622163615173.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220622164125006.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220623092713677.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628223754338.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628224340402.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628224315561.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628231518331.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628231651860.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628231810340.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628231854778.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628232121270.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628232444533.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628232759934.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628232708998.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628233248849.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628233304222.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628233820501.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628234023488.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628234640756.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628234944579.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628235201813.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628235320598.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628235538984.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220628235633481.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629000323248.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629000358001.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629000638443.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629002311075.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629093836872.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629094116269.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629094621248.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629094823250.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629095747304.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629100215918.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629100315109.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629100402781.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629100529260.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629100630444.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629100842850.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629101204517.png">
<meta property="og:image" content="http://hexo.xuxin.world/mysql/image-20220629101426171.png">
<meta property="article:published_time" content="2022-10-31T01:55:35.827Z">
<meta property="article:modified_time" content="2022-11-03T03:41:52.218Z">
<meta property="article:author" content="å¾é‘«">
<meta property="article:tag" content="xuxin">
<meta property="article:tag" content="Blog">
<meta property="article:tag" content="å¾é‘«">
<meta property="article:tag" content="åšå®¢">
<meta property="article:tag" content="å¾é‘«çš„ç¬”è®°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hexo.xuxin.world/mysql/image-20220606144953211.png"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="å¾é‘«"><img width="96" loading="lazy" src="/images/touxiang2.jpg" alt="å¾é‘«"><span class="site-author-status" title="ä¸æƒ³ä¸Šå­¦">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">å¾é‘«</a></div><span class="site-name">å¾é‘«çš„ç¬”è®°</span><sub class="site-subtitle"></sub><div class="site-description">è®°å½•æ¯ä¸€å¤©æ‰€å­¦</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">22</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">14</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">12</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://qun.qq.com/qqweb/qunpro/share?_wv=3&amp;_wwv=128&amp;appChannel=share&amp;inviteCode=28OEdR&amp;appChannel=share&amp;businessType=9&amp;from=246610&amp;biz=ka" title="QQ é¢‘é“ - å°äº‘ä¹‹å®¶" target="_blank" style="color:#12B7F5"><span class="icon iconify" data-icon="ri:qq-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/YunYouJun" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://cdn.yunyoujun.cn/img/about/white-qrcode-and-search.jpg" title="å¾®ä¿¡" target="_blank" style="color:#1AAD19"><span class="icon iconify" data-icon="ri:wechat-2-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@yunyoujun.cn" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/albums/" title="ç›¸å†Œ" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:camera-fill"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%AF%87"><span class="toc-number">1.</span> <span class="toc-text">åŸºç¡€ç¯‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL"><span class="toc-number">1.1.</span> <span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DDL-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="toc-number">1.1.1.</span> <span class="toc-text">DDL:æ“ä½œæ•°æ®åº“è¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DML-%E5%A2%9E%E5%88%A0%E6%94%B9%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">DML:å¢åˆ æ”¹è¡¨æ•°æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DQL-%E6%9F%A5%E8%AF%A2%E8%A1%A8%E8%AE%B0%E5%BD%95"><span class="toc-number">1.1.3.</span> <span class="toc-text">DQL:æŸ¥è¯¢è¡¨è®°å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DCL-%E7%94%A8%E6%88%B7-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.4.</span> <span class="toc-text">DCL:ç”¨æˆ·,æƒé™ç®¡ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">å­—ç¬¦ä¸²å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.2.</span> <span class="toc-text">æ•°å€¼å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.3.</span> <span class="toc-text">æ—¥æœŸå‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.4.</span> <span class="toc-text">æµç¨‹å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.3.</span> <span class="toc-text">çº¦æŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.</span> <span class="toc-text">å¤šè¡¨æŸ¥è¯¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="toc-number">1.4.1.</span> <span class="toc-text">å¤šè¡¨å…³ç³»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%AF%B9%E4%B8%80"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">ä¸€å¯¹ä¸€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%AF%B9%E5%A4%9A"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">ä¸€å¯¹å¤š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E5%AF%B9%E5%A4%9A"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">å¤šå¯¹å¤š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.2.</span> <span class="toc-text">è¿æ¥æŸ¥è¯¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">å†…è¿æ¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">å¤–è¿æ¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">è‡ªè¿æ¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.3.</span> <span class="toc-text">è”åˆæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2-%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.4.</span> <span class="toc-text">å­æŸ¥è¯¢(åµŒå¥—æŸ¥è¯¢)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">1.5.</span> <span class="toc-text">äº‹åŠ¡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E7%AF%87"><span class="toc-number">2.</span> <span class="toc-text">è¿›é˜¶ç¯‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">2.1.</span> <span class="toc-text">å­˜å‚¨å¼•æ“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.1.</span> <span class="toc-text">mysqlä½“ç³»ç»“æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InnoDB"><span class="toc-number">2.1.2.</span> <span class="toc-text">InnoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyISAM"><span class="toc-number">2.1.3.</span> <span class="toc-text">MyISAM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Memory"><span class="toc-number">2.1.4.</span> <span class="toc-text">Memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">2.1.5.</span> <span class="toc-text">å­˜å‚¨å¼•æ“çš„é€‰æ‹©</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">2.2.</span> <span class="toc-text">ç´¢å¼•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%A6%82%E8%BF%B0"><span class="toc-number">2.2.1.</span> <span class="toc-text">ç´¢å¼•æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84"><span class="toc-number">2.2.2.</span> <span class="toc-text">ç´¢å¼•ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#B-tree-%E5%A4%9A%E8%B7%AF%E5%B9%B3%E8%A1%A1%E6%9F%A5%E6%89%BE%E6%A0%91"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">B-tree:å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B-tree"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">B+tree</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mysql%E4%B8%ADB-tree"><span class="toc-number">2.2.2.3.</span> <span class="toc-text">mysqlä¸­B+tree</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hash%E7%B4%A2%E5%BC%95"><span class="toc-number">2.2.2.4.</span> <span class="toc-text">Hashç´¢å¼•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-number">2.2.2.5.</span> <span class="toc-text">é¢è¯•é¢˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">2.2.3.</span> <span class="toc-text">ç´¢å¼•åˆ†ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E8%AF%AD%E6%B3%95"><span class="toc-number">2.2.4.</span> <span class="toc-text">ç´¢å¼•è¯­æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">2.2.5.</span> <span class="toc-text">SQLæ€§èƒ½åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%89%A7%E8%A1%8C%E9%A2%91%E6%AC%A1"><span class="toc-number">2.2.5.1.</span> <span class="toc-text">æŸ¥çœ‹æ‰§è¡Œé¢‘æ¬¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-number">2.2.5.2.</span> <span class="toc-text">æ…¢æŸ¥è¯¢æ—¥å¿—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mysql%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F"><span class="toc-number">2.2.5.3.</span> <span class="toc-text">mysqlå¯åŠ¨æŠ¥é”™æ€ä¹ˆåŠï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2profile"><span class="toc-number">2.2.5.4.</span> <span class="toc-text">æŸ¥è¯¢profile</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bexplain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="toc-number">2.2.5.5.</span> <span class="toc-text">æŸ¥çœ‹explainæ‰§è¡Œè®¡åˆ’</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8"><span class="toc-number">2.2.6.</span> <span class="toc-text">ç´¢å¼•ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="toc-number">2.2.7.</span> <span class="toc-text">ç´¢å¼•è®¾è®¡åŸåˆ™</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.</span> <span class="toc-text">SQLä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.1.</span> <span class="toc-text">æ’å…¥ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.2.</span> <span class="toc-text">ä¸»é”®ä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B5%E5%88%86%E8%A3%82"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">é¡µåˆ†è£‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B5%E5%90%88%E5%B9%B6"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">é¡µåˆå¹¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">ä¸»é”®è®¾è®¡åŸåˆ™</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#orderby%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.3.</span> <span class="toc-text">orderbyä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#groupby%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.4.</span> <span class="toc-text">groupbyä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#limit%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.5.</span> <span class="toc-text">limitä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#count%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.6.</span> <span class="toc-text">countä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Update%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.7.</span> <span class="toc-text">Updateä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">2.3.8.</span> <span class="toc-text">å¤šè¡¨æŸ¥è¯¢ä¼˜åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.4.</span> <span class="toc-text">å­˜å‚¨å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">2.4.1.</span> <span class="toc-text">è§†å›¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">2.4.2.</span> <span class="toc-text">å­˜å‚¨è¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">2.4.2.1.</span> <span class="toc-text">åŸºæœ¬ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">2.4.2.2.</span> <span class="toc-text">å˜é‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">2.4.2.3.</span> <span class="toc-text">æµç¨‹æ§åˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%E4%B8%8E%E6%9D%A1%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.4.2.4.</span> <span class="toc-text">æ¸¸æ ‡ä¸æ¡ä»¶å¤„ç†ç¨‹åº</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">2.4.3.</span> <span class="toc-text">å­˜å‚¨å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">2.4.4.</span> <span class="toc-text">è§¦å‘å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%81"><span class="toc-number">2.5.</span> <span class="toc-text">é”</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">2.5.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E9%94%81"><span class="toc-number">2.5.2.</span> <span class="toc-text">å…¨å±€é”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%BA%A7%E9%94%81"><span class="toc-number">2.5.3.</span> <span class="toc-text">è¡¨çº§é”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E9%94%81"><span class="toc-number">2.5.3.1.</span> <span class="toc-text">è¡¨é”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE%E9%94%81"><span class="toc-number">2.5.3.2.</span> <span class="toc-text">å…ƒæ•°æ®é”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%84%8F%E5%90%91%E9%94%81"><span class="toc-number">2.5.3.3.</span> <span class="toc-text">æ„å‘é”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E7%BA%A7%E9%94%81"><span class="toc-number">2.5.4.</span> <span class="toc-text">è¡Œçº§é”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95%E9%94%81"><span class="toc-number">2.5.4.1.</span> <span class="toc-text">è®°å½•é”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B4%E9%9A%99%E9%94%81-%E4%B8%B4%E9%97%B4%E9%94%81"><span class="toc-number">2.5.4.2.</span> <span class="toc-text">é—´éš™é”&#x2F;ä¸´é—´é”</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#InnoDB%E5%BC%95%E6%93%8E"><span class="toc-number">2.6.</span> <span class="toc-text">InnoDBå¼•æ“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="toc-number">2.6.1.</span> <span class="toc-text">é€»è¾‘å­˜å‚¨ç»“æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">2.6.2.</span> <span class="toc-text">æ¶æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E6%9E%B6%E6%9E%84"><span class="toc-number">2.6.2.1.</span> <span class="toc-text">å†…å­˜æ¶æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E6%9E%B6%E6%9E%84"><span class="toc-number">2.6.2.2.</span> <span class="toc-text">ç£ç›˜æ¶æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E7%BA%BF%E7%A8%8B"><span class="toc-number">2.6.2.3.</span> <span class="toc-text">åå°çº¿ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%8E%9F%E7%90%86"><span class="toc-number">2.6.3.</span> <span class="toc-text">äº‹åŠ¡åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#redo-log"><span class="toc-number">2.6.3.1.</span> <span class="toc-text">redo log</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undo-log"><span class="toc-number">2.6.3.2.</span> <span class="toc-text">undo log</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MVCC"><span class="toc-number">2.6.4.</span> <span class="toc-text">MVCC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%90%E5%BC%8F%E5%AD%97%E6%AE%B5"><span class="toc-number">2.6.4.1.</span> <span class="toc-text">éšå¼å­—æ®µ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undo-log-1"><span class="toc-number">2.6.4.2.</span> <span class="toc-text">undo log</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#readview"><span class="toc-number">2.6.4.3.</span> <span class="toc-text">readview</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93"><span class="toc-number">2.6.5.</span> <span class="toc-text">äº‹åŠ¡åŸç†æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql%E7%AE%A1%E7%90%86"><span class="toc-number">2.7.</span> <span class="toc-text">Mysqlç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.7.1.</span> <span class="toc-text">ç³»ç»Ÿæ•°æ®åº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql"><span class="toc-number">2.7.2.</span> <span class="toc-text">mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqladmin"><span class="toc-number">2.7.3.</span> <span class="toc-text">mysqladmin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqlbinlog"><span class="toc-number">2.7.4.</span> <span class="toc-text">mysqlbinlog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqlshow"><span class="toc-number">2.7.5.</span> <span class="toc-text">mysqlshow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqldump"><span class="toc-number">2.7.6.</span> <span class="toc-text">mysqldump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqlimport-source"><span class="toc-number">2.7.7.</span> <span class="toc-text">mysqlimport&#x2F;source</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%90%E7%BB%B4%E7%AF%87"><span class="toc-number">3.</span> <span class="toc-text">è¿ç»´ç¯‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97"><span class="toc-number">3.1.</span> <span class="toc-text">æ—¥å¿—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-number">3.1.1.</span> <span class="toc-text">é”™è¯¯æ—¥å¿—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97"><span class="toc-number">3.1.2.</span> <span class="toc-text">äºŒè¿›åˆ¶æ—¥å¿—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-number">3.1.3.</span> <span class="toc-text">æŸ¥è¯¢æ—¥å¿—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97-1"><span class="toc-number">3.1.4.</span> <span class="toc-text">æ…¢æŸ¥è¯¢æ—¥å¿—</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">3.2.</span> <span class="toc-text">ä¸»ä»å¤åˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">3.2.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">3.2.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA"><span class="toc-number">3.2.3.</span> <span class="toc-text">æ­å»º</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8"><span class="toc-number">3.3.</span> <span class="toc-text">åˆ†åº“åˆ†è¡¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">3.3.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mycat"><span class="toc-number">3.3.2.</span> <span class="toc-text">mycat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mycat%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">mycaté…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E5%88%86%E5%BA%93"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">å‚ç›´åˆ†åº“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%89%87%E8%A7%84%E5%88%99"><span class="toc-number">3.3.2.3.</span> <span class="toc-text">åˆ†ç‰‡è§„åˆ™</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8C%83%E5%9B%B4%E5%88%86%E7%89%87"><span class="toc-number">3.3.2.3.1.</span> <span class="toc-text">èŒƒå›´åˆ†ç‰‡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%96%E6%A8%A1%E5%88%86%E7%89%87"><span class="toc-number">3.3.2.3.2.</span> <span class="toc-text">å–æ¨¡åˆ†ç‰‡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C"><span class="toc-number">3.3.2.3.3.</span> <span class="toc-text">ä¸€è‡´æ€§å“ˆå¸Œ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="toc-number">3.3.2.3.4.</span> <span class="toc-text">æšä¸¾</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E6%8C%87%E5%AE%9A"><span class="toc-number">3.3.2.4.</span> <span class="toc-text">åº”ç”¨æŒ‡å®š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E5%88%86%E7%89%87-hash%E7%AE%97%E6%B3%95"><span class="toc-number">3.3.2.5.</span> <span class="toc-text">å›ºå®šåˆ†ç‰‡-hashç®—æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2hash%E8%A7%A3%E6%9E%90"><span class="toc-number">3.3.2.6.</span> <span class="toc-text">å­—ç¬¦ä¸²hashè§£æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E5%A4%A9%E5%88%86%E7%89%87"><span class="toc-number">3.3.2.7.</span> <span class="toc-text">æŒ‰å¤©åˆ†ç‰‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E8%87%AA%E7%84%B6%E6%9C%88%E5%88%86%E7%89%87"><span class="toc-number">3.3.2.8.</span> <span class="toc-text">æŒ‰è‡ªç„¶æœˆåˆ†ç‰‡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mycat%E7%9A%84%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7"><span class="toc-number">3.3.3.</span> <span class="toc-text">mycatçš„ç®¡ç†ä¸ç›‘æ§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB"><span class="toc-number">3.4.</span> <span class="toc-text">è¯»å†™åˆ†ç¦»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%BB%E4%B8%80%E4%B8%9B"><span class="toc-number">3.4.1.</span> <span class="toc-text">ä¸€ä¸»ä¸€ä¸›</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E4%B8%BB%E5%8F%8C%E4%BB%8E"><span class="toc-number">3.4.2.</span> <span class="toc-text">åŒä¸»åŒä»</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">4.</span> <span class="toc-text">å…¶ä»–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E8%AE%B0%E5%BD%95%E6%97%A5%E5%BF%97"><span class="toc-number">4.1.</span> <span class="toc-text">AOPè®°å½•æ—¥å¿—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">4.2.</span> <span class="toc-text">ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E4%B8%AD%E7%9A%84ORDER-BY-field"><span class="toc-number">4.3.</span> <span class="toc-text">MySQLä¸­çš„ORDER BY field</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8F%82%E6%95%B0"><span class="toc-number">4.4.</span> <span class="toc-text">é…ç½®æ–‡ä»¶å‚æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-number">4.5.</span> <span class="toc-text">äº‹ä»¶(å®šæ—¶ä»»åŠ¡)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%8C%BA"><span class="toc-number">4.6.</span> <span class="toc-text">åˆ†åŒº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E5%90%88%E4%B8%BB%E9%94%AE"><span class="toc-number">4.7.</span> <span class="toc-text">å¤åˆä¸»é”®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="toc-number">4.8.</span> <span class="toc-text">å…¶ä»–å‡½æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%8C%87%E4%BB%A4"><span class="toc-number">4.9.</span> <span class="toc-text">å…¶ä»–æŒ‡ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.9.1.</span> <span class="toc-text">æ•°æ®åº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">4.9.2.</span> <span class="toc-text">æ•°æ®è¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B"><span class="toc-number">4.9.3.</span> <span class="toc-text">è¿›ç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96-1"><span class="toc-number">4.9.4.</span> <span class="toc-text">å…¶ä»–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSV%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.10.</span> <span class="toc-text">CSVå­˜å‚¨å¼•æ“çš„ä½¿ç”¨</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://example.com/2022/10/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="å¾é‘«"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="å¾é‘«çš„ç¬”è®°"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">mysql</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2022-10-31 09:55:35" itemprop="dateCreated datePublished" datetime="2022-10-31T09:55:35+08:00">2022-10-31</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-11-03 11:41:52" itemprop="dateModified" datetime="2022-11-03T11:41:52+08:00">2022-11-03</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">æ•°æ®åº“</span></a></span></span></div><div class="post-author"><span class="author-name">å¾é‘«</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body">
<div class="markmap-container" style="height:500px">
  <svg data="{&quot;t&quot;:&quot;root&quot;,&quot;d&quot;:0,&quot;v&quot;:&quot;&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;åŸºç¡€&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[2,3]},&quot;v&quot;:&quot;SQL&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[3,4]},&quot;v&quot;:&quot;å‡½æ•°&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[4,5]},&quot;v&quot;:&quot;çº¦æŸ&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;å¤šè¡¨æŸ¥è¯¢&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[6,7]},&quot;v&quot;:&quot;äº‹åŠ¡&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[7,8]},&quot;v&quot;:&quot;è¿›é˜¶&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[8,9]},&quot;v&quot;:&quot;å­˜å‚¨å¼•æ“&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[9,10]},&quot;v&quot;:&quot;ç´¢å¼•&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[10,11]},&quot;v&quot;:&quot;SQLä¼˜åŒ–&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[11,12]},&quot;v&quot;:&quot;å­˜å‚¨å¯¹è±¡&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[12,13]},&quot;v&quot;:&quot;é”&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[13,14]},&quot;v&quot;:&quot;InnoDBå¼•æ“&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[14,15]},&quot;v&quot;:&quot;Mysqlç®¡ç†&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[15,16]},&quot;v&quot;:&quot;åŸç†&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[16,17]},&quot;v&quot;:&quot;æ—¥å¿—&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[17,18]},&quot;v&quot;:&quot;ä¸»ä»å¤åˆ¶&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[18,19]},&quot;v&quot;:&quot;åˆ†åº“åˆ†è¡¨&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[19,20]},&quot;v&quot;:&quot;è¯»å†™åˆ†ç¦»&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[20,21]},&quot;v&quot;:&quot;å…¶ä»–&quot;}],&quot;p&quot;:{}}"></svg>
</div>



<h1 id="åŸºç¡€ç¯‡"><a href="#åŸºç¡€ç¯‡" class="headerlink" title="åŸºç¡€ç¯‡"></a><strong>åŸºç¡€ç¯‡</strong></h1><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a><strong>SQL</strong></h2><pre><code>1.ä»€ä¹ˆæ˜¯SQLï¼Ÿ
    Structured Query Languageï¼šç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€
    å…¶å®å°±æ˜¯å®šä¹‰äº†æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ã€‚æ¯ä¸€ç§æ•°æ®åº“æ“ä½œçš„æ–¹å¼å­˜åœ¨ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œç§°ä¸ºâ€œæ–¹è¨€â€ã€‚
    
2.SQLé€šç”¨è¯­æ³•
    1. SQL è¯­å¥å¯ä»¥å•è¡Œæˆ–å¤šè¡Œä¹¦å†™ï¼Œä»¥åˆ†å·ç»“å°¾ã€‚
    2. å¯ä½¿ç”¨ç©ºæ ¼å’Œç¼©è¿›æ¥å¢å¼ºè¯­å¥çš„å¯è¯»æ€§ã€‚
    3. MySQL æ•°æ®åº“çš„ SQL è¯­å¥ä¸åŒºåˆ†å¤§å°å†™ï¼Œå…³é”®å­—å»ºè®®ä½¿ç”¨å¤§å†™ã€‚
    4. 3 ç§æ³¨é‡Š
        * å•è¡Œæ³¨é‡Š: -- æ³¨é‡Šå†…å®¹ æˆ– # æ³¨é‡Šå†…å®¹(mysql ç‰¹æœ‰) 
        * å¤šè¡Œæ³¨é‡Š: /* æ³¨é‡Š */
    
3. SQLåˆ†ç±»
    1) DDL(Data Definition Language)æ•°æ®å®šä¹‰è¯­è¨€
        ç”¨æ¥å®šä¹‰æ•°æ®åº“å¯¹è±¡ï¼šæ•°æ®åº“ï¼Œè¡¨ï¼Œåˆ—ç­‰ã€‚å…³é”®å­—ï¼šcreate, drop,alter ç­‰
    2) DML(Data Manipulation Language)æ•°æ®æ“ä½œè¯­è¨€
        ç”¨æ¥å¯¹æ•°æ®åº“ä¸­è¡¨çš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹ã€‚å…³é”®å­—ï¼šinsert, delete, update ç­‰
    3) DQL(Data Query Language)æ•°æ®æŸ¥è¯¢è¯­è¨€
        ç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­è¡¨çš„è®°å½•(æ•°æ®)ã€‚å…³é”®å­—ï¼šselect, where ç­‰
    4) DCL(Data Control Language)æ•°æ®æ§åˆ¶è¯­è¨€(äº†è§£)
        ç”¨æ¥å®šä¹‰æ•°æ®åº“çš„è®¿é—®æƒé™å’Œå®‰å…¨çº§åˆ«ï¼ŒåŠåˆ›å»ºç”¨æˆ·ã€‚å…³é”®å­—ï¼šGRANTï¼Œ REVOKE ç­‰
</code></pre>
<h3 id="DDL-æ“ä½œæ•°æ®åº“è¡¨"><a href="#DDL-æ“ä½œæ•°æ®åº“è¡¨" class="headerlink" title="DDL:æ“ä½œæ•°æ®åº“è¡¨"></a><strong>DDL:æ“ä½œæ•°æ®åº“è¡¨</strong></h3><pre><code>1. æ“ä½œæ•°æ®åº“ï¼šCRUD
    1. C(Create):åˆ›å»º
        * åˆ›å»ºæ•°æ®åº“ï¼š
            * create database æ•°æ®åº“åç§°;
        * åˆ›å»ºæ•°æ®åº“ï¼Œåˆ¤æ–­ä¸å­˜åœ¨ï¼Œå†åˆ›å»ºï¼š
            * create database if not exists æ•°æ®åº“åç§°;
        * åˆ›å»ºæ•°æ®åº“ï¼Œå¹¶æŒ‡å®šå­—ç¬¦é›†
            * create database æ•°æ®åº“åç§° character set å­—ç¬¦é›†å;

        * ç»ƒä¹ ï¼š åˆ›å»ºdb4æ•°æ®åº“ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œå¹¶åˆ¶å®šå­—ç¬¦é›†ä¸ºgbk
            * create database if not exists db4 character set gbk;
    2. R(Retrieve)ï¼šæŸ¥è¯¢
        * æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“çš„åç§°:
            * show databases;
        * æŸ¥è¯¢æŸä¸ªæ•°æ®åº“çš„å­—ç¬¦é›†:æŸ¥è¯¢æŸä¸ªæ•°æ®åº“çš„åˆ›å»ºè¯­å¥
            * show create database æ•°æ®åº“åç§°;
    3. U(Update):ä¿®æ”¹
        * ä¿®æ”¹æ•°æ®åº“çš„å­—ç¬¦é›†
            * alter database æ•°æ®åº“åç§° character set å­—ç¬¦é›†åç§°;
    4. D(Delete):åˆ é™¤
        * åˆ é™¤æ•°æ®åº“
            * drop database æ•°æ®åº“åç§°;
        * åˆ¤æ–­æ•°æ®åº“å­˜åœ¨ï¼Œå­˜åœ¨å†åˆ é™¤
            * drop database if exists æ•°æ®åº“åç§°;
    5. ä½¿ç”¨æ•°æ®åº“
        * æŸ¥è¯¢å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“åç§°
            * select database();
        * ä½¿ç”¨æ•°æ®åº“
            * use æ•°æ®åº“åç§°;


2. æ“ä½œè¡¨
    1. C(Create):åˆ›å»º
        1. è¯­æ³•ï¼š
            create table è¡¨å(
                åˆ—å1 æ•°æ®ç±»å‹1,
                åˆ—å2 æ•°æ®ç±»å‹2,
                ....
                åˆ—ån æ•°æ®ç±»å‹n
            );
            * æ³¨æ„ï¼šæœ€åä¸€åˆ—ï¼Œä¸éœ€è¦åŠ é€—å·ï¼ˆ,ï¼‰
            * æ•°æ®åº“ç±»å‹ï¼š
                1. intï¼šæ•´æ•°ç±»å‹
                    * age int,
                2. double:å°æ•°ç±»å‹
                    * score double(5,2)
                3. date:æ—¥æœŸï¼ŒåªåŒ…å«å¹´æœˆæ—¥ï¼Œyyyy-MM-dd
                4. datetime:æ—¥æœŸï¼ŒåŒ…å«å¹´æœˆæ—¥æ—¶åˆ†ç§’     yyyy-MM-dd HH:mm:ss
                5. timestamp:æ—¶é—´é”™ç±»å‹    åŒ…å«å¹´æœˆæ—¥æ—¶åˆ†ç§’     yyyy-MM-dd HH:mm:ss    
                    * å¦‚æœå°†æ¥ä¸ç»™è¿™ä¸ªå­—æ®µèµ‹å€¼ï¼Œæˆ–èµ‹å€¼ä¸ºnullï¼Œåˆ™é»˜è®¤ä½¿ç”¨å½“å‰çš„ç³»ç»Ÿæ—¶é—´ï¼Œæ¥è‡ªåŠ¨èµ‹å€¼
                6. varcharï¼šå­—ç¬¦ä¸²
                    * name varchar(20):å§“åæœ€å¤§20ä¸ªå­—ç¬¦
                    * zhangsan 8ä¸ªå­—ç¬¦  å¼ ä¸‰ 2ä¸ªå­—ç¬¦
                    
        * åˆ›å»ºè¡¨
            create table student(
                id int,
                name varchar(32),
                age int ,
                score double(4,1),
                birthday date,
                insert_time timestamp
            );
        * å¤åˆ¶è¡¨ï¼š
            * create table è¡¨å like è¢«å¤åˆ¶çš„è¡¨å;          
    2. R(Retrieve)ï¼šæŸ¥è¯¢
        * æŸ¥è¯¢æŸä¸ªæ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨åç§°
            * show tables;
        * æŸ¥è¯¢è¡¨ç»“æ„
            * desc è¡¨å;
    3. U(Update):ä¿®æ”¹
        1. ä¿®æ”¹è¡¨å
            alter table è¡¨å rename to æ–°çš„è¡¨å;
        2. ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†
            alter table è¡¨å character set å­—ç¬¦é›†åç§°;
        3. æ·»åŠ ä¸€åˆ—
            alter table è¡¨å add åˆ—å æ•°æ®ç±»å‹;
        4. ä¿®æ”¹åˆ—åç§° ç±»å‹
            alter table è¡¨å change åˆ—å æ–°åˆ—åˆ« æ–°æ•°æ®ç±»å‹;
            alter table è¡¨å modify åˆ—å æ–°æ•°æ®ç±»å‹;
        5. åˆ é™¤åˆ—
            alter table è¡¨å drop åˆ—å;
    4. D(Delete):åˆ é™¤
        * drop table è¡¨å;
        * drop table  if exists è¡¨å ;
</code></pre>
<h3 id="DML-å¢åˆ æ”¹è¡¨æ•°æ®"><a href="#DML-å¢åˆ æ”¹è¡¨æ•°æ®" class="headerlink" title="DML:å¢åˆ æ”¹è¡¨æ•°æ®"></a><strong>DML:å¢åˆ æ”¹è¡¨æ•°æ®</strong></h3><pre><code>1. æ·»åŠ æ•°æ®ï¼š
    * è¯­æ³•ï¼š
        * insert into è¡¨å(åˆ—å1,åˆ—å2,...åˆ—ån) values(å€¼1,å€¼2,...å€¼n);
    * æ³¨æ„ï¼š
        1. åˆ—åå’Œå€¼è¦ä¸€ä¸€å¯¹åº”ã€‚
        2. å¦‚æœè¡¨ååï¼Œä¸å®šä¹‰åˆ—åï¼Œåˆ™é»˜è®¤ç»™æ‰€æœ‰åˆ—æ·»åŠ å€¼
            insert into è¡¨å values(å€¼1,å€¼2,...å€¼n);
        3. é™¤äº†æ•°å­—ç±»å‹ï¼Œå…¶ä»–ç±»å‹éœ€è¦ä½¿ç”¨å¼•å·(å•åŒéƒ½å¯ä»¥)å¼•èµ·æ¥
2. åˆ é™¤æ•°æ®ï¼š
    * è¯­æ³•ï¼š
        * delete from è¡¨å [where æ¡ä»¶]
    * æ³¨æ„ï¼š
        1. å¦‚æœä¸åŠ æ¡ä»¶ï¼Œåˆ™åˆ é™¤è¡¨ä¸­æ‰€æœ‰è®°å½•ã€‚
        2. å¦‚æœè¦åˆ é™¤æ‰€æœ‰è®°å½•
            1. delete from è¡¨å; -- ä¸æ¨èä½¿ç”¨ã€‚æœ‰å¤šå°‘æ¡è®°å½•å°±ä¼šæ‰§è¡Œå¤šå°‘æ¬¡åˆ é™¤æ“ä½œ
            2. TRUNCATE TABLE è¡¨å; -- æ¨èä½¿ç”¨ï¼Œæ•ˆç‡æ›´é«˜ å…ˆåˆ é™¤è¡¨ï¼Œç„¶åå†åˆ›å»ºä¸€å¼ ä¸€æ ·çš„è¡¨ã€‚
3. ä¿®æ”¹æ•°æ®ï¼š
    * è¯­æ³•ï¼š
        * update è¡¨å set åˆ—å1 = å€¼1, åˆ—å2 = å€¼2,... [where æ¡ä»¶];

    * æ³¨æ„ï¼š
        1. å¦‚æœä¸åŠ ä»»ä½•æ¡ä»¶ï¼Œåˆ™ä¼šå°†è¡¨ä¸­æ‰€æœ‰è®°å½•å…¨éƒ¨ä¿®æ”¹ã€‚
</code></pre>
<h3 id="DQL-æŸ¥è¯¢è¡¨è®°å½•"><a href="#DQL-æŸ¥è¯¢è¡¨è®°å½•" class="headerlink" title="DQL:æŸ¥è¯¢è¡¨è®°å½•"></a><strong>DQL:æŸ¥è¯¢è¡¨è®°å½•</strong></h3><pre><code>* select * from è¡¨å;

1. è¯­æ³•ï¼š
    select       4
        å­—æ®µåˆ—è¡¨
    from         1
        è¡¨ååˆ—è¡¨
    where        2
        æ¡ä»¶åˆ—è¡¨
    group by     3
        åˆ†ç»„å­—æ®µ
    having       3
        åˆ†ç»„ä¹‹åçš„æ¡ä»¶
    order by     5
        æ’åº
    limit        6
        åˆ†é¡µé™å®š

2. åŸºç¡€æŸ¥è¯¢
    1. å¤šä¸ªå­—æ®µçš„æŸ¥è¯¢
        select å­—æ®µå1ï¼Œå­—æ®µå2... from è¡¨åï¼›
        * æ³¨æ„ï¼š
            * å¦‚æœæŸ¥è¯¢æ‰€æœ‰å­—æ®µï¼Œåˆ™å¯ä»¥ä½¿ç”¨*æ¥æ›¿ä»£å­—æ®µåˆ—è¡¨ã€‚
    2. å»é™¤é‡å¤ï¼š
        * distinct
    3. è®¡ç®—åˆ—
        * ä¸€èˆ¬å¯ä»¥ä½¿ç”¨å››åˆ™è¿ç®—è®¡ç®—ä¸€äº›åˆ—çš„å€¼ã€‚ï¼ˆä¸€èˆ¬åªä¼šè¿›è¡Œæ•°å€¼å‹çš„è®¡ç®—ï¼‰
        * ifnull(è¡¨è¾¾å¼1,è¡¨è¾¾å¼2)ï¼šnullå‚ä¸çš„è¿ç®—ï¼Œè®¡ç®—ç»“æœéƒ½ä¸ºnull
            * è¡¨è¾¾å¼1ï¼šå“ªä¸ªå­—æ®µéœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºnull
            * å¦‚æœè¯¥å­—æ®µä¸ºnullåçš„æ›¿æ¢å€¼ã€‚
    4. èµ·åˆ«åï¼š
        * asï¼šasä¹Ÿå¯ä»¥çœç•¥

3. æ¡ä»¶æŸ¥è¯¢
    1. whereå­å¥åè·Ÿæ¡ä»¶
    2. è¿ç®—ç¬¦
        * &gt; ã€&lt; ã€&lt;= ã€&gt;= ã€= ã€&lt;&gt;
        * BETWEEN...AND  ï¼ˆæœ€å°æœ€å¤§å…¨åŒ…ï¼‰
        * IN( é›†åˆ) 
        * LIKEï¼šæ¨¡ç³ŠæŸ¥è¯¢
            * å ä½ç¬¦ï¼š
                * _:å•ä¸ªä»»æ„å­—ç¬¦
                * %ï¼šå¤šä¸ªä»»æ„å­—ç¬¦
        * IS NULL  
        * and  æˆ– &amp;&amp;
        * or  æˆ– || 
        * not  æˆ– !

4. èšåˆå‡½æ•°ï¼šå°†ä¸€åˆ—æ•°æ®ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œè¿›è¡Œçºµå‘çš„è®¡ç®—ã€‚
    1. countï¼šè®¡ç®—ä¸ªæ•°
        1. ä¸€èˆ¬é€‰æ‹©éç©ºçš„åˆ—ï¼šä¸»é”®
        2. count(*)
    2. maxï¼šè®¡ç®—æœ€å¤§å€¼
    3. minï¼šè®¡ç®—æœ€å°å€¼
    4. sumï¼šè®¡ç®—å’Œ
    5. avgï¼šè®¡ç®—å¹³å‡å€¼
* æ³¨æ„ï¼šèšåˆå‡½æ•°çš„è®¡ç®—ï¼Œæ’é™¤nullå€¼ã€‚
    è§£å†³æ–¹æ¡ˆï¼š
    1. é€‰æ‹©ä¸åŒ…å«éç©ºçš„åˆ—è¿›è¡Œè®¡ç®—
    2. IFNULLå‡½æ•°

5. åˆ†ç»„æŸ¥è¯¢:
    1. è¯­æ³•ï¼šgroup by åˆ†ç»„å­—æ®µï¼›
    2. æ³¨æ„ï¼š
        1. åˆ†ç»„ä¹‹åæŸ¥è¯¢çš„å­—æ®µï¼šåˆ†ç»„å­—æ®µã€èšåˆå‡½æ•°
        2. where å’Œ having çš„åŒºåˆ«ï¼Ÿ
            1. where åœ¨åˆ†ç»„ä¹‹å‰è¿›è¡Œé™å®šï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸å‚ä¸åˆ†ç»„ã€‚havingåœ¨åˆ†ç»„ä¹‹åè¿›è¡Œé™å®šï¼Œå¦‚æœä¸æ»¡è¶³ç»“æœï¼Œåˆ™ä¸ä¼šè¢«æŸ¥è¯¢å‡ºæ¥
            2. where åä¸å¯ä»¥è·Ÿèšåˆå‡½æ•°ï¼Œhavingå¯ä»¥è¿›è¡Œèšåˆå‡½æ•°çš„åˆ¤æ–­ã€‚

6. æ’åºæŸ¥è¯¢
    * è¯­æ³•ï¼šorder by å­å¥
        * order by æ’åºå­—æ®µ1 æ’åºæ–¹å¼1 ï¼Œ  æ’åºå­—æ®µ2 æ’åºæ–¹å¼2...
    * æ’åºæ–¹å¼ï¼š
        * ASCï¼šå‡åºï¼Œé»˜è®¤çš„ã€‚
        * DESCï¼šé™åºã€‚
    * æ³¨æ„ï¼š
        * å¦‚æœæœ‰å¤šä¸ªæ’åºæ¡ä»¶ï¼Œåˆ™å½“å‰è¾¹çš„æ¡ä»¶å€¼ä¸€æ ·æ—¶ï¼Œæ‰ä¼šåˆ¤æ–­ç¬¬äºŒæ¡ä»¶ã€‚

7. åˆ†é¡µæŸ¥è¯¢
    1. è¯­æ³•ï¼šlimit å¼€å§‹çš„ç´¢å¼•,æ¯é¡µæŸ¥è¯¢çš„æ¡æ•°;
    2. å…¬å¼ï¼šå¼€å§‹çš„ç´¢å¼• = ï¼ˆå½“å‰çš„é¡µç  - 1ï¼‰ * æ¯é¡µæ˜¾ç¤ºçš„æ¡æ•°
</code></pre>
<h3 id="DCL-ç”¨æˆ·-æƒé™ç®¡ç†"><a href="#DCL-ç”¨æˆ·-æƒé™ç®¡ç†" class="headerlink" title="DCL:ç”¨æˆ·,æƒé™ç®¡ç†"></a><strong>DCL:ç”¨æˆ·,æƒé™ç®¡ç†</strong></h3><ol>
<li><p>ç”¨æˆ·ç®¡ç†</p>
<pre><code> 1. æ·»åŠ ç”¨æˆ·ï¼š
     * è¯­æ³•ï¼šCREATE USER &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39; IDENTIFIED BY &#39;å¯†ç &#39;;
 2. åˆ é™¤ç”¨æˆ·ï¼š
     * è¯­æ³•ï¼šDROP USER &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;
 3. ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼š
     
     UPDATE USER SET PASSWORD = PASSWORD(&#39;æ–°å¯†ç &#39;) WHERE USER = &#39;ç”¨æˆ·å&#39;;
     UPDATE USER SET PASSWORD = PASSWORD(&#39;abc&#39;) WHERE USER = &#39;lisi&#39;;
     
     SET PASSWORD FOR &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39; = PASSWORD(&#39;æ–°å¯†ç &#39;);
     SET PASSWORD FOR &#39;root&#39;@&#39;localhost&#39; = PASSWORD(&#39;123&#39;);

     * mysqlä¸­å¿˜è®°äº†rootç”¨æˆ·çš„å¯†ç ï¼Ÿ
         1. cmd -- &gt; net stop mysql åœæ­¢mysqlæœåŠ¡
             * éœ€è¦ç®¡ç†å‘˜è¿è¡Œè¯¥cmd

         2. ä½¿ç”¨æ— éªŒè¯æ–¹å¼å¯åŠ¨mysqlæœåŠ¡ï¼š mysqld --skip-grant-tables
         3. æ‰“å¼€æ–°çš„cmdçª—å£,ç›´æ¥è¾“å…¥mysqlå‘½ä»¤ï¼Œæ•²å›è½¦ã€‚å°±å¯ä»¥ç™»å½•æˆåŠŸ
         4. use mysql;
         5. update user set password = password(&#39;ä½ çš„æ–°å¯†ç &#39;) where user = &#39;root&#39;;
         6. å…³é—­ä¸¤ä¸ªçª—å£
         7. æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œæ‰‹åŠ¨ç»“æŸmysqld.exe çš„è¿›ç¨‹
         8. å¯åŠ¨mysqlæœåŠ¡
         9. ä½¿ç”¨æ–°å¯†ç ç™»å½•ã€‚
 4. æŸ¥è¯¢ç”¨æˆ·ï¼š
     -- 1. åˆ‡æ¢åˆ°mysqlæ•°æ®åº“
     USE myql;
     -- 2. æŸ¥è¯¢userè¡¨
     SELECT * FROM USER;
</code></pre>
</li>
<li><p>æƒé™ç®¡ç†ï¼š</p>
<pre><code> 1. æŸ¥è¯¢æƒé™ï¼š
     -- æŸ¥è¯¢æƒé™
     SHOW GRANTS FOR &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;
     SHOW GRANTS FOR &#39;lisi&#39;@&#39;%&#39;;

 2. æˆäºˆæƒé™ï¼š
     -- æˆäºˆæƒé™
     grant æƒé™åˆ—è¡¨ on æ•°æ®åº“å.è¡¨å to &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;
     -- ç»™å¼ ä¸‰ç”¨æˆ·æˆäºˆæ‰€æœ‰æƒé™ï¼Œåœ¨ä»»æ„æ•°æ®åº“ä»»æ„è¡¨ä¸Š
     GRANT ALL ON *.* TO &#39;zhangsan&#39;@&#39;localhost&#39;;
     
 3. æ’¤é”€æƒé™ï¼š
     -- æ’¤é”€æƒé™ï¼š
     revoke æƒé™åˆ—è¡¨ on æ•°æ®åº“å.è¡¨å from &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;
     REVOKE UPDATE ON db3.`account` FROM &#39;lisi&#39;@&#39;%&#39;;
</code></pre>
</li>
<li><p>æƒé™åˆ—è¡¨</p>
<pre><code> Allï¼ŒALL PRIVILEGES          æ‰€æœ‰æƒé™
 SELECt                       æŸ¥è¯¢æ•°æ®
 INSERT                       æ’å…¥æ•°æ®
 UPDATE                       ä¿®æ”¹æ•°æ®
 DELETE                       åˆ é™¤æ•°æ®
 ALTER                        ä¿®æ”¹è¡¨
 DROP                         åˆ é™¤æ•°æ®åº“/è¡¨/è§†å›¾
 CREATE                       åˆ›å»ºæ•°æ®åº“/è¡¨ 
</code></pre>
</li>
</ol>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a><strong>å‡½æ•°</strong></h2><blockquote>
<p>è¯­æ³•ï¼šselect å‡½æ•°(å‚æ•°); </p>
</blockquote>
<h3 id="å­—ç¬¦ä¸²å‡½æ•°"><a href="#å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²å‡½æ•°"></a><strong>å­—ç¬¦ä¸²å‡½æ•°</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220606144953211.png" width="100%" / loading="lazy">


<h3 id="æ•°å€¼å‡½æ•°"><a href="#æ•°å€¼å‡½æ•°" class="headerlink" title="æ•°å€¼å‡½æ•°"></a><strong>æ•°å€¼å‡½æ•°</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220606145351734.png" width="100%" / loading="lazy">

<h3 id="æ—¥æœŸå‡½æ•°"><a href="#æ—¥æœŸå‡½æ•°" class="headerlink" title="æ—¥æœŸå‡½æ•°"></a><strong>æ—¥æœŸå‡½æ•°</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220606171518133.png" width="100%" / loading="lazy">

<blockquote>
<p>select date_format(now(),â€™%Y-%m-%dâ€™);<br>æ—¥æœŸæ ¼å¼ï¼š<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/sql/func_date_format.asp">https://www.w3school.com.cn/sql/func_date_format.asp</a></p>
</blockquote>
<h3 id="æµç¨‹å‡½æ•°"><a href="#æµç¨‹å‡½æ•°" class="headerlink" title="æµç¨‹å‡½æ•°"></a><strong>æµç¨‹å‡½æ•°</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220606173029853.png" width="100%" / loading="lazy">

<blockquote>
<p>æ³¨æ„ifnull â€˜â€™ æ—¶æ˜¯æœ‰å€¼çš„ åªæœ‰nullæ—¶æ‰ä¼šæ˜¾ç¤ºé»˜è®¤å€¼</p>
</blockquote>
<h2 id="çº¦æŸ"><a href="#çº¦æŸ" class="headerlink" title="çº¦æŸ"></a><strong>çº¦æŸ</strong></h2><img src="http://hexo.xuxin.world/mysql/image-20220606173722658.png" width="100%" / loading="lazy">


<ul>
<li>å¤–é”®çº¦æŸ<ul>
<li>åˆ é™¤å¤–é”®<pre><code>alter table è¡¨å drop foreign key å¤–é”®åç§°;
</code></pre>
</li>
<li>æ·»åŠ å¤–é”®<pre><code>- å»ºè¡¨æ—¶æ·»åŠ 
  create table è¡¨å(
      å­—æ®µå æ•°æ®ç±»å‹,
      ...
      constraint][å¤–é”®åç§°] foreign key (å¤–é”®å­—æ®µå) references ä¸»è¡¨(ä¸»è¡¨åˆ—å)
  );
- è¡¨å·²å­˜åœ¨æ—¶æ·»åŠ 
  alter table è¡¨å add constraint å¤–é”®åç§° foreign key(å¤–é”®å­—æ®µå) references ä¸»è¡¨(ä¸»è¡¨åˆ—å);
</code></pre>
</li>
</ul>
</li>
</ul>
<p><strong>çº¦æŸè¡Œä¸º</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220606180128967.png" width="100%" / loading="lazy"></p>
<p><strong>è¯­æ³•</strong></p>
<blockquote>
<p>alter table è¡¨å add constraint å¤–é”®åç§° foreign key(å¤–é”®å­—æ®µå) references ä¸»è¡¨(ä¸»è¡¨åˆ—å) on update/delete cascade;</p>
</blockquote>
<h2 id="å¤šè¡¨æŸ¥è¯¢"><a href="#å¤šè¡¨æŸ¥è¯¢" class="headerlink" title="å¤šè¡¨æŸ¥è¯¢"></a><strong>å¤šè¡¨æŸ¥è¯¢</strong></h2><h3 id="å¤šè¡¨å…³ç³»"><a href="#å¤šè¡¨å…³ç³»" class="headerlink" title="å¤šè¡¨å…³ç³»"></a><strong>å¤šè¡¨å…³ç³»</strong></h3><h4 id="ä¸€å¯¹ä¸€"><a href="#ä¸€å¯¹ä¸€" class="headerlink" title="ä¸€å¯¹ä¸€"></a><strong>ä¸€å¯¹ä¸€</strong></h4><blockquote>
<p>å°†ä¸€å¼ è¡¨æ‹†åˆ†ä¸ºå¤šä¸ªè¡¨<br>å°†åŸºæœ¬ä¿¡æ¯ä½œä¸ºçˆ¶è¡¨ï¼Œå…¶ä»–ä½œä¸ºå­è¡¨<br>å­è¡¨ä¸Šæ·»åŠ å¤–é”®ï¼Œå¹¶è®¾å®šä¸ºå”¯ä¸€çº¦æŸ</p>
</blockquote>
<h4 id="ä¸€å¯¹å¤š"><a href="#ä¸€å¯¹å¤š" class="headerlink" title="ä¸€å¯¹å¤š"></a><strong>ä¸€å¯¹å¤š</strong></h4><blockquote>
<p>ä¸€ä½œä¸ºçˆ¶è¡¨ï¼Œå¤šä½œä¸ºå­è¡¨<br>å­è¡¨ä¸Šæ·»åŠ å¤–é”®çº¦æŸ</p>
</blockquote>
<h4 id="å¤šå¯¹å¤š"><a href="#å¤šå¯¹å¤š" class="headerlink" title="å¤šå¯¹å¤š"></a><strong>å¤šå¯¹å¤š</strong></h4><blockquote>
<p>åˆ›å»ºç¬¬ä¸‰å¼ è¡¨ï¼Œå­—æ®µæœ‰ è‡ªèº«idï¼Œå¤–é”®å­—æ®µ<br>åœ¨å­è¡¨ä¸Šåˆ†åˆ«æ·»åŠ å¤–é”®</p>
</blockquote>
<h3 id="è¿æ¥æŸ¥è¯¢"><a href="#è¿æ¥æŸ¥è¯¢" class="headerlink" title="è¿æ¥æŸ¥è¯¢"></a><strong>è¿æ¥æŸ¥è¯¢</strong></h3><h4 id="å†…è¿æ¥"><a href="#å†…è¿æ¥" class="headerlink" title="å†…è¿æ¥"></a><strong>å†…è¿æ¥</strong></h4><ul>
<li>éšå¼å†…è¿æ¥<pre><code>  select å­—æ®µåˆ—è¡¨ from è¡¨1,è¡¨2 where æ¡ä»¶;
</code></pre>
</li>
<li>æ˜¾ç¤ºå†…è¿æ¥<pre><code>  select å­—æ®µåˆ—è¡¨ from è¡¨1 inner join è¡¨2 on æ¡ä»¶;
</code></pre>
</li>
</ul>
<h4 id="å¤–è¿æ¥"><a href="#å¤–è¿æ¥" class="headerlink" title="å¤–è¿æ¥"></a><strong>å¤–è¿æ¥</strong></h4><ul>
<li>å·¦å¤–è¿æ¥<pre><code>  select å­—æ®µåˆ—è¡¨ from è¡¨1 left outer join è¡¨2 on æ¡ä»¶;
</code></pre>
</li>
<li>å³å¤–è¿æ¥<pre><code>  select å­—æ®µåˆ—è¡¨ from è¡¨1 right outer join è¡¨2 on æ¡ä»¶;
</code></pre>
</li>
</ul>
<h4 id="è‡ªè¿æ¥"><a href="#è‡ªè¿æ¥" class="headerlink" title="è‡ªè¿æ¥"></a><strong>è‡ªè¿æ¥</strong></h4><blockquote>
<p>æ³¨æ„ï¼šè‡ªè¿æ¥å¯ä»¥æ˜¯å†…è¿æ¥ä¹Ÿå¯ä»¥æ˜¯å¤–è¿æ¥ï¼ŒåŒºåˆ«åœ¨äºï¼Œä¿©å¼ è¡¨éƒ½æ˜¯è‡ªå·±ï¼Œå¿…é¡»èµ·åˆ«å</p>
</blockquote>
<h3 id="è”åˆæŸ¥è¯¢"><a href="#è”åˆæŸ¥è¯¢" class="headerlink" title="è”åˆæŸ¥è¯¢"></a><strong>è”åˆæŸ¥è¯¢</strong></h3><blockquote>
<p>union/union all</p>
</blockquote>
<pre><code>    ä½œç”¨ï¼šå°†å¤šæ¬¡æŸ¥è¯¢çš„ç»“æœè”åˆèµ·æ¥(å¤šæ¬¡)
    åŒºåˆ«ï¼šunion allæ˜¯ç›´æ¥æ‹¼æ¥ï¼Œunionæ˜¯å»é‡
    è¯­æ³•ï¼š
            select å­—æ®µåˆ—è¡¨ from è¡¨ where æ¡ä»¶
            union/union all
            select å­—æ®µåˆ—è¡¨ from è¡¨ where æ¡ä»¶
    æ³¨æ„ï¼šå¤šå¼ è¡¨çš„åˆ—æ•°ä¸€è‡´ï¼Œå­—æ®µç±»å‹ä¸€è‡´
</code></pre>
<h3 id="å­æŸ¥è¯¢-åµŒå¥—æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢-åµŒå¥—æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢(åµŒå¥—æŸ¥è¯¢)"></a><strong>å­æŸ¥è¯¢(åµŒå¥—æŸ¥è¯¢)</strong></h3><blockquote>
<ul>
<li>æ ‡é‡å­æŸ¥è¯¢</li>
<li>åˆ—å­æŸ¥è¯¢</li>
<li>è¡Œå­æŸ¥è¯¢</li>
<li>è¡¨å­æŸ¥è¯¢</li>
</ul>
</blockquote>
<ul>
<li>æ ‡é‡å­æŸ¥è¯¢<pre><code>  æ“ä½œç¬¦å·ï¼š&lt;  &gt;  &lt;&gt;  = 
  è¯­æ³•ï¼š
        select * from è¡¨1 where å­—æ®µ1 = (select å­—æ®µ where æ¡ä»¶)
æ³¨æ„ï¼šç¬¬äºŒä¸ªæŸ¥è¯¢è¯­å¥çš„ç»“æœå¿…é¡»æ˜¯å•ä¸€å€¼
</code></pre>
</li>
</ul>
<hr>
<ul>
<li>åˆ—å­æŸ¥è¯¢<pre><code>  æ“ä½œç¬¦å·: in   not in   any  some   all
  è¯­æ³•ï¼š
           select * form è¡¨ where å­—æ®µ &gt; all (select å­—æ®µ where æ¡ä»¶);
  æ³¨æ„ï¼šç¬¬äºŒä¸ªæŸ¥è¯¢è¯­å¥è¿”å›å€¼ä¸ºä¸€åˆ—æ•°æ®
           allè¡¨ç¤ºå¤§äºå…¨éƒ¨ï¼Œæ‰€æœ‰éƒ½æ»¡è¶³
           anyå’Œsomeä¸€æ ·ï¼Œè¡¨ç¤ºä¸€ä¸ªæ»¡è¶³å°±è¡Œ
</code></pre>
</li>
</ul>
<hr>
<ul>
<li>è¡Œå­æŸ¥è¯¢<pre><code>  æ“ä½œç¬¦å·ï¼šin   not in   =   &lt;&gt;
  è¯­æ³•: 
              select * from emp where (salary,managerid) = 
              (select salary,managerid from emp where name = &#39;xx&#39;)ï¼›
  æ³¨æ„:  
        å¤šè¡Œæ¡ä»¶æŸ¥è¯¢å¯ä»¥ç”±
              select * from emp where (salary,managerid) =ï¼ˆ1ï¼Œ2);
              ç­‰ä»·äº
              select * from emp where salary = 1 and managerid = 2;
</code></pre>
</li>
</ul>
<hr>
<ul>
<li>è¡¨å­æŸ¥è¯¢<ul>
<li>ä½œä¸ºwhereä¸­çš„æ¡ä»¶<pre><code>  æ“ä½œç¬¦å·ï¼š in (è¡¨ç¤ºæ»¡è¶³è¿™å¼ è¡¨ä¸­çš„ä¸€è¡Œæ•°æ®å°±è¡Œ)
  è¯­æ³•ï¼šselect * from where ï¼ˆå­—æ®µ1,å­—æ®µ2ï¼‰ in (select * from where æ¡ä»¶);
  æ³¨æ„ï¼šç¬¬äºŒä¸ªæŸ¥è¯¢è¯­å¥çš„è¿”å›å€¼æ˜¯ä¸€å¼ è¡¨
</code></pre>
</li>
<li>ä½œä¸ºfromä¸­çš„è¡¨<pre><code>  è¯­æ³•ï¼šselect * from ï¼ˆselect * from è¡¨1 where æ¡ä»¶ï¼‰left join è¡¨2 on æ¡ä»¶;
</code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a><strong>äº‹åŠ¡</strong></h2><pre><code>1. äº‹åŠ¡çš„åŸºæœ¬ä»‹ç»
    1. æ¦‚å¿µï¼š
        *  å¦‚æœä¸€ä¸ªåŒ…å«å¤šä¸ªæ­¥éª¤çš„ä¸šåŠ¡æ“ä½œï¼Œè¢«äº‹åŠ¡ç®¡ç†ï¼Œé‚£ä¹ˆè¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚
    2. æ“ä½œï¼š
        1. å¼€å¯äº‹åŠ¡ï¼š start transaction/begin;
        2. å›æ»šï¼šrollback;
        3. æäº¤ï¼šcommit;
        4. æŸ¥è¯¢äº‹åŠ¡æäº¤æ–¹å¼ï¼šselect @@autocommit ï¼ˆ0æ‰‹åŠ¨æäº¤ï¼Œ1è‡ªåŠ¨æäº¤ï¼ˆé»˜è®¤ï¼Œä¸€æ¡DML(å¢åˆ æ”¹)è¯­å¥ä¼šè‡ªåŠ¨æäº¤ä¸€æ¬¡äº‹åŠ¡ï¼‰
        5. è®¾ç½®äº‹åŠ¡æäº¤æ–¹å¼ï¼šset @@autocommit = 1/0
    3. æ“ä½œäº‹åŠ¡
            -å…³é—­è‡ªåŠ¨æäº¤äº‹åŠ¡æ—¶
                    å…ˆå…³é—­è‡ªåŠ¨æäº¤
                    set @@autocommit = 0;
                    æ­£å¸¸æ—¶ commit
                    å‡ºé”™æ—¶ rollback
            -è‡ªåŠ¨æäº¤äº‹åŠ¡æ—¶
                    å…ˆå¼€å¯è‡ªåŠ¨æäº¤ï¼Œé»˜è®¤
                    set @@autocommit = 1;
                    å¼€å¯äº‹åŠ¡ start transaction/begin;
                    æ­£å¸¸æ—¶ commit
                    å‡ºé”™æ—¶ rollback
    4. äº‹åŠ¡çš„å››å¤§ç‰¹å¾ï¼š
      1. åŸå­æ€§ï¼šæ˜¯ä¸å¯åˆ†å‰²çš„æœ€å°æ“ä½œå•ä½ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚
      2. æŒä¹…æ€§ï¼šå½“äº‹åŠ¡æäº¤æˆ–å›æ»šåï¼Œæ•°æ®åº“ä¼šæŒä¹…åŒ–çš„ä¿å­˜æ•°æ®ã€‚
      3. éš”ç¦»æ€§ï¼šå¤šä¸ªäº‹åŠ¡ä¹‹é—´ã€‚ç›¸äº’ç‹¬ç«‹ã€‚
      4. ä¸€è‡´æ€§ï¼šäº‹åŠ¡æ“ä½œå‰åï¼Œæ•°æ®æ€»é‡ä¸å˜
  5. äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼ˆäº†è§£ï¼‰
            æ¦‚å¿µï¼šå¤šä¸ªäº‹åŠ¡ä¹‹é—´éš”ç¦»çš„ï¼Œç›¸äº’ç‹¬ç«‹çš„ã€‚ä½†æ˜¯å¦‚æœå¤šä¸ªäº‹åŠ¡æ“ä½œåŒä¸€æ‰¹æ•°æ®ï¼Œåˆ™ä¼šå¼•å‘ä¸€äº›é—®é¢˜ï¼Œè®¾ç½®ä¸åŒçš„éš”ç¦»çº§åˆ«å°±å¯ä»¥è§£å†³è¿™äº›é—®é¢˜ã€‚
            å­˜åœ¨é—®é¢˜ï¼š
          1. è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡ï¼Œè¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡ä¸­æ²¡æœ‰æäº¤çš„æ•°æ®
          2. ä¸å¯é‡å¤è¯»(è™šè¯»)ï¼šåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œä¸¤æ¬¡è¯»å–åˆ°çš„æ•°æ®ä¸ä¸€æ ·ï¼ˆæ›´æ–°æ“ä½œï¼Œé”è¡Œï¼‰
          3. å¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡æ“ä½œ(DML)æ•°æ®è¡¨ä¸­æ‰€æœ‰è®°å½•ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ·»åŠ äº†ä¸€æ¡æ•°æ®ï¼Œåˆ™ç¬¬ä¸€ä¸ªäº‹åŠ¡æŸ¥è¯¢ä¸åˆ°è‡ªå·±çš„ä¿®æ”¹ã€‚ï¼ˆå¢åˆ ï¼Œé”è¡¨ï¼‰
          å¹»è¯»è¯´çš„æ˜¯å­˜ä¸å­˜åœ¨çš„é—®é¢˜ï¼šåŸæ¥ä¸å­˜åœ¨çš„,ç°åœ¨å­˜åœ¨äº†,åˆ™æ˜¯å¹»è¯»
          ä¸å¯é‡å¤è¯»è¯´çš„æ˜¯å˜æ²¡å˜åŒ–çš„é—®é¢˜ï¼šåŸæ¥æ˜¯A,ç°åœ¨å´å˜ä¸ºäº†B,åˆ™ä¸ºä¸å¯é‡å¤è¯»
            éš”ç¦»çº§åˆ«ï¼š
          1. read uncommittedï¼šè¯»æœªæäº¤
            * äº§ç”Ÿçš„é—®é¢˜ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»
          2. read committedï¼šè¯»å·²æäº¤ ï¼ˆOracleï¼‰
            * äº§ç”Ÿçš„é—®é¢˜ï¼šä¸å¯é‡å¤è¯»ã€å¹»è¯»
          3. repeatable readï¼šå¯é‡å¤è¯» ï¼ˆMySQLé»˜è®¤ï¼‰
            * äº§ç”Ÿçš„é—®é¢˜ï¼šå¹»è¯»
          4. serializableï¼šä¸²è¡ŒåŒ–
            * å¯ä»¥è§£å†³æ‰€æœ‰çš„é—®é¢˜      
         æ³¨æ„ï¼šéš”ç¦»çº§åˆ«ä»å°åˆ°å¤§å®‰å…¨æ€§è¶Šæ¥è¶Šé«˜ï¼Œä½†æ˜¯æ•ˆç‡è¶Šæ¥è¶Šä½
          æ•°æ®åº“æŸ¥è¯¢éš”ç¦»çº§åˆ«ï¼š
            * select @@transaction_isolation;
          æ•°æ®åº“è®¾ç½®éš”ç¦»çº§åˆ«ï¼š
            * set session/global transaction isolation level  éš”ç¦»çº§åˆ«;ï¼ˆread uncommittedï¼Œread committed...ï¼‰
            session:ä¼šè¯çº§åˆ«ï¼Œå½“å‰å®¢æˆ·ç«¯
            global:å…¨å±€ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯
</code></pre>
<h1 id="è¿›é˜¶ç¯‡"><a href="#è¿›é˜¶ç¯‡" class="headerlink" title="è¿›é˜¶ç¯‡"></a><strong>è¿›é˜¶ç¯‡</strong></h1><h2 id="å­˜å‚¨å¼•æ“"><a href="#å­˜å‚¨å¼•æ“" class="headerlink" title="å­˜å‚¨å¼•æ“"></a><strong>å­˜å‚¨å¼•æ“</strong></h2><h3 id="mysqlä½“ç³»ç»“æ„"><a href="#mysqlä½“ç³»ç»“æ„" class="headerlink" title="mysqlä½“ç³»ç»“æ„"></a><strong>mysqlä½“ç³»ç»“æ„</strong></h3><img src="https://hexo.xuxin.world/mysql/image-20220607170326819.png" width="100%" / loading="lazy">

<ul>
<li>è¿æ¥å±‚<pre><code>  æœ€ä¸Šå±‚æ˜¯ä¸€äº›å®¢æˆ·ç«¯å’Œé“¾æ¥æœåŠ¡ï¼Œä¸»è¦å®Œæˆä¸€äº›ç±»ä¼¼äºè¿æ¥å¤„ç†ã€æˆæƒè®¤è¯ã€åŠç›¸å…³çš„å®‰å…¨æ–¹æ¡ˆã€‚
  æœåŠ¡å™¨ä¹Ÿä¼šä¸ºå®‰å…¨æ¥å…¥çš„æ¯ä¸ªå®¢æˆ·ç«¯éªŒè¯å®ƒæ‰€å…·æœ‰çš„æ“ä½œæƒé™ã€‚
</code></pre>
</li>
<li>æœåŠ¡å±‚<pre><code>  ç¬¬äºŒå±‚æ¶æ„ä¸»è¦å®Œæˆå¤§å¤šæ•°çš„æ ¸å¿ƒæœåŠ¡åŠŸèƒ½ï¼Œå¦‚SQLæ¥å£ï¼Œå¹¶å®Œæˆç¼“å­˜çš„æŸ¥è¯¢ï¼ŒSQLçš„åˆ†æå’Œä¼˜åŒ–ï¼Œéƒ¨åˆ†å†…ç½®å‡½æ•°çš„æ‰§è¡Œã€‚
  æ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ä¹Ÿåœ¨è¿™ä¸€å±‚å®ç°ï¼Œå¦‚è¿‡ç¨‹ã€å‡½æ•°ç­‰ã€‚
</code></pre>
</li>
<li>å¼•æ“å±‚<pre><code>  å­˜å‚¨å¼•æ“çœŸæ­£çš„è´Ÿè´£äº†MySQLä¸­æ•°æ®çš„å­˜å‚¨å’Œæå–ï¼ŒæœåŠ¡å™¨é€šè¿‡APIå’Œå­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ã€‚
  ä¸åŒçš„å­˜å‚¨å¼•æ“å…·æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ï¼Œæ¥é€‰å–åˆé€‚çš„å­˜å‚¨å¼•æ“ã€‚
</code></pre>
</li>
<li>å­˜å‚¨å±‚<pre><code>  ä¸»è¦æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå¹¶å®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’ã€‚
</code></pre>
</li>
</ul>
<blockquote>
<p><strong>å­˜å‚¨å¼•æ“ç®€ä»‹</strong></p>
</blockquote>
<blockquote>
<ul>
<li>å­˜å‚¨å¼•æ“å°±æ˜¯å­˜å‚¨æ•°æ®ã€å»ºç«‹ç´¢å¼•ã€æ›´æ–°/æŸ¥è¯¢æ•°æ®ç­‰æŠ€æœ¯çš„å®ç°æ–¹å¼ã€‚</li>
<li>å­˜å‚¨å¼•æ“æ˜¯åŸºäºè¡¨çš„ï¼Œè€Œä¸æ˜¯åŸºäºåº“çš„ï¼Œæ‰€ä»¥å­˜å‚¨å¼•æ“ä¹Ÿå¯è¢«ç§°ä¸ºè¡¨ç±»å‹ã€‚</li>
</ul>
</blockquote>
<pre><code>- æŸ¥çœ‹å»ºè¡¨è¯­å¥
        show create table emp;

- åˆ›å»ºè¡¨æ—¶æŒ‡å®šå­˜å‚¨å¼•æ“
        CREATE TABLE `emp` (
        ...
        ) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb3

- æ˜¾ç¤ºå½“å‰æ•°æ®åº“æ”¯æŒçš„å­˜å‚¨å¼•æ“
        show engines;
</code></pre>
<blockquote>
<p><strong>å­˜å‚¨å¼•æ“ç‰¹ç‚¹</strong></p>
</blockquote>
<ul>
<li>æŸ¥çœ‹ç³»ç»Ÿå‚æ•°<pre><code>  show variables like &#39;innodb_file_per_table&#39;;
</code></pre>
</li>
</ul>
<h3 id="InnoDB"><a href="#InnoDB" class="headerlink" title="InnoDB"></a><strong>InnoDB</strong></h3><ul>
<li>ä»‹ç»<pre><code>  InnoDBæ˜¯ä¸€ç§å…¼é¡¾é«˜å¯é æ€§å’Œé«˜æ€§èƒ½çš„é€šç”¨å­˜å‚¨å¼•æ“ï¼Œåœ¨MySQL5.5ä¹‹åï¼ŒInnoDBæ˜¯é»˜è®¤çš„MySQLå­˜å‚¨å¼•æ“ã€‚
</code></pre>
</li>
<li>ç‰¹ç‚¹<pre><code>  DMLæ“ä½œéµå¾ªACIDæ¨¡å‹ï¼Œæ”¯æŒäº‹åŠ¡ï¼›
  è¡Œçº§é”ï¼Œæé«˜å¹¶å‘è®¿é—®æ€§èƒ½ï¼›
  æ”¯æŒå¤–é”®FOREIGN KEYçº¦æŸï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œæ­£ç¡®æ€§ï¼› 
</code></pre>
</li>
<li>æ–‡ä»¶<pre><code>  XXX.ibdï¼šxä»£è¡¨çš„æ˜¯è¡¨åï¼ŒinnoDBå¼•æ“çš„æ¯å¼ è¡¨éƒ½ä¼šå¯¹åº”è¿™æ ·ä¸€ä¸ªè¡¨ç©ºé—´æ–‡ä»¶ï¼Œå­˜å‚¨è¯¥è¡¨çš„è¡¨ç»“æ„ï¼ˆfrmã€sdiï¼‰ã€æ•°æ®å’Œç´¢å¼•ã€‚
  å‚æ•°ï¼šinnodb_file_per_tableï¼ˆon/offï¼Œæ˜¯å¦æ¯å¼ è¡¨å¯¹åº”ä¸€ä¸ªè¡¨ç©ºé—´æ–‡ä»¶ï¼Œé»˜è®¤onï¼‰
</code></pre>
</li>
</ul>
<img src="https://hexo.xuxin.world/mysql/image-20220607172639423.png" width="100%" / loading="lazy">


<h3 id="MyISAM"><a href="#MyISAM" class="headerlink" title="MyISAM"></a><strong>MyISAM</strong></h3><ul>
<li>ä»‹ç»<pre><code>  MYISAMæ—¶MYSQLæ—©èµ·çš„é»˜è®¤å­˜å‚¨å¼•æ“
</code></pre>
</li>
<li>ç‰¹ç‚¹<pre><code>  ä¸æ”¯æŒäº‹åŠ¡ï¼Œä¸æ”¯æŒå¤–é”®
  æ”¯æŒè¡¨é”ï¼Œä¸æ”¯æŒè¡Œé”
  è®¿é—®é€Ÿåº¦å¿«
</code></pre>
</li>
<li>æ–‡ä»¶<pre><code>    xxx.sdi:å­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯
    xxx.MYD:å­˜å‚¨æ•°æ®
    xxx.MYI:å­˜å‚¨ç´¢å¼•
</code></pre>
</li>
</ul>
<h3 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a><strong>Memory</strong></h3><ul>
<li>ä»‹ç»<pre><code>  Memoryå¼•æ“çš„è¡¨æ•°æ®æ—¶å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œç”±äºå—åˆ°ç¡¬ä»¶é—®é¢˜ï¼Œæˆ–æ–­ç”µå½±å“ï¼Œåªèƒ½å°†è¿™äº›è¡¨ä½œä¸ºä¸´æ—¶è¡¨æˆ–ç¼“å­˜ä½¿ç”¨ã€‚
</code></pre>
</li>
<li>ç‰¹ç‚¹<pre><code>  å†…å­˜å­˜æ”¾
  hashç´¢å¼•ï¼ˆé»˜è®¤ï¼‰
</code></pre>
</li>
<li>æ–‡ä»¶<pre><code>  xxx.sdiï¼šå­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220607173942982.png" width="100%" / loading="lazy">

<h3 id="å­˜å‚¨å¼•æ“çš„é€‰æ‹©"><a href="#å­˜å‚¨å¼•æ“çš„é€‰æ‹©" class="headerlink" title="å­˜å‚¨å¼•æ“çš„é€‰æ‹©"></a><strong>å­˜å‚¨å¼•æ“çš„é€‰æ‹©</strong></h3><pre><code>    InnoDBï¼šå¦‚æœæœ‰äº‹åŠ¡ï¼Œå”¯ä¸€çš„é€‰æ‹©ï¼Œå¹¶å‘ä¸‹ä¸€è‡´æ€§ï¼Œé™¤æ’å…¥å’ŒæŸ¥è¯¢å¤–ï¼Œæœ‰å¾ˆå¤šçš„æ›´æ–°å’Œåˆ é™¤æ“ä½œ
    MYISAMï¼šä»¥è¯»å’Œæ’å…¥ä¸ºä¸»ï¼Œå¹¶ä¸”å¯¹äº‹åŠ¡å®Œæ•´æ€§è¦æ±‚ä¸é«˜ï¼Œå¦‚è¶³è¿¹ï¼Œè¯„è®ºï¼Œä½†æ˜¯å¦‚ä»Šè¢«MongoDBæ›¿ä»£
    Memoryï¼šå†…å­˜å­˜å‚¨ï¼Œé€Ÿåº¦å¿«ï¼Œç”¨äºç¼“å­˜ï¼Œå¦‚ä»Šè¢«redisæ›¿ä»£
</code></pre>
<h2 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a><strong>ç´¢å¼•</strong></h2><h3 id="ç´¢å¼•æ¦‚è¿°"><a href="#ç´¢å¼•æ¦‚è¿°" class="headerlink" title="ç´¢å¼•æ¦‚è¿°"></a><strong>ç´¢å¼•æ¦‚è¿°</strong></h3><blockquote>
<p>ç´¢å¼•æ˜¯å¸®åŠ©mysqlé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ï¼ˆæœ‰åº)</p>
</blockquote>
<pre><code>    *ä¼˜ç‚¹ï¼šæé«˜æ•°æ®æ£€ç´¢æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“ioæˆæœ¬
            é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½cpuçš„æ¶ˆè€—
    *ç¼ºç‚¹ï¼šç´¢å¼•åˆ—éœ€è¦é¢å¤–çš„ç£ç›˜ç©ºé—´
              å¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡çš„åŒæ—¶å¢åŠ äº†DMLçš„æ•ˆç‡ï¼Œéœ€è¦å¯¹ç´¢å¼•èŠ‚ç‚¹é¢å¤–æ“ä½œ
</code></pre>
<h3 id="ç´¢å¼•ç»“æ„"><a href="#ç´¢å¼•ç»“æ„" class="headerlink" title="ç´¢å¼•ç»“æ„"></a><strong>ç´¢å¼•ç»“æ„</strong></h3><p><strong>mysqlä¸­ç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“ä¸­å®ç°çš„ï¼Œä¸åŒçš„å¼•æ“æœ‰ä¸åŒçš„ç´¢å¼•ç»“æ„</strong></p>
<img src="http://hexo.xuxin.world/mysql/image-20220607224756131.png" width="100%" / loading="lazy">


<img src="http://hexo.xuxin.world/mysql/image-20220607225025706.png" width="100%" / loading="lazy">

<h4 id="B-tree-å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘"><a href="#B-tree-å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘" class="headerlink" title="B-tree:å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘"></a><strong>B-tree:å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘</strong></h4><pre><code>    æœ€å¤§åº¦æ•°ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ€å¤§çš„æ•°æ®å­˜æ”¾é‡
</code></pre>
<img src="http://hexo.xuxin.world/mysql/image-20220607230211908.png" width="100%" / loading="lazy">


<pre><code>    å¯ä»¥å‚è€ƒç½‘ç«™ï¼šhttps://www.cs.usfca.edu/~galles/visualization/BTree.html
</code></pre>
<h4 id="B-tree"><a href="#B-tree" class="headerlink" title="B+tree"></a><strong>B+tree</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220607230506451.png" width="100%" / loading="lazy">
        ä¸B-treeåŒºåˆ«ï¼š
                æ‰€æœ‰æ•°æ®å‡ºç°åœ¨å¶å­ç»“ç‚¹
                å¶å­ç»“ç‚¹å½¢æˆä¸€ä¸ªå•å‘é“¾è¡¨

<h4 id="mysqlä¸­B-tree"><a href="#mysqlä¸­B-tree" class="headerlink" title="mysqlä¸­B+tree"></a><strong>mysqlä¸­B+tree</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220607230826013.png" width="100%" / loading="lazy">

<h4 id="Hashç´¢å¼•"><a href="#Hashç´¢å¼•" class="headerlink" title="Hashç´¢å¼•"></a><strong>Hashç´¢å¼•</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220607231021039.png" width="100%" / loading="lazy">


<ul>
<li>Hashç´¢å¼•ç‰¹ç‚¹<pre><code>  Hashç´¢å¼•åªèƒ½ç”¨äºå¯¹ç­‰æ¯”è¾ƒ(=ï¼Œin)ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢(between,&gt;,&lt;,...)
  æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºæ“ä½œ
  æŸ¥è¯¢æ•ˆç‡é«˜ï¼Œé€šå¸¸åªéœ€è¦ä¸€æ¬¡æ£€ç´¢å°±å¯ä»¥äº†ï¼Œæ•ˆç‡é€šå¸¸è¦é«˜äºB+treeç´¢å¼•
</code></pre>
</li>
<li>å­˜å‚¨å¼•æ“çš„æ”¯æŒ<pre><code>  åœ¨Mysqlä¸­ï¼Œæ”¯æŒhashç´¢å¼•çš„æ˜¯Memoryå¼•æ“ï¼Œè€ŒInnoDBä¸­å…·æœ‰è‡ªé€‚åº”hashåŠŸèƒ½ï¼Œhashç´¢å¼•æ˜¯å­˜å‚¨å¼•æ“æ ¹æ®B+treeç´¢å¼•åœ¨æŒ‡å®šæ¡ä»¶ä¸‹è‡ªåŠ¨æ„å»ºçš„ã€‚
</code></pre>
</li>
</ul>
<h4 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a><strong>é¢è¯•é¢˜</strong></h4><pre><code>    ä¸ºä»€ä¹ˆInnoDBå­˜å‚¨å¼•æ“é€‰æ‹©ä½¿ç”¨B+treeç´¢å¼•ç»“æ„ï¼Ÿ
            ç›¸å¯¹äºçº¢é»‘æ ‘ï¼Œå•ç»“ç‚¹å¤šæ•°æ®ï¼Œå±‚çº§æ›´å°‘ï¼Œæœç´¢æ•ˆç‡æ›´é«˜
            å¯¹äºB-treeï¼Œæ— è®ºå¶å­ç»“ç‚¹å’Œéå¶å­ç»“ç‚¹éƒ½ä¼šä¿å­˜æ•°æ®ï¼Œä¸€é¡µçš„å¤§å°å›ºå®š16kï¼Œç³»ç»Ÿè¯»æ•°æ®åˆ°å†…å­˜æ˜¯ä»¥ç£ç›˜å—ä¸ºå•ä½çš„ï¼Œinnodbä¼šå°†å¤šä¸ªè¿ç»­ç£ç›˜å—æ¥æ„æˆä¸€é¡µ16kï¼Œä»¥é¡µä¸ºåŸºæœ¬å•ä½è¯»å–ï¼Œå¦‚æœdataæ•°æ®å¾ˆå¤§ï¼Œä¸€é¡µä¸­å­˜æ”¾çš„å°‘äº†ï¼Œæ ‘é«˜åº¦å¢åŠ ï¼ŒIOæ¬¡æ•°å°±ä¼šå¢åŠ ï¼Œæ•ˆç‡é™ä½ã€‚
            å¯¹äºhashï¼ŒB+treeæ”¯æŒèŒƒå›´åŒ¹é…åŠæ’åºæ“ä½œ
</code></pre>
<h3 id="ç´¢å¼•åˆ†ç±»"><a href="#ç´¢å¼•åˆ†ç±»" class="headerlink" title="ç´¢å¼•åˆ†ç±»"></a><strong>ç´¢å¼•åˆ†ç±»</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220608000646347.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220608000758020.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220608001308148.png" width="100%" / loading="lazy">


<pre><code>    äºŒçº§ç´¢å¼•åˆå«è¾…åŠ©ç´¢å¼•
</code></pre>
<ul>
<li>èšé›†ç´¢å¼•é€‰å–è§„åˆ™<pre><code>  å¦‚æœå­˜åœ¨ä¸»é”®ï¼Œä¸»é”®ç´¢å¼•å°±æ˜¯èšé›†ç´¢å¼•
  å¦‚æœä¸å­˜åœ¨ä¸»é”®ï¼Œå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå”¯ä¸€ï¼ˆuniqueï¼‰ç´¢å¼•ä½œä¸ºèšé›†ç´¢å¼•
  å¦‚æœè¡¨æ²¡æœ‰ä¸»é”®ï¼Œæˆ–æ²¡æœ‰åˆé€‚çš„å”¯ä¸€ç´¢å¼•ï¼Œåˆ™Innodbä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªrowidä½œä¸ºéšè—çš„èšé›†ç´¢å¼•
</code></pre>
</li>
<li>åˆ©ç”¨ç´¢å¼•æŸ¥è¯¢è§„åˆ™<pre><code>  å½“é€šè¿‡è¾…åŠ©ç´¢å¼•æ¥æŸ¥è¯¢æ•°æ®æ—¶ï¼ŒInnoDBå­˜å‚¨å¼•æ“ä¼šéå†è¾…åŠ©ç´¢å¼•æ‰¾åˆ°ä¸»é”®ï¼Œç„¶åå†é€šè¿‡ä¸»é”®åœ¨èšé›†ç´¢å¼•ä¸­æ‰¾åˆ°å®Œæ•´çš„è¡Œè®°å½•æ•°æ®ã€‚
</code></pre>
</li>
</ul>
<blockquote>
<p><strong>é¢è¯•é¢˜</strong></p>
</blockquote>
<pre><code>    ä»¥ä¸‹SQLè¯­å¥ä¸­å“ªä¸ªæ•ˆç‡é«˜ï¼Ÿ
            select * from user where id = 10ï¼›
            select * from user where name = â€˜Armâ€™ï¼›
    ç­”ï¼šå³ä½¿ç¬¬äºŒæ¡æœ‰è¾…åŠ©ç´¢å¼•ï¼Œä»ç„¶éœ€è¦2æ¬¡ç´¢å¼•æŸ¥æ‰¾ï¼Œä¸å¦‚ç¬¬ä¸€ä¸ªç›´æ¥æŸ¥ï¼Œè€Œå¦‚æœäºŒæ²¡æœ‰è¾…åŠ©ç´¢å¼•ï¼Œåˆ™éœ€è¦é€è¡Œæ‰«æ

    å‡è®¾ä¸€è¡Œæ•°æ®ä¸º1kï¼Œæ ‘é«˜ä¸º2èƒ½å­˜æ”¾å¤šå°‘æ•°æ®ï¼Ÿ
    ç­”ï¼š1é¡µ16kï¼Œèƒ½å­˜æ”¾16è¡Œï¼ŒæŒ‡é’ˆå ç”¨6å­—èŠ‚ï¼Œä¸»é”®int4å­—èŠ‚ï¼Œbigint8å­—èŠ‚ï¼Œç®—bigintï¼Œn*8+(n+1)*6 = 1024*16,n=1170,1170*16=18736

    å‡è®¾ä¸€è¡Œæ•°æ®ä¸º1kï¼Œæ ‘é«˜ä¸º2èƒ½å­˜æ”¾å¤šå°‘æ•°æ®ï¼Ÿ
    ç­”ï¼š1170*1170*16=21939856

    å¦‚æœæ•°æ®é‡è¶…è¿‡äº†è¿™ä¸ªæ•°å­—è¦ä¹ˆå¢åŠ æ ‘çš„é«˜åº¦ï¼Œæ•ˆç‡é™ä½ï¼Œè¦ä¹ˆåˆ†åº“åˆ†è¡¨
</code></pre>
<h3 id="ç´¢å¼•è¯­æ³•"><a href="#ç´¢å¼•è¯­æ³•" class="headerlink" title="ç´¢å¼•è¯­æ³•"></a><strong>ç´¢å¼•è¯­æ³•</strong></h3><ul>
<li>æŸ¥çœ‹ç´¢å¼•<pre><code>  show index from è¡¨å;
  show index from è¡¨å\G;  --æœ‰åº
</code></pre>
</li>
<li>åˆ›å»ºç´¢å¼•<pre><code>  create [unique|fulltext] index ç´¢å¼•åå­— on è¡¨å(å­—æ®µå...);
</code></pre>
</li>
<li>åˆ é™¤ç´¢å¼•<pre><code>  drop index ç´¢å¼•å on è¡¨å;
  
  æ³¨æ„ï¼šåˆ›å»ºç´¢å¼•æ—¶ï¼Œå”¯ä¸€åˆ™æŒ‡å®šuniqueï¼Œå¤šå­—æ®µè”åˆç´¢å¼•éœ€è¦å¤šå­—æ®µï¼Œå¸¸è§„ç´¢å¼•æ­£å¸¸ï¼Œä¸»é”®ç´¢å¼•å»ºè¡¨æ—¶å­˜åœ¨
</code></pre>
</li>
</ul>
<h3 id="SQLæ€§èƒ½åˆ†æ"><a href="#SQLæ€§èƒ½åˆ†æ" class="headerlink" title="SQLæ€§èƒ½åˆ†æ"></a><strong>SQLæ€§èƒ½åˆ†æ</strong></h3><h4 id="æŸ¥çœ‹æ‰§è¡Œé¢‘æ¬¡"><a href="#æŸ¥çœ‹æ‰§è¡Œé¢‘æ¬¡" class="headerlink" title="æŸ¥çœ‹æ‰§è¡Œé¢‘æ¬¡"></a><strong>æŸ¥çœ‹æ‰§è¡Œé¢‘æ¬¡</strong></h4><ul>
<li>æŸ¥çœ‹æ‰§è¡Œé¢‘æ¬¡ï¼ˆselect,insert,delete,updateï¼‰<pre><code>  shwo globalï½œsession status like â€˜Com_______â€™ï¼›
  æ³¨æ„ï¼šglobalæ˜¯å…¨å±€ï¼Œsessionæ˜¯å½“å‰ä¼šè¯ï¼Œä¸ƒä¸ª_
</code></pre>
</li>
</ul>
<h4 id="æ…¢æŸ¥è¯¢æ—¥å¿—"><a href="#æ…¢æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æ…¢æŸ¥è¯¢æ—¥å¿—"></a><strong>æ…¢æŸ¥è¯¢æ—¥å¿—</strong></h4><blockquote>
<p><strong>æ»¡æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šå‚æ•°ï¼ˆlong_query_time,å•ä½ï¼šç§’ï¼Œé»˜è®¤10ï¼‰çš„æ‰€æœ‰sqlè¯­å¥çš„æ—¥å¿—ã€‚mysqlçš„æ…¢æŸ¥è¯¢æ—¥å¿—é»˜è®¤æ²¡æœ‰å¼€å¯ï¼Œéœ€è¦æ”¹é…ç½®æ–‡ä»¶ï¼ˆ/etc/my.cnfï¼‰ä¸­é…ç½®ä¸€ä¸‹ä¿¡æ¯</strong></p>
</blockquote>
<pre><code>    #å¼€å¯mysqlæ…¢æ—¥å¿—æŸ¥è¯¢çš„å¼€å…³
    slow_query_log=1
    #è®¾ç½®æ…¢æ—¥å¿—çš„æ—¶é—´ä¸º2ç§’ï¼Œsqlè¯­å¥æ‰§è¡Œæ—¶é—´è¶…è¿‡2ç§’ï¼Œå°±ä¼šè®°å½•åœ¨æ…¢æ—¥å¿—é‡Œ
    long_query_time=2
</code></pre>
<blockquote>
<p><strong>é…ç½®å®Œæ¯•åï¼Œé‡å¯mysqlï¼šsystemctl restart mysqld.service</strong><br><strong>æŸ¥çœ‹æ…¢æ—¥å¿—ï¼š/var/lib/mysql/localhost-slow.log</strong></p>
</blockquote>
<ul>
<li>æŸ¥çœ‹æ˜¯å¦å¼€å¯æ…¢æ—¥å¿—<pre><code>  Show variables like &#39;slow_query%&#39;;
</code></pre>
</li>
<li>æŸ¥çœ‹æ…¢æ—¥å¿—<pre><code>  cat /var/lib/mysql/localhost-slow.log 
  æ³¨æ„ï¼šè¿™é‡Œçš„æ–‡ä»¶åæ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦ç¬¬ä¸€æ­¥å‘½ä»¤æŸ¥çœ‹æ…¢æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼šslow_query_log_fileçš„å€¼
</code></pre>
</li>
</ul>
<h4 id="mysqlå¯åŠ¨æŠ¥é”™æ€ä¹ˆåŠï¼Ÿ"><a href="#mysqlå¯åŠ¨æŠ¥é”™æ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="mysqlå¯åŠ¨æŠ¥é”™æ€ä¹ˆåŠï¼Ÿ"></a><strong>mysqlå¯åŠ¨æŠ¥é”™æ€ä¹ˆåŠï¼Ÿ</strong></h4><blockquote>
<p>mysqlå¯åŠ¨æŠ¥é”™æ€ä¹ˆåŠï¼Ÿ</p>
</blockquote>
<pre><code>    é”™è¯¯å¦‚ä¸‹ï¼šJob for mysqld.service failed because the control process exited with error code. See &quot;systemctl status mysqld.service&quot; and &quot;journalctl -xe&quot; for details.

    ç­”ï¼šå¯åŠ¨ä¸æˆåŠŸæ— éå°±æ˜¯å¯åŠ¨å‘½ä»¤ã€æœåŠ¡å™¨èµ„æºç¯å¢ƒã€my.cnfçš„é…ç½®æ–‡ä»¶é—®é¢˜ã€‚
    æŸ¥çœ‹mysqlæ—¥å¿—æ–‡ä»¶ï¼šcat /var/log/mysql.logï½œgrep ERROR
    åŸºæœ¬ä¸Šéƒ½æ˜¯é…ç½®æ–‡ä»¶çš„å‚æ•°æ‰“é”™å­—äº†
</code></pre>
<h4 id="æŸ¥è¯¢profile"><a href="#æŸ¥è¯¢profile" class="headerlink" title="æŸ¥è¯¢profile"></a><strong>æŸ¥è¯¢profile</strong></h4><blockquote>
<p>æ…¢æŸ¥è¯¢åªèƒ½æŸ¥åˆ°å¤§äºé¢„è®¾å€¼çš„è¯­å¥ï¼Œå¹¶ä¸”ä¸èƒ½æŸ¥çœ‹æ¯æ¡è¯­å¥çš„è€—æ—¶æƒ…å†µ</p>
</blockquote>
<ul>
<li>æŸ¥è¯¢mysqlæ˜¯å¦æ”¯æŒprofileæŸ¥è¯¢<pre><code>  select @@have_profiling
</code></pre>
</li>
<li>æŸ¥è¯¢profileæ˜¯å¦å¼€å¯<pre><code>  select @@profiling
</code></pre>
</li>
<li>å¼€å¯profile<pre><code>  set global/session profiling=1;
</code></pre>
</li>
<li>æŸ¥çœ‹profile<pre><code>  show profiles;
</code></pre>
</li>
<li>æŸ¥çœ‹profileæŒ‡å®šè¯­å¥<pre><code>  show profile for query æŸ¥è¯¢id;
</code></pre>
</li>
<li>æŸ¥çœ‹profileæŒ‡å®šè¯­å¥é™„å¸¦cpuä½¿ç”¨æƒ…å†µ<pre><code>  show profile cpu for query æŸ¥è¯¢id;
</code></pre>
</li>
</ul>
<h4 id="æŸ¥çœ‹explainæ‰§è¡Œè®¡åˆ’"><a href="#æŸ¥çœ‹explainæ‰§è¡Œè®¡åˆ’" class="headerlink" title="æŸ¥çœ‹explainæ‰§è¡Œè®¡åˆ’"></a><strong>æŸ¥çœ‹explainæ‰§è¡Œè®¡åˆ’</strong></h4><blockquote>
<p><strong>å¯ä»¥æŸ¥çœ‹æ˜¯å¦ç”¨åˆ°ç´¢å¼•ï¼Œè¡¨çš„è¿æ¥æƒ…å†µç­‰ä¿¡æ¯</strong></p>
</blockquote>
<ul>
<li>æŸ¥çœ‹explainæ‰§è¡Œè®¡åˆ’<pre><code>  explain/desc æŸ¥è¯¢è¯­å¥
</code></pre>
</li>
<li>å„å­—æ®µå«ä¹‰ï¼š<pre><code>  idï¼šæ“ä½œè¡¨çš„é¡ºåºï¼ˆidç›¸åŒï¼Œä»ä¸Šå¾€ä¸‹ä¾æ¬¡ï¼Œidä¸åŒï¼Œå€¼è¶Šå¤§ï¼Œè¶Šå…ˆæ‰§è¡Œï¼‰
  select_type:è¡¨ç¤ºselectçš„ç±»å‹ï¼Œå¸¸è§çš„æœ‰simpleï¼ˆç®€å•è¡¨ï¼Œä¸ä½¿ç”¨è¡¨è¿æ¥æˆ–è€…å­æŸ¥è¯¢ï¼‰ï¼Œprimaryï¼ˆä¸»æŸ¥è¯¢ï¼Œå¤–å±‚çš„æŸ¥è¯¢ï¼‰ï¼Œunionï¼ˆè”åˆæŸ¥è¯¢çš„ç¬¬äºŒä¸ªæˆ–è€…åé¢çš„æŸ¥è¯¢ï¼‰ï¼Œsubqueryï¼ˆselect/whereä¹‹ååŒ…å«äº†å­æŸ¥è¯¢ï¼‰
  typeï¼šæ€§èƒ½ç”±å¥½åˆ°å·®ä¸ºï¼šnullï¼Œsystemï¼Œconstï¼Œeq_ref,ref,range,index,allã€‚systemä¸ºæŸ¥è¯¢ç³»ç»Ÿå˜é‡ï¼Œconstä¸ºæŸ¥è¯¢ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•ï¼Œrefï¼šç”¨äº†è¾…åŠ©ç´¢å¼•ï¼Œindexï¼šç”¨äº†ç´¢å¼•ä½†å¯¹ç´¢å¼•å…¨è¡¨æ‰«æï¼Œallï¼šå…¨è¡¨æ‰«æ
  possiable_key:å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•
  keyï¼šå®é™…ç”¨åˆ°çš„ç´¢å¼•ï¼Œä¸ºnullåˆ™æ²¡æœ‰ç”¨åˆ°ç´¢å¼•
  key_lenï¼šç´¢å¼•ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œè¶Šå°è¶Šå¥½ï¼Œå’Œå€¼æœ‰å…³ç³»
  rowsï¼šå¿…é¡»æŸ¥è¯¢çš„è¡Œæ•°
  filteredï¼šè¿”å›ç»“æœå éœ€è¦è¯»å–çš„è¡Œæ•°çš„ç™¾åˆ†æ¯”ï¼Œ100ä¸ºæœ€å¥½
  Extreï¼šé¢å¤–ä¿¡æ¯
</code></pre>
</li>
</ul>
<h3 id="ç´¢å¼•ä½¿ç”¨"><a href="#ç´¢å¼•ä½¿ç”¨" class="headerlink" title="ç´¢å¼•ä½¿ç”¨"></a><strong>ç´¢å¼•ä½¿ç”¨</strong></h3><ul>
<li>æœ€å·¦æ³•åˆ™<pre><code>  è”åˆæŸ¥è¯¢ä¸­ï¼Œç´¢å¼•æœ€å·¦è¾¹çš„å¿…é¡»å­˜åœ¨ï¼Œå¹¶ä¸”ä¸èƒ½è·³è¿‡ä¸­é—´æŸä¸€åˆ—ï¼Œå¦åˆ™åé¢çš„ç´¢å¼•åˆ—å¤±æ•ˆ
</code></pre>
</li>
<li>èŒƒå›´æŸ¥è¯¢<pre><code>  è”åˆæŸ¥è¯¢ä¸­ï¼Œä¸èƒ½å‡ºç°ï¼ˆ&gt;,&lt;ï¼‰å¯ä»¥ä½¿ç”¨&lt;=,&gt;=ï¼Œå¦åˆ™åé¢çš„ç´¢å¼•å¤±æ•ˆ
</code></pre>
</li>
<li>ç´¢å¼•åˆ—è¿ç®—<pre><code>  ä¸è¦åœ¨ç´¢å¼•åˆ—ä¸Šè¿ç®—ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²æ“ä½œå‡½æ•°ï¼Œå¦åˆ™ç´¢å¼•å¤±æ•ˆ
</code></pre>
</li>
<li>å­—ç¬¦ä¸²ä¸åŠ å¼•å·<pre><code>  å­—ç¬¦ä¸²ç±»å‹åˆ—æŸ¥è¯¢ä¸åŠ å¼•å·å¯¼è‡´ç´¢å¼•å¤±æ•ˆ
</code></pre>
</li>
<li>æ¨¡ç³ŠåŒ¹é…<pre><code>  æ¨¡ç³ŠæŸ¥è¯¢åé¢æ¨¡ç³Šä¸å¤±æ•ˆï¼Œå‰é¢æ¨¡ç³Šå¤±æ•ˆ
</code></pre>
</li>
<li>orè¿æ¥çš„æ¡ä»¶<pre><code>  orè¿æ¥çš„æ¡ä»¶ï¼Œå¦‚æœä¿©è¾¹éƒ½æœ‰ç´¢å¼•ï¼Œåˆ™æœ‰æ•ˆï¼Œåªè¦ä¸€è¾¹æ²¡æœ‰åˆ™å¤±æ•ˆï¼Œå¯ä»¥å¯¹æ²¡æœ‰ç´¢å¼•çš„åˆ›å»ºç´¢å¼•
</code></pre>
</li>
<li>æ•°æ®åˆ†å¸ƒå½±å“<pre><code>  å¦‚æœmysqlè¯„ä¼°å…¨è¡¨æ‰«ææ¯”ç´¢å¼•è¿˜å¿«ï¼Œä¸ä¼šèµ°ç´¢å¼•ï¼Œä¼šå…¨è¡¨æ‰«æ
</code></pre>
</li>
<li>SQLæç¤º<pre><code>  SQLæç¤ºæ˜¯ä¼˜åŒ–æ•°æ®åº“çš„é‡è¦æ‰‹æ®µï¼Œåœ¨sqlè¯­å¥ä¸­æ’å…¥ä¸€äº›äººä¸ºä½ çš„æç¤ºæ¥ä¼˜åŒ–ï¼Œæ¯”å¦‚æœ‰å¤šä¸ªç´¢å¼•ï¼Œå¯ä»¥æŒ‡å®šä½¿ç”¨å“ªä¸ªç´¢å¼•
  use index ï¼šå»ºè®®æ•°æ®åº“ä½¿ç”¨ï¼Œä½†æ•°æ®åº“è¯„ä¼°åå¦‚æœä¸æ»¡æ„ï¼Œå¯èƒ½ä¸ä¼šé‡‡çº³        
  ignore index:ç›´æ¥å¿½ç•¥
  force indexï¼šå¼ºåˆ¶ä½¿ç”¨
  select * from è¡¨å use/ignore/force index(ç´¢å¼•å) where æ¡ä»¶;
</code></pre>
</li>
<li>è¦†ç›–ç´¢å¼•<pre><code>  å½“select åˆ—ä¸­æ‰€æœ‰è¿”å›çš„åˆ—éƒ½èƒ½åœ¨ç´¢å¼•ä¸­æ‰¾åˆ°ï¼Œæœ€ä¼˜ï¼Œå¦‚æœæ‰¾ä¸åˆ°éœ€è¦å›è¡¨æŸ¥æ‰¾èšé›†ç´¢å¼•ï¼Œæ€§èƒ½ç›¸å¯¹ä½ä¸€ç‚¹ï¼Œæ‰€ä»¥å°½é‡é¿å…select *ï¼Œå¯¹è¯­å¥ä¼˜åŒ–ï¼Œéœ€è¦åŒæ—¶ç…§é¡¾selectæŸ¥è¯¢çš„åˆ—
</code></pre>
</li>
<li>å‰ç¼€ç´¢å¼•<pre><code>  å¦‚æœä¸€ä¸ªå­—æ®µå†…å®¹æ¯”è¾ƒå¤§ï¼Œå¯ä»¥æ ¹æ®å‰ç¼€åˆ›å»ºå‰ç¼€ç´¢å¼•
      create index ç´¢å¼•åå­— on è¡¨å(åˆ—å(å‰ç¼€ä¸ªæ•°));

  å‰ç¼€ä¸ªæ•°å–å€¼é—®é¢˜ï¼š
      - å½“ç´¢å¼•é€‰æ‹©æ€§è¶Šé«˜è¶Šå¥½ï¼Œå¦‚å”¯ä¸€ç´¢å¼•é€‰æ‹©æ€§ä¸º1ï¼Œå¯ä»¥é€šè¿‡
          select count(distinct substring(å­—æ®µ,1,å‰ç¼€ä¸ªæ•°))/count(*) from è¡¨ where æ¡ä»¶
      - å‰ç¼€ä¸ªæ•°è¶Šå°‘è¶Šå¥½ï¼Œé€‰æ‹©æ€§è¶Šé«˜è¶Šå¥½ï¼Œç»¼åˆé€‰å–
</code></pre>
</li>
<li>å•åˆ—ç´¢å¼•å’Œè”åˆç´¢å¼•<pre><code>  å¦‚æœæ¡ä»¶æ˜¯å¤šä¸ªå­—æ®µï¼Œæ¨èä½¿ç”¨è”åˆç´¢å¼•ï¼Œå› ä¸ºä¸éœ€è¦å›è¡¨æŸ¥è¯¢
</code></pre>
</li>
</ul>
<h3 id="ç´¢å¼•è®¾è®¡åŸåˆ™"><a href="#ç´¢å¼•è®¾è®¡åŸåˆ™" class="headerlink" title="ç´¢å¼•è®¾è®¡åŸåˆ™"></a><strong>ç´¢å¼•è®¾è®¡åŸåˆ™</strong></h3><pre><code>    1. é’ˆå¯¹äºæ•°æ®é‡è¾ƒå¤§ï¼Œä¸”æŸ¥è¯¢æ¯”è¾ƒé¢‘ç¹çš„è¡¨å»ºç«‹ç´¢å¼•ã€‚
    2. é’ˆå¯¹äºå¸¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼ˆwhereï¼‰ã€æ’åºï¼ˆorder byï¼‰ã€åˆ†ç»„ï¼ˆgroup byï¼‰æ“ä½œçš„å­—æ®µå»ºç«‹ç´¢å¼•ã€‚
    3. å°½é‡é€‰æ‹©åŒºåˆ†åº¦é«˜çš„åˆ—ä½œä¸ºç´¢å¼•ï¼Œå°½é‡å»ºç«‹å”¯ä¸€ç´¢å¼•ï¼ŒåŒºåˆ†åº¦è¶Šé«˜ï¼Œä½¿ç”¨ç´¢å¼•çš„æ•ˆç‡è¶Šé«˜ã€‚
    4. å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µï¼Œå­—æ®µçš„é•¿åº¦è¾ƒé•¿ï¼Œå¯ä»¥é’ˆå¯¹äºå­—æ®µçš„ç‰¹ç‚¹ï¼Œå»ºç«‹å‰ç¼€ç´¢å¼•ã€‚
    5. å°½é‡ä½¿ç”¨è”åˆç´¢å¼•ï¼Œå‡å°‘å•åˆ—ç´¢å¼•ï¼ŒæŸ¥è¯¢æ—¶ï¼Œè”åˆç´¢å¼•å¾ˆå¤šæ—¶å€™å¯ä»¥è¦†ç›–ç´¢å¼•ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œé¿å…å›è¡¨ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚
    6. è¦æ§åˆ¶ç´¢å¼•çš„æ•°é‡ï¼Œç´¢å¼•å¹¶ä¸æ˜¯å¤šå¤šç›Šå–„ï¼Œç´¢å¼•è¶Šå¤šï¼Œç»´æŠ¤ç´¢å¼•ç»“æ„çš„ä»£ä»·ä¹Ÿå°±è¶Šå¤§ï¼Œä¼šå½±å“å¢åˆ æ”¹çš„æ•ˆç‡ã€‚
    7. å¦‚æœç´¢å¼•åˆ—ä¸èƒ½å­˜å‚¨NULLå€¼ï¼Œè¯·åœ¨åˆ›å»ºè¡¨æ—¶ä½¿ç”¨NOT NULLçº¦æŸå®ƒã€‚å½“ä¼˜åŒ–å™¨çŸ¥é“æ¯åˆ—æ˜¯å¦åŒ…å«NULLå€¼æ—¶ï¼Œå®ƒå¯ä»¥æ›´å¥½åœ°ç¡®å®šå“ªä¸ªç´¢å¼•æœ€æœ‰æ•ˆåœ°ç”¨äºæŸ¥è¯¢ã€‚å¦åˆ™å¯¼è‡´å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œéè¦ä½¿ç”¨nullï¼Œå¯ä»¥åœ¨nullä¸Šè®¾ç½®é»˜è®¤å€¼0ï¼Œç¡®ä¿è¡¨ä¸­numåˆ—æ²¡æœ‰nullå€¼
    8. å°½é‡ä½¿ç”¨æ•°å­—ç±»å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µï¼Œå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹ï¼Œè¿™æ ·ä¼šé™ä½æŸ¥è¯¢å’Œè¿æ¥çš„æ€§èƒ½ï¼Œå¹¶ä¼šå¢åŠ å­˜å‚¨å¼€é”€ï¼Œè¿™æ˜¯å› ä¸ºå¼•æ“åœ¨å¤„ç†æŸ¥è¯¢å’Œè¿æ¥æ—¶ï¼Œä¼šé€ä¸ªæ¯”è¾ƒå­—ç¬¦ä¸²ä¸­æ¯ä¸€ä¸ªå­—ç¬¦ã€‚è€Œå¯¹äºæ•°å­—å‹è€Œè¨€ï¼Œåªéœ€è¦å¯¹æ¯”ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚
    9. å¯¹äºå­æŸ¥è¯¢æ…ç”¨ inï¼Œå¯ä»¥å°†å­æŸ¥è¯¢å½“æˆä¸€å¼ è¡¨è¿æ¥æŸ¥è¯¢ï¼Œè¦†ç›–ç´¢å¼•+è¿æ¥æŸ¥è¯¢
</code></pre>
<h2 id="SQLä¼˜åŒ–"><a href="#SQLä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ–"></a><strong>SQLä¼˜åŒ–</strong></h2><h3 id="æ’å…¥ä¼˜åŒ–"><a href="#æ’å…¥ä¼˜åŒ–" class="headerlink" title="æ’å…¥ä¼˜åŒ–"></a><strong>æ’å…¥ä¼˜åŒ–</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">--1.æ‰¹é‡æ’å…¥</span><br><span class="line">		ä¸€ä¸ªä¸ªæ’å…¥ï¼Œæ¯æ¬¡éƒ½è¦ä¸æ•°æ®åº“è¿æ¥ï¼Œç½‘ç»œæ•°æ®ä¼ è¾“</span><br><span class="line">		å¦‚æœä¸€æ¬¡æ€§æ’å…¥çš„æ•°æ®é‡è¿‡å¤§ï¼Œä¹Ÿä¸å»ºè®®ä¸€æ¡è¯­å¥ä¸€æ¬¡æ€§å…¨éƒ¨æ’å…¥ï¼Œä¸€æ¡è¯­å¥500-1000åˆé€‚</span><br><span class="line">		insert into è¡¨å values(å€¼1ï¼Œå€¼2),(...),(...);</span><br><span class="line">--2.æ‰‹åŠ¨å¼€å¯äº‹åŠ¡</span><br><span class="line">		æ’å…¥è¯­å¥ç»“æŸåè‡ªåŠ¨æäº¤äº‹åŠ¡ï¼Œæ¯æ¡è¯­å¥éƒ½ä¼šï¼Œå¤ªé¢‘ç¹å½±å“æ€§èƒ½</span><br><span class="line">		begin/start transaction;</span><br><span class="line">		insert into è¡¨å values(å€¼1ï¼Œå€¼2),(...),(...);</span><br><span class="line">		insert into è¡¨å values(å€¼1ï¼Œå€¼2),(...),(...);</span><br><span class="line">		...</span><br><span class="line">		commit;</span><br><span class="line">--3.ä¸»é”®é¡ºåºæ’å…¥</span><br><span class="line">		ä¸»é”®é¡ºåºæ’å…¥è¦ä¼˜äºä¹±åºæ’å…¥,åŸºäºæ•°æ®ç»„ç»‡ç»“æ„çš„</span><br></pre></td></tr></table></figure>

<p><strong>å¤§æ‰¹é‡æ•°æ®æ’å…¥</strong></p>
<blockquote>
<p>å¦‚æœå¤§æ‰¹é‡æ•°æ®è¦æ’å…¥insertæ’å…¥æ•ˆç‡æä½ï¼Œè€—æ—¶æé•¿ï¼Œå¯ä»¥ä½¿ç”¨mysqlæä¾›çš„loadæŒ‡ä»¤</p>
</blockquote>
<ol>
<li>è¿æ¥mysqlå®¢æˆ·ç«¯æ—¶éœ€è¦æºå¸¦å‚æ•°â€“localâ€”infile<pre><code> mysql --local-infile -u ç”¨æˆ·å -p å¯†ç 
</code></pre>
</li>
<li>è®¾ç½®å…¨å±€å‚æ•°ï¼Œå¼€å¯æœ¬åœ°åŠ è½½æ–‡ä»¶å¯¼å…¥è¡¨çš„å¼€å…³<pre><code> set global local_infile = 1ï¼›
</code></pre>
</li>
<li>æ‰§è¡ŒloadæŒ‡ä»¤<pre><code> load data local infile â€˜è·¯å¾„â€™ into table è¡¨å fields terminated by â€˜,â€™ lines terminated by &#39;\n&#39;;
</code></pre>
</li>
</ol>
<h3 id="ä¸»é”®ä¼˜åŒ–"><a href="#ä¸»é”®ä¼˜åŒ–" class="headerlink" title="ä¸»é”®ä¼˜åŒ–"></a><strong>ä¸»é”®ä¼˜åŒ–</strong></h3><h4 id="é¡µåˆ†è£‚"><a href="#é¡µåˆ†è£‚" class="headerlink" title="é¡µåˆ†è£‚"></a><strong>é¡µåˆ†è£‚</strong></h4><blockquote>
<ul>
<li><strong>åœ¨innodbå­˜å‚¨å¼•æ“ä¸­ï¼Œæ•°æ®æ˜¯æŒ‰ä¸»é”®é¡ºåºå­˜å‚¨çš„</strong>ï¼Œ<strong>ä¸€é¡µå­˜æ”¾å¤šæ¡æ•°æ®ï¼Œé¡µä¹‹é—´åŒå‘æŒ‡é’ˆç»´æŠ¤</strong></li>
<li><strong>ä¹±åºæ’å…¥æ—¶ï¼Œå¦‚æœæŸä¸€é¡µçš„ä½ç½®æ»¡äº†ï¼Œæ’ä¸è¿›å»ï¼Œä¼šæ”¾åˆ°å¦ä¸€é¡µä¸­ï¼ŒæŠŠé‚£é¡µçš„ä¸€åŠä¹Ÿæ”¾è¿›å»ï¼Œé‡æ–°ç»´æŠ¤åŒå‘æŒ‡é’ˆ</strong></li>
</ul>
</blockquote>
<img src="http://hexo.xuxin.world/mysql/image-20220609181121685.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220609181148669.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220609181210985.png" width="100%" / loading="lazy">



<h4 id="é¡µåˆå¹¶"><a href="#é¡µåˆå¹¶" class="headerlink" title="é¡µåˆå¹¶"></a><strong>é¡µåˆå¹¶</strong></h4><blockquote>
<ul>
<li><strong>åˆ é™¤æ•°æ®æ—¶ï¼Œä¸æ˜¯æ­£çœŸåˆ é™¤ï¼Œè€Œæ˜¯è®¾ç½®æ ‡è®°ï¼Œå…è®¸å…¶ä»–æ•°æ®ä½¿ç”¨ï¼Œå½“æ ‡è®°æ•°è¾¾åˆ°ä¸€é¡µä¸­çš„æŸä¸ªé˜ˆå€¼ï¼ˆMERGE_THRESHOLDï¼‰ä¼šè¿›è¡Œé¡µåˆå¹¶æ“ä½œï¼Œåˆ¤æ–­å·¦å³æœ‰æ²¡æœ‰ä¸€åŠçš„ç©ºé—´ï¼Œåˆæˆä¸€é¡µ</strong></li>
<li><strong>MERGE_THRESHOLDï¼šåˆå¹¶é¡µé˜ˆå€¼ï¼Œé»˜è®¤æ˜¯50%ï¼Œå¯ä»¥è‡ªå·±è®¾ç½®ï¼Œåœ¨åˆ›å»ºè¡¨æˆ–è€…åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šã€‚</strong></li>
</ul>
</blockquote>
<h4 id="ä¸»é”®è®¾è®¡åŸåˆ™"><a href="#ä¸»é”®è®¾è®¡åŸåˆ™" class="headerlink" title="ä¸»é”®è®¾è®¡åŸåˆ™"></a><strong>ä¸»é”®è®¾è®¡åŸåˆ™</strong></h4><pre><code>    1. æ»¡è¶³ä¸šåŠ¡éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œå°½é‡é™ä½ä¸»é”®çš„é•¿åº¦ã€‚
    2. æ’å…¥æ•°æ®æ—¶ï¼Œå°½é‡é€‰æ‹©é¡ºåºæ’å…¥ï¼Œé€‰æ‹©ä½¿ç”¨AUTO INCREMENTè‡ªå¢ä¸»é”®ã€‚
    3. å°½é‡ä¸è¦ä½¿ç”¨UUIDåšä¸»é”®æˆ–è€…æ˜¯å…¶ä»–è‡ªç„¶ä¸»é”®ï¼Œå¦‚èº«ä»½è¯å·å…¬
    4. ä¸šåŠ¡æ“ä½œæ—¶ï¼Œé¿å…å¯¹ä¸»é”®çš„ä¿®æ”¹ã€‚
</code></pre>
<h3 id="orderbyä¼˜åŒ–"><a href="#orderbyä¼˜åŒ–" class="headerlink" title="orderbyä¼˜åŒ–"></a><strong>orderbyä¼˜åŒ–</strong></h3><blockquote>
<ul>
<li>Using filesortï¼šé€šè¿‡è¡¨çš„ç´¢å¼•æˆ–å…¨è¡¨æ‰«æï¼Œè¯»å–æ»¡è¶³æ¡ä»¶çš„æ•°æ®è¡Œï¼Œç„¶ååœ¨æ’åºç¼“å†²åŒºsort bufferä¸­å®Œæˆæ’åºæ“ä½œï¼Œæ‰€æœ‰ä¸æ˜¯é€šè¿‡ç´¢å¼•ç›´æ¥è¿”å›æ’åºç»“æœçš„æ’åºéƒ½å«FileSortæ’åºã€‚</li>
<li>Using indexï¼šé€šè¿‡æœ‰åºç´¢å¼•é¡ºåºæ‰«æç›´æ¥è¿”å›æœ‰åºæ•°æ®ï¼Œè¿™ç§æƒ…å†µå³ä¸ºusing indexï¼Œä¸éœ€è¦é¢å¤–æ’åºï¼Œæ“ä½œæ•ˆç‡é«˜ã€‚ã€</li>
</ul>
<p><strong>æ³¨æ„</strong>ï¼šå½“orderbyçš„å¤šå­—æ®µåŒæ—¶å‡åºæˆ–é™åºèµ°ç´¢å¼•ï¼Œä¸åŒèµ°ç¼“å†²åŒºï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ç´¢å¼•æˆ–è€…åªæœ‰ä¸€ä¸ªï¼Œä¸å¥½æ„æ€ï¼Œå›è¡¨æ‰«æï¼Œå¾—åˆ°å®Œæ•´æ•°æ®å†æ”¾è¿‡ç¼“å†²åŒº</p>
</blockquote>
<blockquote>
<p>ä¼˜åŒ–åŸåˆ™<br>        1. æ ¹æ®æ’åºå­—æ®µå»ºç«‹åˆé€‚çš„ç´¢å¼•ï¼Œå¤šå­—æ®µæ’åºæ—¶ï¼Œä¹Ÿéµå¾ªæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚<br>        2. å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•ã€‚<br>        3. å¤šå­—æ®µæ’åºï¼Œä¸€ä¸ªå‡åºä¸€ä¸ªé™åºï¼Œæ­¤æ—¶éœ€è¦æ³¨æ„è”åˆç´¢å¼•åœ¨åˆ›å»ºæ—¶çš„è§„åˆ™ï¼ˆASC/DESCï¼‰ã€‚<br>                create index ç´¢å¼•å on è¡¨å(åˆ— desc,åˆ— asc);<br>        4. å¦‚æœä¸å¯é¿å…çš„å‡ºç°filesortï¼Œå¤§æ•°æ®é‡æ’åºæ—¶ï¼Œå¯ä»¥é€‚å½“å¢å¤§æ’åºç¼“å†²åŒºå¤§å°sort buffer_sizeï¼ˆé»˜è®¤256kï¼‰å› ä¸ºå¦‚æœè¶…è¿‡äº†è¿™ä¸ªå€¼ï¼Œä¼šåœ¨ç£ç›˜æ–‡ä»¶ä¸­æ’åºï¼Œæ•ˆç‡ä½</p>
</blockquote>
<h3 id="groupbyä¼˜åŒ–"><a href="#groupbyä¼˜åŒ–" class="headerlink" title="groupbyä¼˜åŒ–"></a><strong>groupbyä¼˜åŒ–</strong></h3><pre><code>    1. åœ¨åˆ†ç»„æ“ä½œæ—¶ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•æ¥æé«˜æ•ˆç‡
    2. åˆ†ç»„æ“ä½œæ—¶ï¼Œç´¢å¼•çš„ä½¿ç”¨ä¹Ÿæ˜¯æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™çš„ã€‚
</code></pre>
<h3 id="limitä¼˜åŒ–"><a href="#limitä¼˜åŒ–" class="headerlink" title="limitä¼˜åŒ–"></a><strong>limitä¼˜åŒ–</strong></h3><blockquote>
<ul>
<li>åœ¨å¤§æ•°æ®é‡ä¸‹åˆ†é¡µæŸ¥è¯¢ï¼Œlimit 2000000ï¼Œ10ä¸­ç¬¬ä¸€ä¸ªå‚æ•°è¶Šå¤§ï¼Œè€—æ—¶è¶Šé•¿ã€‚æ­¤æ—¶æŸ¥è¯¢éœ€è¦2000010è¡Œï¼Œä½†è¿”å›åªæœ‰10è¡Œï¼Œ2000000è¡Œè¢«ä¸¢å¼ƒäº†</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>ä¼˜åŒ–æ€è·¯ï¼šä¸€èˆ¬åˆ†é¡µæŸ¥è¯¢æ—¶ï¼Œé€šè¿‡åˆ›å»º è¦†ç›–ç´¢å¼• èƒ½å¤Ÿæé«˜æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡è¦†ç›–ç´¢å¼•åŠ å­æŸ¥è¯¢å½¢å¼è¿›è¡Œä¼˜åŒ–</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>åœ¨inçš„å­æŸ¥è¯¢ä¸­ä¸èƒ½æœ‰limitï¼Œå¯ä»¥æŠŠå­æŸ¥è¯¢çš„è¯­å¥å½“æˆä¸€å¼ è¡¨æ¥å¤šè¡¨æŸ¥è¯¢</li>
</ul>
</blockquote>
<h3 id="countä¼˜åŒ–"><a href="#countä¼˜åŒ–" class="headerlink" title="countä¼˜åŒ–"></a><strong>countä¼˜åŒ–</strong></h3><blockquote>
<p><strong>MYISAMå¼•æ“ç»´æŠ¤ä¸€ä¸ªè¡¨çš„æ€»è¡Œæ•°ï¼Œå¯¹äºæ²¡æœ‰æ¡ä»¶çš„countï¼ˆ*ï¼‰ï¼Œæ•ˆç‡å¾ˆé«˜</strong><br><strong>Innodbåˆ™éœ€è¦ä¸€è¡Œè¡Œæ•°æ®å–å‡ºæ¥è®¡æ•°</strong><br><strong>ä¼˜åŒ–æ€è·¯</strong></p>
</blockquote>
<img src="http://hexo.xuxin.world/mysql/image-20220609191955401.png" width="100%" / loading="lazy">


<h3 id="Updateä¼˜åŒ–"><a href="#Updateä¼˜åŒ–" class="headerlink" title="Updateä¼˜åŒ–"></a><strong>Updateä¼˜åŒ–</strong></h3><blockquote>
<p><strong>InnoDBçš„è¡Œé”æ˜¯é’ˆå¯¹ç´¢å¼•åŠ çš„é”ï¼Œä¸æ˜¯é’ˆå¯¹è®°å½•åŠ çš„é”ï¼Œå¹¶ä¸”è¯¥ç´¢å¼•ä¸èƒ½å¤±æ•ˆï¼Œå¦åˆ™ä¼šä»è¡Œé”å‡çº§ä¸ºè¡¨é”ã€‚</strong></p>
</blockquote>
<h3 id="å¤šè¡¨æŸ¥è¯¢ä¼˜åŒ–"><a href="#å¤šè¡¨æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="å¤šè¡¨æŸ¥è¯¢ä¼˜åŒ–"></a><strong>å¤šè¡¨æŸ¥è¯¢ä¼˜åŒ–</strong></h3><pre><code>    1. fromå’Œjoinï¼Œé€‰æ‹©join
    2. left joinçš„é©±åŠ¨è¡¨æ˜¯å·¦è¾¹ï¼Œå°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œä¸è¿‡mysqlä¼˜åŒ–å™¨æœ‰ä¼˜åŒ–ï¼Œè‡ªåŠ¨å°†ç»“æœé›†å°çš„å½“é©±åŠ¨è¡¨
    3. åèŒƒå¼è®¾è®¡ï¼ŒèŒƒå¼æ˜¯å‡å°‘æ•°æ®å†—ä½™èŠ‚çœç£ç›˜çš„ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´
    4. åˆ›å»ºå¤–é”®ç´¢å¼•ï¼Œå¦‚æœä¸­é—´è¡¨å¤šä¸ªå­—æ®µç”¨åˆ°æ¡ä»¶ä¸Šï¼Œå¯ä»¥æŠŠå¤šä¸ªå¤–é”®å»ºç«‹è”åˆç´¢å¼•
</code></pre>
<h2 id="å­˜å‚¨å¯¹è±¡"><a href="#å­˜å‚¨å¯¹è±¡" class="headerlink" title="å­˜å‚¨å¯¹è±¡"></a><strong>å­˜å‚¨å¯¹è±¡</strong></h2><h3 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a><strong>è§†å›¾</strong></h3><ul>
<li><p>è§†å›¾ä»‹ç»    </p>
<pre><code>  è§†å›¾ï¼ˆViewï¼‰æ˜¯ä¸€ç§è™šæ‹Ÿå­˜åœ¨çš„è¡¨ã€‚è§†å›¾ä¸­çš„æ•°æ®å¹¶ä¸åœ¨æ•°æ®åº“ä¸­å®é™…å­˜åœ¨ï¼Œè¡Œå’Œåˆ—æ•°æ®æ¥è‡ªå®šä¹‰è§†å›¾çš„æŸ¥è¯¢ä¸­ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ä¸”æ˜¯åœ¨ä½¿ç”¨è§†å›¾æ—¶åŠ¨æ€ç”Ÿæˆçš„ã€‚
  é€šä¿—çš„è®²ï¼Œè§†å›¾åªä¿å­˜äº†æŸ¥è¯¢çš„SQLé€»è¾‘ï¼Œä¸ä¿å­˜æŸ¥è¯¢ç»“æœã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨åˆ›å»ºè§†å›¾çš„æ—¶å€™ï¼Œä¸»è¦çš„å·¥ä½œå°±è½åœ¨åˆ›å»ºè¿™æ¡SQLæŸ¥è¯¢è¯­å¥ä¸Šã€‚
</code></pre>
</li>
<li><p>åŸºæœ¬ä½¿ç”¨</p>
<pre><code>  1. åˆ›å»ºè§†å›¾
          create or replace view view_dept as select * from dept where id &lt; 10 ;
  2. ä¿®æ”¹è¯•å›¾
          create or replace view view_dept as select  id from dept where id&lt;10;
          alter view view_dept as select id from dept where id&lt;10;
  3. åˆ é™¤è¯•å›¾
          drop view if exists view_dept;
</code></pre>
</li>
<li><p>è§†å›¾æ£€æŸ¥é€‰é¡¹</p>
<pre><code>  å½“ä½¿ç”¨WITH CHECK OPTIONå­å¥åˆ›å»ºè§†å›¾æ—¶ï¼ŒMySQLä¼šé€šè¿‡è§†å›¾æ£€æŸ¥æ­£åœ¨æ›´æ”¹çš„æ¯ä¸ªè¡Œï¼Œä¾‹å¦‚æ’å…¥ï¼Œæ›´æ–°ï¼Œåˆ é™¤ï¼Œä»¥ä½¿å…¶ç¬¦åˆè§†å›¾çš„å®šä¹‰ã€‚
  MySQLå…è®¸åŸºäºå¦ä¸€ä¸ªè§†å›¾åˆ›å»ºè§†å›¾ï¼Œå®ƒè¿˜ä¼šæ£€æŸ¥ä¾èµ–è§† å›¾ä¸­çš„è§„åˆ™ä»¥ä¿æŒä¸€è‡´æ€§ã€‚ä¸ºäº†ç¡®å®šæ£€æŸ¥çš„èŒƒå›´ï¼Œmysqlæä¾›äº†ä¸¤ä¸ªé€‰é¡¹ï¼šï¼ˆæ­¤å¤–è§†å›¾å¢åˆ æ”¹ä¼šåœ¨åŸºè¡¨ä¸Šè®°å½•ï¼‰
      CASCADEDï¼ˆé»˜è®¤ï¼‰
      LOCAL 
  è¯­æ³•ï¼šcreate or replace view view_dept as select * from dept where id &lt; 10 with check option;
  - with cascaded check option
          é›†è”æ£€æŸ¥ï¼Œä¼šæ£€æŸ¥å½“å‰è§†å›¾åŒ…æ‹¬æ‰€ä¾èµ–çš„æ‰€æœ‰è§†å›¾ï¼ˆå³ä½¿ä¾èµ–çš„è§†å›¾æ²¡æœ‰æ£€æŸ¥é€‰é¡¹ï¼‰ï¼Œä¹Ÿæ˜¯é»˜è®¤æ–¹å¼ã€‚
  - with local check option
          ä¼šæ£€æŸ¥å½“å‰åŒ…æ‹¬é€’å½’æ£€æŸ¥ä¾èµ–çš„è§†å›¾ï¼Œä½†å¦‚æœä¾èµ–çš„æ²¡æœ‰æ£€æŸ¥é€‰é¡¹åˆ™ä¸æ£€æŸ¥
</code></pre>
</li>
<li><p>è§†å›¾çš„æ›´æ–°</p>
<pre><code>  æ³¨æ„ï¼šè¦ä½¿è§†å›¾å¯æ›´æ–°ï¼Œè§†å›¾ä¸­çš„è¡Œä¸åŸºç¡€è¡¨ä¸­çš„è¡Œä¹‹é—´å¿…é¡»å­˜åœ¨ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚å¦‚æœè§†å›¾åŒ…å«ä»¥ä¸‹ä»»ä½•ä¸€é¡¹ï¼Œåˆ™è¯¥è§†å›¾ä¸å¯æ›´æ–°ï¼š
  1. èšåˆå‡½æ•°æˆ–çª—å£å‡½æ•°ï¼ˆSUMï¼ˆï¼‰ã€MINï¼ˆï¼‰ã€MAXï¼ˆï¼‰ã€COUNTç­‰ï¼‰
  2. DISTINCT
  3. GROUP BY
  4. HAVING
  5. UNIONæˆ–è€…UNION ALL
</code></pre>
</li>
<li><p>è§†å›¾çš„ä½œç”¨</p>
<pre><code>  1. ç®€å•
      ç»å¸¸ä½¿ç”¨çš„æŸ¥è¯¢å¯ä»¥è¢«å®šä¹‰ä¸ºè§†å›¾ï¼Œä¸å¿…ä¸ºä»¥åçš„æ“ä½œæ¯æ¬¡æŒ‡å®šå…¨éƒ¨çš„æ¡ä»¶ã€‚
  2. å®‰å…¨
      æ•°æ®åº“å¯ä»¥æˆæƒï¼Œä½†ä¸èƒ½æˆæƒåˆ°æ•°æ®åº“ç‰¹å®šè¡Œå’Œç‰¹å®šçš„åˆ—ä¸Šã€‚é€šè¿‡è§†å›¾ç”¨æˆ·åªèƒ½æŸ¥è¯¢å’Œä¿®æ”¹ä»–ä»¬æ‰€èƒ½è§åˆ°çš„æ•°æ®
  3. æ•°æ®ç‹¬ç«‹
      è§†å›¾å¯å¸®åŠ©ç”¨æˆ·å±è”½çœŸå®è¡¨ç»“æ„å˜åŒ–å¸¦æ¥çš„å½±å“ã€‚å¦‚ï¼šåŸºè¡¨å­—æ®µæ¢åå­—äº†ï¼Œè§†å›¾åªéœ€è¦å…¶åˆ«åå°±è¡Œ
</code></pre>
</li>
</ul>
<h3 id="å­˜å‚¨è¿‡ç¨‹"><a href="#å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹"></a><strong>å­˜å‚¨è¿‡ç¨‹</strong></h3><h4 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a><strong>åŸºæœ¬ä½¿ç”¨</strong></h4><ul>
<li>ä»‹ç»<pre><code>  å­˜å‚¨è¿‡ç¨‹æ˜¯äº‹å…ˆç»è¿‡ç¼–è¯‘å¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ä¸€æ®µSQLè¯­å¥çš„é›†åˆï¼Œè°ƒç”¨å­˜å‚¨è¿‡ç¨‹å¯ä»¥ç®€åŒ–åº”ç”¨å¼€å‘äººå‘˜çš„å¾ˆå¤šå·¥ä½œ
  å‡å°‘æ•°æ®åœ¨æ•°æ®åº“å’Œåº”ç”¨æœåŠ¡å™¨ä¹‹é—´çš„ä¼ è¾“ï¼Œå¯¹äºæé«˜æ•°æ®å¤„ç†çš„æ•ˆç‡æ˜¯æœ‰å¥½å¤„çš„ã€‚
  å­˜å‚¨è¿‡ç¨‹æ€æƒ³ä¸Šå¾ˆç®€å•ï¼Œå°±æ˜¯æ•°æ®åº“SQLè¯­è¨€å±‚é¢çš„ä»£ç å°è£…ä¸é‡ç”¨ã€‚
</code></pre>
</li>
<li>ç‰¹ç‚¹<pre><code>  å°è£…ï¼Œå¤ç”¨
  å¯ä»¥æ¥æ”¶å‚æ•°ï¼Œä¹Ÿå¯ä»¥è¿”å›æ•°æ®
  å‡å°‘ç½‘ç»œäº¤äº’ï¼Œæ•ˆç‡æå‡
</code></pre>
</li>
<li>è¯­æ³•<pre><code>  1. åˆ›å»ºï¼š
          create procedure p1()
          begin
          select * from dept where id &lt;= 10;
          end;
      æ³¨æ„ï¼šåœ¨å‘½ä»¤è¡Œä¸­åˆ›å»ºæ—¶éœ€è¦æŒ‡å®šç»“æŸç¬¦ï¼Œä½¿ç”¨delimiteræŒ‡å®šï¼Œdelimiter $$
  2. è°ƒç”¨ï¼š
          call p1();
  3. æŸ¥çœ‹
          select * from information_schema.ROUTINES where ROUTINE_SCHEMA = &#39;test&#39;;
          show create procedure p1;
  4. åˆ é™¤    
          drop procedure if exists p1;              
</code></pre>
</li>
</ul>
<h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a><strong>å˜é‡</strong></h4><ol>
<li>ç³»ç»Ÿå˜é‡<pre><code> --ä»‹ç»ï¼šç³»ç»Ÿå˜é‡æ˜¯mysqlæœåŠ¡å™¨æä¾›çš„ï¼Œå±äºæœåŠ¡å™¨å±‚é¢ï¼Œåˆ†ä¸ºå…¨å±€å˜é‡(global)å’Œä¼šè¯å˜é‡(session)
 --æŸ¥çœ‹ç³»ç»Ÿå˜é‡
     show global variables;
     show global variables like &#39;have_profiling&#39;;
     select @@have_profiling;
 --è®¾ç½®ç³»ç»Ÿå˜é‡
     set session autocommit = 0;
     set @@autocommit = 1; 
æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰æŒ‡å®šsession/globalï¼Œé»˜è®¤æ˜¯sessionï¼Œä¼šè¯çº§åˆ«
     mysqlæœåŠ¡é‡å¯ä¹‹åï¼Œæ‰€è®¾ç½®çš„å…¨å±€å‚æ•°ä¼šå¤±æ•ˆï¼Œè¦æƒ³ä¸å¤±æ•ˆï¼Œå¯ä»¥åœ¨/etc/my.cnfä¸­é…ç½®
</code></pre>
</li>
<li>ç”¨æˆ·è‡ªå®šä¹‰å˜é‡<pre><code>     --ä»‹ç»ï¼šç”¨æˆ·è‡ªå®šä¹‰å˜é‡ä¸éœ€è¦æå‰å£°æ˜ï¼Œç”¨çš„æ—¶å€™ç›´æ¥ç”¨@å˜é‡åï¼Œä½œç”¨åŸŸä¸ºå½“å‰è¿æ¥
     --èµ‹å€¼
     1. set @myname = &#39;å¾é‘«&#39;;
     2. set @myage := 18;
     3. set @mygender := &#39;ç”·&#39;,@myhobby := &#39;java&#39;;
     4. select @mycolor := &#39;red&#39;;
     5. select count(*) into @mycount from dept;
         --ä½¿ç”¨
                 select @myname, @myage, @mygender, @myhobby, @mycolor, @mycount;
       æ³¨æ„ï¼šç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡æ— éœ€å£°æ˜ï¼Œå¯¹äºæ²¡æœ‰èµ‹å€¼çš„ï¼Œå–åˆ°çš„æ˜¯nullè€Œä¸ä¼šæŠ¥é”™
</code></pre>
</li>
<li>å±€éƒ¨å˜é‡<pre><code> --ä»‹ç»ï¼šå±€éƒ¨å˜é‡æ˜¯æ ¹æ®éœ€è¦å®šä¹‰çš„åœ¨å±€éƒ¨ç”Ÿæ•ˆçš„å˜é‡ï¼Œè®¿é—®ä¹‹å‰ï¼Œéœ€è¦DECLAREå£°æ˜ã€‚å¯ç”¨ä½œå­˜å‚¨è¿‡ç¨‹å†…çš„å±€éƒ¨å˜é‡å’Œè¾“å…¥å‚æ•°ï¼Œå±€éƒ¨å˜é‡
 --å£°æ˜
     declare å˜é‡å å˜é‡ç±»å‹ [default å€¼];
     å˜é‡ç±»å‹å°±æ˜¯æ•°æ®åº“å­—æ®µç±»å‹ï¼šintï¼Œbigintï¼Œcharï¼Œvarcharï¼Œdateï¼Œtimeç­‰
 --èµ‹å€¼
     set å˜é‡å=å€¼;
     set å˜é‡å:=å€¼;
     select å­—æ®µ into å˜é‡å from è¡¨å;
 --å®ä¾‹
     create procedure p2()
     begin
         declare a int;
         select count(*) into a from dept;
         select a;
     end;
</code></pre>
</li>
</ol>
<h4 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a><strong>æµç¨‹æ§åˆ¶</strong></h4><ul>
<li><p>if</p>
<pre><code>  è¯­æ³•ï¼š

  if æ¡ä»¶ then
  ...
  elseif æ¡ä»¶ then
  ...
  else
  ...
  end if;
</code></pre>
</li>
<li><p>å‚æ•°</p>
<pre><code>  inï¼šè¾“å…¥å‚æ•°
  outï¼šè¾“å‡ºå‚æ•°ï¼Œéœ€è¦æ‹¿ç”¨æˆ·è‡ªå®šä¹‰å˜é‡æ¥æ”¶
  inoutï¼šæ—¢æ˜¯è¾“å…¥åˆæ˜¯è¾“å‡ºï¼Œéœ€è¦ä¼ ç”¨æˆ·è‡ªå®šä¹‰å˜é‡å¹¶ä¸”èµ‹å€¼           
  å®ä¾‹ï¼š
      create procedure p4(in score int ,out result varchar(10))
      begin
      if score &gt;= 85 then
              set result = &#39;ä¼˜ç§€&#39;;
      elseif score &gt;= 60 then
              set result = &#39;åŠæ ¼&#39;;
      else
              set result = &#39;ä¸åŠæ ¼&#39;;
      end if;
      select result;
      end;
      
      set @score := 32;
      call p4(@score,@result);
      select @result;
</code></pre>
</li>
<li><p>case</p>
<pre><code>     ç¬¬ä¸€ç§ï¼š
         case å˜é‡
         when å€¼ then ...
         when å€¼ then ...
         else ...
         end case;
     ç¬¬äºŒç§ï¼š
         case 
         when æ¡ä»¶ then ...
         when æ¡ä»¶ then ...
         else ...
         end case;
     å®ä¾‹ï¼š
      create procedure p5(in a int)
      begin
          declare result varchar(10);
          case
              when a &lt;= 3 and a &gt;= 1 then
                  set result := &#39;ç¬¬ä¸€å­£åº¦&#39;;
              when a &lt;= 6 and a &gt;= 4 then
                  set result := &#39;ç¬¬äºŒå­£åº¦&#39;;
              when a &lt;= 9 and a &gt;= 7 then
                  set result := &#39;ç¬¬ä¸‰å­£åº¦&#39;;
              when a &lt;= 12 and a &gt;= 10 then
                  set result := &#39;ç¬¬å››å­£åº¦&#39;;
          end case;
          select concat(&#39;ä½ è¾“å…¥çš„æœˆä»½ä¸º&#39;,a,&#39;ï¼Œç»“æœä¸º&#39;,result);
      end;
      call p5(4);
</code></pre>
</li>
<li><p>while</p>
<pre><code>  è¯­æ³•ï¼š
          while æ¡ä»¶ do ...
          end while;
  å®ä¾‹ï¼š
        create procedure p6(in n int)
        begin
            declare tmp int default 1;
            declare result int default 0;
            while tmp&lt;=n do
                set result = result+tmp;
                set tmp = tmp+1;
            end while;
            select result;
        end;
        call p6(3);
</code></pre>
</li>
<li><p>repeat</p>
<pre><code>   ä»‹ç»ï¼šæœ‰æ¡ä»¶å¾ªç¯ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡ï¼Œå†çœ‹æ¡ä»¶ï¼Œç›´åˆ°æ»¡è¶³åˆ™é€€å‡º
   è¯­æ³•ï¼š
           repeat ... 
           until æ¡ä»¶
           end repeat;
   å®ä¾‹ï¼š
           create procedure p7(in a int)
          begin
              declare result int default 0;
              declare tmp int default a;
              repeat
                  set result := result + tmp;
                  set tmp := tmp - 1;
              until tmp = 0
              end repeat;
              select result;
          end;
          call p7(2);
</code></pre>
</li>
<li><p>loop</p>
<pre><code>  ä»‹ç»ï¼šæ­»å¾ªç¯ï¼Œåˆ©ç”¨leaveå’Œiterateæ¥æ§åˆ¶æµç¨‹
  leave æ ‡å¿—:é€€å‡ºå¾ªç¯
  iterate æ ‡å¿—ï¼šè·³åˆ°ä¸‹ä¸€æ¡å¾ªç¯
  å®ä¾‹ï¼š å¶æ•°ç´¯åŠ 
      create procedure p8(in a int)
      begin
          declare result int default 0;
          declare tmp int default a;
          sum:loop
              if tmp = 0 then
                  leave sum;
              elseif tmp%2=1 then
                  set tmp := tmp - 1;
                  iterate sum;
              else
                  set result := result + tmp;
                  set tmp := tmp - 1;
              end if;
          end loop sum;
          select result;
      end;
      call p8(6);
</code></pre>
</li>
</ul>
<h4 id="æ¸¸æ ‡ä¸æ¡ä»¶å¤„ç†ç¨‹åº"><a href="#æ¸¸æ ‡ä¸æ¡ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="æ¸¸æ ‡ä¸æ¡ä»¶å¤„ç†ç¨‹åº"></a><strong>æ¸¸æ ‡ä¸æ¡ä»¶å¤„ç†ç¨‹åº</strong></h4><ul>
<li><p>æ¸¸æ ‡ä¸æ¡ä»¶å¤„ç†ç¨‹åº</p>
<pre><code>    --ä»‹ç»
          æ¸¸æ ‡ (CURSOR) :æ˜¯ç”¨æ¥å­˜å‚¨æŸ¥è¯¢ç»“æœé›†çš„æ•°æ®ç±»å‹ï¼Œåœ¨å­˜å‚¨è¿‡ç¨‹å’Œè¥¿æ•°ä¸­å¯ä»¥ä½¿ç”¨æ¸¸æ ‡å¯¹ç»“æœé›†è¿›è¡Œå¾ªç¯çš„å¤„ç†ã€‚
          æ¡ä»¶å¤„ç†ç¨‹åºå¯ä»¥ç”¨æ¥åœ¨æµç¨‹æ§åˆ¶ç»“æ„æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æ—¶ç›¸åº”çš„å¤„ç†æ­¥éª¤
    --è¯­æ³•
              å£°æ˜æ¸¸æ ‡ï¼šdeclare yb_name_job cursor for æŸ¥è¯¢è¯­å¥;
              æ‰“å¼€æ¸¸æ ‡ï¼šopen yb_name_job;
              è·å–æ¸¸æ ‡è®°å½•ï¼šfetch yb_name_job into tmp_name,tmp_job;
              å…³é—­æ¸¸æ ‡ï¼šclose yb_name_job;
              å£°æ˜æ¡ä»¶å¤„ç†ç¨‹åºï¼šdeclare handler_action handler for condition_value é€€å‡ºåæ‰§è¡Œè¯­å¥;

              handler_action:
                      continue:ç»§ç»­æ‰§è¡Œå½“å‰ç¨‹åº
                      exitï¼šç»ˆæ­¢æ‰§è¡Œå½“å‰ç¨‹åº
              condition_value
                      sqlstate sqlstate_value:çŠ¶æ€ç 
                      sqlwarningï¼šæ‰€æœ‰01å¼€å¤´çš„çŠ¶æ€ç 
                      not foundï¼šæ‰€æœ‰02å¼€å¤´çš„çŠ¶æ€ç 
                      sqlexceptionï¼šæ‰€æœ‰å…¶ä»–çš„
    --å®ä¾‹
              create procedure p1(in age int)
            begin
                  declare tmp_name varchar(10);
                  declare tmp_job varchar(10);
                  declare yb_name_job cursor for select name,job from emp where age&lt;=emp.age;
                  declare exit handler for not found close yb_name_job;
                  open yb_name_job;
                  drop table if exists tmp_name_job;
                  create table if not exists tmp_name_job(
                      id int auto_increment primary key ,
                      name varchar(10),
                      job varchar(10)
                  );
                  while true do
                      fetch yb_name_job into tmp_name,tmp_job;
                      insert into tmp_name_job values(null,tmp_name,tmp_job);
                  end while;
                  close yb_name_job;
                  select * from tmp_name_job;
          end;
          call p1(40);
</code></pre>
</li>
</ul>
<h3 id="å­˜å‚¨å‡½æ•°"><a href="#å­˜å‚¨å‡½æ•°" class="headerlink" title="å­˜å‚¨å‡½æ•°"></a><strong>å­˜å‚¨å‡½æ•°</strong></h3><blockquote>
<p><strong>å­˜å‚¨å‡½æ•°æ˜¯æœ‰è¿”å›å€¼çš„å­˜å‚¨è¿‡ç¨‹ï¼Œå­˜å‚¨å‡½æ•°çš„å‚æ•°åªèƒ½æ˜¯INç±»å‹çš„ã€‚å…·ä½“è¯­æ³•å¦‚ä¸‹</strong></p>
</blockquote>
<ul>
<li><p>è¯­æ³•</p>
<pre><code>  create function å‡½æ•°å(å‚æ•°)
  returns ç±»å‹ deterministic/no sql/reads sql data
  begin
          ...
      return è¿”å›å€¼;
  end;

  æ³¨æ„ï¼š
          deterministicï¼šè¾“å…¥ç›¸åŒï¼Œè¾“å‡ºç›¸åŒ
          no sqlï¼šæ²¡æœ‰sqlè¯­å¥
          reads sql dataï¼šåªæœ‰è¯»sqlï¼Œæ²¡æœ‰å†™sql
          å‚æ•°å¯ä»¥ä¸å†™in
</code></pre>
</li>
<li><p>å®ä¾‹</p>
<pre><code>  create function f1(a int)
  returns int deterministic
  begin
      declare result int default 0;
      declare tmp int default a;
      while tmp&gt;=0 do
          set result:=result+tmp;
          set tmp:=tmp-1;
      end while;
      return result;
  end;
  select f1(21);
</code></pre>
</li>
</ul>
<h3 id="è§¦å‘å™¨"><a href="#è§¦å‘å™¨" class="headerlink" title="è§¦å‘å™¨"></a><strong>è§¦å‘å™¨</strong></h3><ul>
<li>ä»‹ç»<pre><code>  è§¦å‘å™¨æ˜¯ä¸è¡¨æœ‰å…³çš„æ•°æ®åº“å¯¹è±¡ï¼ŒæŒ‡åœ¨ insert/update/delete ä¹‹å‰æˆ–ä¹‹åï¼Œè§¦å‘å¹¶æ‰§è¡Œè§¦å‘å™¨ä¸­å®šä¹‰çš„SQLè¯­å¥é›†åˆã€‚è§¦å‘å™¨çš„è¿™ç§ç‰¹
  æ€§å¯ä»¥ååŠ©åº”ç”¨åœ¨æ•°æ®åº“ç«¯ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ï¼Œæ—¥å¿—è®°å½•ï¼Œæ•°æ®æ ¡éªŒç­‰æ“ä½œã€‚
  ä½¿ç”¨åˆ«å OLD å’Œ NEW æ¥å¼•ç”¨è§¦å‘å™¨ä¸­å‘ç”Ÿå˜åŒ–çš„è®°å½•å†…å®¹ï¼Œè¿™ä¸å…¶ä»–çš„æ•°æ®åº“æ˜¯ç›¸ä¼¼çš„ã€‚ç°åœ¨è§¦å‘å™¨è¿˜åªæ”¯æŒè¡Œçº§è§¦å‘ï¼Œä¸æ”¯æŒè¯­å¥
  çº§è§¦å‘ã€‚
</code></pre>
</li>
<li>è¯­æ³•<pre><code>  1. åˆ›å»ºè§¦å‘å™¨
          create trigger è§¦å‘å™¨åå­—
          before/after insert/update/delete
          on è¡¨å for each row --è¡Œçº§è§¦å‘å™¨
          begin
          ...
          end;
  2. æŸ¥çœ‹è§¦å‘å™¨
          show triggerï¼› --é»˜è®¤æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„è§¦å‘å™¨
  3. åˆ é™¤è§¦å‘å™¨
          drop trigger [æ•°æ®åº“åå­—]è§¦å‘å™¨åå­—; --ä¸æŒ‡å®šæ•°æ®åº“çš„åå­—ï¼Œåˆ™é»˜è®¤å½“å‰æ•°æ®åº“
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220611230435016.png" width="100%" / loading="lazy">

<h2 id="é”"><a href="#é”" class="headerlink" title="é”"></a><strong>é”</strong></h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a><strong>æ¦‚è¿°</strong></h3><ul>
<li>ä»‹ç»<pre><code>  é”æ˜¯è®¡ç®—æœºåè°ƒå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸€èµ„æºçš„æœºåˆ¶ã€‚åœ¨æ•°æ®åº“ä¸­ï¼Œé™¤ä¼ ç»Ÿçš„è®¡ç®—èµ„æº(CPUã€RAMã€ 1/0ï¼‰çš„äº‰ç”¨ä»¥å¤–ï¼Œæ•°æ®ä¹Ÿæ˜¯
  ä¸€ç§ä¾›è®¸å¤šç”¨æˆ·å…±äº«çš„èµ„æºã€‚å¦‚ä½•ä¿è¯æ•°æ®å¹¶å‘è®¿é—®çš„ä¸€è‡´æ€§ã€æœ‰æ•ˆæ€§æ˜¯æ‰€æœ‰æ•°æ®åº“å¿…é¡»è§£å†³çš„ä¸€ä¸ªé—®é¢˜ï¼Œé”å†²çªä¹Ÿæ˜¯å½±å“æ•°æ®åº“å¹¶å‘è®¿
  é—®æ€§èƒ½çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚ä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œé”å¯¹æ•°æ®åº“è€Œè¨€æ˜¾å¾—å°¤å…¶é‡è¦ï¼Œä¹Ÿæ›´åŠ å¤æ‚ã€‚
</code></pre>
</li>
<li>åˆ†ç±»<pre><code>  MysQLä¸­çš„é”ï¼ŒæŒ‰ç…§é”çš„ç²’åº¦åˆ†ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š
      1. å…¨å±€é”ï¼šé”å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ã€‚
      2. è¡¨çº§é”ï¼šæ¯æ¬¡æ“ä½œé”ä½æ•´å¼ è¡¨ã€‚
      3. è¡Œçº§é”ï¼šæ¯æ¬¡æ“ä½œé”ä½å¯¹åº”çš„è¡Œæ•°æ®ã€‚
</code></pre>
</li>
</ul>
<h3 id="å…¨å±€é”"><a href="#å…¨å±€é”" class="headerlink" title="å…¨å±€é”"></a><strong>å…¨å±€é”</strong></h3><ul>
<li>ä»‹ç»<pre><code>  å…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ï¼ŒåŠ é”åæ•´ä¸ªå®ä¾‹å°±å¤„äºåªè¯»çŠ¶æ€ï¼Œåç»­çš„DMLçš„å†™è¯­å¥ï¼ŒDDLè¯­å¥ï¼Œå·²ç»æ›´æ–°æ“ä½œçš„äº‹åŠ¡æäº¤è¯­å¥éƒ½å°†è¢«é˜»å¡ã€‚
  å…¶å…¸å‹çš„ä½¿ç”¨åœºæ™¯æ˜¯åšå…¨åº“çš„é€»è¾‘å¤‡ä»½ï¼Œå¯¹æ‰€æœ‰çš„è¡¨è¿›è¡Œé”å®šï¼Œä»è€Œè·å–ä¸€è‡´æ€§è§†å›¾ï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚
</code></pre>
</li>
<li>æ¼”ç¤ºâ€”â€”â€”â€”æ•°æ®åº“å¤‡ä»½<pre><code>  åŠ é”ï¼šflush tables with read lock;
  å¤‡ä»½ï¼šmysqldump -h43.142.107.197 -uroot -p1234 test &gt; /Users/xuxin/Downloads/test.sql
  è§£é”ï¼šunlock tables;
  æ³¨æ„ï¼šæ•°æ®åº“ä¸­åŠ å…¨å±€é”ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡çš„æ“ä½œï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
      1. å¦‚æœåœ¨ä¸»åº“ä¸Šå¤‡ä»½ï¼Œé‚£ä¹ˆåœ¨å¤‡ä»½æœŸé—´éƒ½ä¸èƒ½æ‰§è¡Œæ›´æ–°ï¼Œä¸šåŠ¡åŸºæœ¬ä¸Šå°±å¾—åœæ‘†ã€‚
      2. å¦‚æœåœ¨ä»åº“ä¸Šå¤‡ä»½ï¼Œé‚£ä¹ˆåœ¨å¤‡ä»½æœŸé—´ä»åº“ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥è¿‡æ¥çš„äºŒè¿›åˆ¶æ—¥å¿— (binlogï¼‰ï¼Œä¼šå¯¼è‡´ä¸»ä»å»¶è¿Ÿã€‚
  åœ¨InnoDBå¼•æ“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¤‡ä»½æ—¶åŠ ä¸Šå‚æ•° --single-transaction å‚æ•°æ¥å®Œæˆä¸åŠ é”çš„ä¸€è‡´æ€§æ•°æ®å¤‡ä»½ã€‚
  è¯­æ³•ï¼šmysqldump --single-transaction -h43.142.107.197 -uroot -p1234 test &gt; /Users/xuxin/Downloads/test.sql
</code></pre>
</li>
</ul>
<h3 id="è¡¨çº§é”"><a href="#è¡¨çº§é”" class="headerlink" title="è¡¨çº§é”"></a><strong>è¡¨çº§é”</strong></h3><h4 id="è¡¨é”"><a href="#è¡¨é”" class="headerlink" title="è¡¨é”"></a><strong>è¡¨é”</strong></h4><ul>
<li>ä»‹ç»<pre><code>  è¡¨çº§é”ï¼Œæ¯æ¬¡æ“ä½œé”ä½æ•´å¼ è¡¨ã€‚é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ã€‚åº”ç”¨åœ¨MyISAMã€InnoDBã€BDBç­‰å­˜å‚¨å¼•æ“ä¸­ã€‚
</code></pre>
</li>
<li>åˆ†ç±»<pre><code>  - è¡¨å…±äº«è¯»é”
  - è¡¨ç‹¬å å†™é”
</code></pre>
</li>
<li>è¯­æ³•<pre><code>  åŠ é”ï¼šlock tables è¡¨å... read/write
  é‡Šæ”¾é”ï¼šunlock tables / å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ã€‚
</code></pre>
</li>
<li>ç‰¹æ€§<pre><code>  è¯»é”ï¼šå„ä¸ªå®¢æˆ·ç«¯å¯ä»¥è¯»ï¼Œéƒ½ä¸å¯ä»¥å†™
  å†™é”ï¼šè‡ªå·±å¯ä»¥è¯»å†™ï¼Œå…¶ä»–éƒ½ä¸å¯ä»¥
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220613021834174.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220613021847582.png" width="100%" / loading="lazy">

<h4 id="å…ƒæ•°æ®é”"><a href="#å…ƒæ•°æ®é”" class="headerlink" title="å…ƒæ•°æ®é”"></a><strong>å…ƒæ•°æ®é”</strong></h4><ul>
<li>ä»‹ç»<pre><code>  å…ƒæ•°æ®é”ï¼ˆmeta data lockï¼ŒMDLï¼‰ï¼ŒMDLåŠ é”è¿‡ç¨‹æ˜¯ç³»ç»Ÿè‡ªåŠ¨æ§åˆ¶ï¼Œæ— éœ€æ˜¾å¼ä½¿ç”¨ï¼Œåœ¨è®¿é—®ä¸€å¼ è¡¨çš„æ—¶å€™ä¼šè‡ªåŠ¨åŠ ä¸Šã€‚MDLé”ä¸»è¦ä½œç”¨æ˜¯ç»´æŠ¤è¡¨å…ƒæ•°æ®çš„æ•°æ®ä¸€è‡´æ€§ï¼Œåœ¨è¡¨ä¸Šæœ‰æ´»åŠ¨äº‹åŠ¡çš„æ—¶å€™ï¼Œä¸å¯ä»¥å¯¹å…ƒæ•°æ®è¿›è¡Œå†™å…¥æ“ä½œã€‚ä¸ºäº†é¿å…DMLä¸DDLå†²çªï¼Œä¿è¯è¯»å†™çš„æ­£ç¡®æ€§ã€‚
  
</code></pre>
</li>
<li>åˆ†ç±»<pre><code>  å…ƒæ•°æ®è¯»é”(å…±äº«)ï¼šå¢åˆ æ”¹ç­‰è¯­å¥ï¼Œè‡ªåŠ¨æ·»åŠ 
  å…ƒæ•°æ®å†™é”(æ’å®ƒ)ï¼šä¿®æ”¹è¡¨ç»“æ„
  
</code></pre>
</li>
<li>æŸ¥çœ‹å…ƒæ•°æ®é”<pre><code>  select object_type,object_schema,object_name,lock_type,lock_duration from performance_schema.metadata_locks;
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220613023057649.png" width="100%" / loading="lazy">

<h4 id="æ„å‘é”"><a href="#æ„å‘é”" class="headerlink" title="æ„å‘é”"></a><strong>æ„å‘é”</strong></h4><ul>
<li>ä»‹ç»<pre><code>  ä¸ºäº†é¿å…DMLåœ¨æ‰§è¡Œæ—¶ï¼ŒåŠ çš„è¡Œé”ä¸è¡¨é”çš„å†²çªï¼Œåœ¨InnoDBä¸­å¼•å…¥äº†æ„å‘é”,ä½¿å¾—è¡¨é”ä¸ç”¨æ£€æŸ¥æ¯è¡Œæ•°æ®æ˜¯å¦åŠ é”
</code></pre>
</li>
<li>åˆ†ç±»<pre><code>  1. æ„å‘å…±äº«é”ï¼ˆISï¼‰ï¼šç”±è¯­å¥ select.... lock in share modeæ·»åŠ ã€‚
  2. æ„å‘æ’ä»–é”ï¼ˆIXï¼‰ï¼šç”±insertã€updateã€ deleteã€ select.. for update æ·»åŠ ã€‚
</code></pre>
</li>
<li>å…¼å®¹æ€§<pre><code>  1. æ„å‘å…±äº«é”ï¼ˆISï¼‰ï¼šä¸è¡¨é”å…±äº«é”(readï¼‰å…¼å®¹ï¼Œä¸è¡¨é”æ’å®ƒé”ï¼ˆwriteï¼‰äº’æ–¥ã€‚
  2. æ„å‘æ’ä»–é”ï¼ˆIXï¼‰ï¼šä¸è¡¨é”å…±äº«é”ï¼ˆread)åŠæ’å®ƒé”ï¼ˆwriteï¼‰éƒ½äº’æ–¥ã€‚æ„å‘é”ä¹‹é—´ä¸ä¼šäº’æ–¥ã€‚
</code></pre>
</li>
<li>æŸ¥çœ‹æ„å‘é”<pre><code>  select object_schema,object_name,index_name,lock_type,lock_mode,lock_data from   performance_schema.data_locks;
</code></pre>
</li>
</ul>
<h3 id="è¡Œçº§é”"><a href="#è¡Œçº§é”" class="headerlink" title="è¡Œçº§é”"></a><strong>è¡Œçº§é”</strong></h3><ul>
<li>ä»‹ç»<pre><code>  è¡Œçº§é”ï¼Œæ¯æ¬¡æ“ä½œé”ä½å¯¹åº”çš„è¡Œæ•°æ®ã€‚é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦æœ€é«˜ã€‚åº”ç”¨åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ã€‚
</code></pre>
</li>
<li>åˆ†ç±»<pre><code>  InnoDBçš„æ•°æ®æ˜¯åŸºäºç´¢å¼•ç»„ç»‡çš„ï¼Œè¡Œé”æ˜¯é€šè¿‡å¯¹ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ï¼Œè€Œä¸æ˜¯å¯¹è®°å½•åŠ çš„é”ã€‚å¯¹äºè¡Œçº§é”ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š
  1. è¡Œé” (Record Lock)ï¼šé”å®šå•ä¸ªè¡Œè®°å½•çš„é”ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ­¤è¡Œè¿›è¡Œupdateå’Œdeleteã€‚åœ¨RCã€RRéš”ç¦»çº§åˆ«ä¸‹éƒ½æ”¯æŒã€‚
  2. é—´éš™é” (Gap Lock)ï¼šé”å®šç´¢å¼•è®°å½•é—®éš™ï¼ˆä¸å«è¯¥è®°å½•ï¼‰ï¼Œç¡®ä¿ç´¢å¼•è®°å½•é—´éš™ä¸å˜ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨è¿™ä¸ªé—´éš™è¿›è¡Œinsertï¼Œäº§ç”Ÿå¹»è¯»ã€‚åœ¨RRéš”ç¦»çº§åˆ«ä¸‹éƒ½æ”¯æŒã€‚
  3. ä¸´é”®é”(Next-Key Lockï¼‰ï¼šè¡Œé”å’Œé—´éš™é”ç»„åˆï¼ŒåŒæ—¶é”ä½æ•°æ®ï¼Œäº•é”ä½æ•°æ®å‰é¢çš„é—´éš™Gapã€‚åœ¨RRéš”ç¦»çº§åˆ«ä¸‹æ”¯æŒã€‚
</code></pre>
</li>
</ul>
<h4 id="è®°å½•é”"><a href="#è®°å½•é”" class="headerlink" title="è®°å½•é”"></a><strong>è®°å½•é”</strong></h4><ul>
<li><p>åˆ†ç±»</p>
<pre><code>  1. å…±äº«é”ï¼ˆSï¼‰ï¼šå…è®¸ä¸€ä¸ªäº‹åŠ¡å»è¯»ä¸€è¡Œï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„æ’å®ƒé”ã€‚
  2. æ’ä»–é”ï¼ˆXï¼‰ï¼šå…è®¸è·å–æ’ä»–é”çš„äº‹åŠ¡æ›´æ–°æ•°æ®ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„å…±äº«é”å’Œæ’ä»–é”ã€‚
</code></pre>
</li>
<li><p>æ³¨æ„</p>
<pre><code>  é»˜è®¤æƒ…å†µä¸‹ï¼ŒInnoDBåœ¨ REPEATABLE READäº‹åŠ¡éš”ç¦»çº§åˆ«è¿è¡Œï¼ŒInnoDBä½¿ç”¨ next-key é”è¿›è¡Œæœç´¢å’Œç´¢å¼•æ‰«æï¼Œä»¥é˜²æ­¢å¹»è¯»ã€‚

  1. é’ˆå¯¹å”¯ä¸€ç´¢å¼•è¿›è¡Œæ£€ç´¢æ—¶ï¼Œå¯¹å·²å­˜åœ¨çš„è®°å½•è¿›è¡Œç­‰å€¼åŒ¹é…æ—¶ï¼Œå°†ä¼šè‡ªåŠ¨ä¼˜åŒ–ä¸ºè¡Œé”ã€‚
  2. InnoDBçš„è¡Œé”æ˜¯é’ˆå¯¹äºç´¢å¼•åŠ çš„é”ï¼Œä¸é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œé‚£ä¹ˆInnoDBå°†å¯¹è¡¨ä¸­çš„æ‰€æœ‰è®°å½•åŠ é”ï¼Œæ­¤æ—¶ å°±ä¼šå‡çº§ä¸ºè¡¨é”ã€‚
</code></pre>
</li>
<li><p>æŸ¥çœ‹è¡Œé”</p>
<pre><code>  select object_schema,object_name,index_name,lock_type,lock_mode,lock_data from   performance_schema.data_locks;
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220613025941308.png" width="100%" / loading="lazy">

<img src="http://hexo.xuxin.world/mysql/image-20220613030048567.png" width="100%" / loading="lazy">


<h4 id="é—´éš™é”-ä¸´é—´é”"><a href="#é—´éš™é”-ä¸´é—´é”" class="headerlink" title="é—´éš™é”/ä¸´é—´é”"></a><strong>é—´éš™é”/ä¸´é—´é”</strong></h4><pre><code>    é»˜è®¤æƒ…å†µä¸‹ï¼ŒInnoDBåœ¨ REPEATABLE READäº‹åŠ¡éš”ç¦»çº§åˆ«è¿è¡Œï¼ŒInnoDBä½¿ç”¨ next-key é”è¿›è¡Œæœç´¢å’Œç´¢å¼•|(æ‰«æï¼Œä»¥é˜²æ­¢å¹»è¯»ã€‚
        1. ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)ï¼Œç»™ä¸å­˜åœ¨çš„è®°å½•åŠ é”æ—¶ï¼Œä¼˜åŒ–ä¸ºé—´éš™é”ã€‚
        2. ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(æ™®é€šç´¢å¼•)ï¼Œnext-key locké€€åŒ–ä¸ºé—´éš™é”ï¼Œé”è‡ªå·±å€¼å’Œå·¦å³é—´éš™
        3. ç´¢å¼•ä¸Šçš„èŒƒå›´æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)ï¼Œå…¶èŒƒå›´å†…çš„ï¼Œåˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³çš„å€¼é—´éš™ï¼Œè‡ªå·±çš„å€¼éƒ½ä¼šåŠ é”
    æ³¨æ„ï¼šé—´éš™é”å”¯ä¸€ç›®çš„æ˜¯é˜²æ­¢å…¶ä»–äº‹åŠ¡æ’å…¥é—´éš™ã€‚é—´éš™é”å¯ä»¥å…±å­˜ï¼Œä¸€ä¸ªäº‹åŠ¡é‡‡ç”¨çš„é—´éš™é”ä¸ä¼šé˜»æ­¢å¦ä¸€ä¸ªäº‹åŠ¡åœ¨åŒä¸€é—´éš™ä¸Šé‡‡ç”¨é—´éš™é”ã€‚
</code></pre>
<h2 id="InnoDBå¼•æ“"><a href="#InnoDBå¼•æ“" class="headerlink" title="InnoDBå¼•æ“"></a><strong>InnoDBå¼•æ“</strong></h2><h3 id="é€»è¾‘å­˜å‚¨ç»“æ„"><a href="#é€»è¾‘å­˜å‚¨ç»“æ„" class="headerlink" title="é€»è¾‘å­˜å‚¨ç»“æ„"></a><strong>é€»è¾‘å­˜å‚¨ç»“æ„</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220613222348015.png" width="100%" / loading="lazy">


<ul>
<li>è¡¨ç©ºé—´ï¼ˆibdæ–‡ä»¶ï¼‰ï¼š<pre><code>  ä¸€ä¸ªmysqlå®ä¾‹å¯ä»¥å¯¹åº”å¤šä¸ªè¡¨ç©ºé—´ï¼Œç”¨äºå­˜å‚¨è®°å½•ã€ç´¢å¼•ç­‰æ•°æ®ã€‚
</code></pre>
</li>
<li>æ®µï¼š<pre><code>  åˆ†ä¸ºæ•°æ®æ®µ (Leaf node segment)ã€ç´¢å¼•æ®µ(Non-leaf node segmentï¼‰ã€å›æ»šæ®µï¼ˆRollback segment),
  InnoDBæ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œæ•°æ®æ®µå°±æ˜¯B+æ ‘çš„å¶å­èŠ‚ç‚¹ï¼Œç´¢å¼•æ®µå³ä¸ºB+æ ‘çš„éå¶å­èŠ‚ç‚¹ã€‚æ®µç”¨æ¥ç®¡ç†å¤šä¸ªExtentï¼ˆåŒºï¼‰ã€‚
</code></pre>
</li>
<li>åŒºï¼š<pre><code>  è¡¨ç©ºé—´çš„å•å…ƒç»“æ„ï¼Œæ¯ä¸ªåŒºçš„å¤§å°ä¸º1Mã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒInnoDBå­˜å‚¨å¼•æ“é¡µå¤§å°ä¸º16Kï¼Œå³ä¸€ä¸ªåŒºä¸­ä¸€å…±æœ‰64ä¸ªè¿ç»­çš„é¡µã€‚
</code></pre>
</li>
<li>é¡µï¼š<pre><code>  æ˜¯InnoDB å­˜å‚¨å¼•æ“ç£ç›˜ç®¡ç†çš„æœ€å°å•å…ƒï¼Œæ¯ä¸ªé¡µçš„å¤§å°é»˜è®¤ä¸º16KBã€‚ä¸ºäº†ä¿è¯é¡µçš„è¿ç»­æ€§ï¼ŒInnoDB å­˜å‚¨å¼•æ“æ¯æ¬¡ä»ç£ç›˜ç”³è¯·4-5ä¸ªåŒºã€‚    
</code></pre>
</li>
<li>è¡Œï¼š<pre><code>  InnoDB å­˜å‚¨å¼•æ“æ•°æ®æ˜¯æŒ‰è¡Œè¿›è¡Œå­˜æ”¾çš„ã€‚
  Txidï¼šæ¯æ¬¡å¯¹æŸæ¡è®°æ³‰è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½ä¼šæŠŠå¯¹åº”çš„äº‹åŠ¡idå¨å€¼ç»™trx_idéšè—åˆ—ã€‚
  RollL_pointerï¼šæ¯æ¬¡å¯¹æŸæ¡å¼•è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½ä¼šæŠŠæ—§çš„ç‰ˆæœ¬å†™å…¥åˆ°undoæ—¥å¿—ä¸­ï¼Œç„¶åè¿™ä¸ªéšè—åˆ—å°±ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥æ‰¾åˆ°è¯¥è®°å½•ä¿®æ”¹å‰çš„ä¿¡æ¯ã€‚
</code></pre>
</li>
</ul>
<h3 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a><strong>æ¶æ„</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220614010615268.png" width="100%" / loading="lazy">

<h4 id="å†…å­˜æ¶æ„"><a href="#å†…å­˜æ¶æ„" class="headerlink" title="å†…å­˜æ¶æ„"></a><strong>å†…å­˜æ¶æ„</strong></h4><blockquote>
<ul>
<li>Buffer Poolï¼šç¼“å­˜å¸¸è§„æ“ä½œæ•°æ®</li>
<li>Change Bufferï¼šå‡å°‘éå”¯ä¸€äºŒçº§ç´¢å¼•éšæœºå¸¦æ¥çš„i/o</li>
<li>Log Bufferï¼šæ—¥å¿—ç¼“å­˜</li>
<li>Adaptive Hash Indexï¼šè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡</li>
</ul>
</blockquote>
<ul>
<li><p>Buffer Pool</p>
<pre><code>  ç¼“å†²æ± æ˜¯ä¸»å†…å­˜ä¸­çš„ä¸€ä¸ªåŒºåŸŸï¼Œé‡Œé¢å¯ä»¥ç¼“å­˜ç£ç›˜ä¸Šç»å¸¸æ“ä½œçš„çœŸå®æ•°æ®ï¼Œåœ¨æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œæ—¶ï¼Œ
  å…ˆæ“ä½œç¼“å†²æ± ä¸­çš„æ•°æ®ï¼ˆè‹¥ç¼“å†²æ± æ²¡æœ‰æ•°æ®ï¼Œåˆ™ä»ç£ç›˜åŠ è½½å¹¶ç¼“å­˜ï¼‰ï¼Œç„¶åå†ä»¥ä¸€å®šé¢‘ç‡åˆ·æ–°åˆ°ç£ç›˜ï¼Œ
  ä»è€Œå‡å°‘ç£ç›˜i/oï¼ŒåŠ å¿«å¤„ç†é€Ÿåº¦ã€‚ç¼“å†²æ± ä»¥Pageé¡µä¸ºå•ä½ï¼Œåº•å±‚é‡‡ç”¨é“¾è¡¨æ•°æ®ç»“æ„ç®¡ç†Pageã€‚

  æ ¹æ®çŠ¶æ€ï¼Œå°†Pageåˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š
          free pageï¼šç©ºé—²pageï¼Œæœªè¢«ä½¿ç”¨ã€‚
          clean pageï¼šè¢«ä½¿ç”¨pageï¼Œæ•°æ®æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚
          dirty pageï¼šè„é¡µï¼Œè¢«ä½¿ç”¨pageï¼Œæ•°æ®è¢«ä¿®æ”¹è¿‡ï¼Œä¹Ÿä¸­æ•°æ®ä¸ç£ç›˜çš„æ•°æ®äº§ç”Ÿäº†ä¸ä¸€è‡´ã€‚
</code></pre>
</li>
<li><p>Change Bufferï¼š</p>
<pre><code>  æ›´æ”¹ç¼“å†²åŒºï¼ˆé’ˆå¯¹äºéå”¯ä¸€äºŒçº§ç´¢å¼•é¡µï¼‰ï¼Œåœ¨æ‰§è¡ŒDMLè¯­å¥æ—¶ï¼Œå¦‚æœè¿™äº›æ•°æ®Pageæ²¡æœ‰åœ¨Buffer Poolä¸­,ä¸ä¼šç›´æ¥æ“ä½œç£ç›˜ï¼Œ
  è€Œä¼šå°†æ•°æ®å˜æ›´å­˜åœ¨æ›´æ”¹ç¼“å†²åŒº Change Buffer ä¸­ï¼Œåœ¨æœªæ¥æ•°æ®è¢«è¯»å–æ—¶ï¼Œå†å°†æ•°æ®åˆå¹¶æ¢å¤åˆ°Buffer Poolä¸­ï¼Œå†å°†åˆå¹¶åçš„æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­ã€‚

  Change Bufferçš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ
      ä¸èšé›†ç´¢å¼•ä¸åŒï¼ŒäºŒçº§ç´¢å¼•é€šå¸¸æ˜¯éå”¯ä¸€çš„ï¼Œå¹¶ä¸”ä»¥ç›¸å¯¹éšæœºçš„é¡ºåºæ’å…¥äºŒçº§ç´¢å¼•ã€‚
      åŒæ ·ï¼Œåˆ é™¤å’Œæ›´æ–°å¯èƒ½ä¼šå½±å“ç´¢å¼•æ ‘ä¸­ä¸ç›¸é‚»çš„äºŒçº§ç´¢å¼•é¡µï¼Œå¦‚æœæ¯ä¸€æ¬¡éƒ½æ“ä½œç£ç›˜ï¼Œä¼šé€ æˆå¤§é‡çš„ç£ç›˜i/oã€‚
      æœ‰äº†ChangeBufferä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¼“å†²æ± ä¸­è¿›è¡Œåˆå¹¶å¤„ç†ï¼Œå‡å°‘ç£ç›˜i/oã€‚
</code></pre>
</li>
<li><p>Adaptive Hash Index</p>
<pre><code>  è‡ªé€‚åº”hashç´¢å¼•ï¼Œç”¨äºä¼˜åŒ–å¯¹Buffer Poolæ•°æ®çš„æŸ¥è¯¢ã€‚InnoDBå­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸Šå„ç´¢å¼•é¡µçš„æŸ¥è¯¢ï¼Œå¦‚æœè§‚å¯Ÿåˆ°hashç´¢å¼•å¯ä»¥æå‡é€Ÿåº¦ï¼Œåˆ™å»ºç«‹hashç´¢å¼•ï¼Œç§°ä¹‹ä¸ºè‡ªé€‚åº”hashç´¢å¼•ã€‚
  è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œæ— éœ€äººå·¥å¹²é¢„ï¼Œæ˜¯ç³»ç»Ÿæ ¹æ®æƒ…å†µè‡ªåŠ¨å®Œæˆã€‚
  å‚æ•°ï¼šadaptive_hash_indexï¼Œå¯ä»¥æŸ¥çœ‹mysqlæ˜¯å¦å¼€å¯
</code></pre>
</li>
<li><p>Log Bufferï¼š</p>
<pre><code>  æ—¥å¿—ç¼“å†²åŒºï¼Œç”¨æ¥ä¿å­˜è¦å†™å…¥åˆ°ç£ç›˜ä¸­çš„logæ—¥å¿—æ•°æ® ï¼ˆrede logã€ undo log)ï¼Œé»˜è®¤å¤§å°ä¸º16MBï¼Œæ—¥å¿—ç¼“å†²åŒºçš„æ—¥å¿—ä¼šå®šæœŸåˆ·æ–°åˆ°ç£ç›˜ä¸­ã€‚å¦‚æœéœ€è¦æ›´æ–°ã€æ’å…¥æˆ–åˆ é™¤è®¸å¤šè¡Œçš„äº‹åŠ¡ï¼Œå¢åŠ æ—¥å¿—ç¼“å†²åŒºçš„å¤§å°å¯ä»¥èŠ‚çœç£ç›˜i/oã€‚
  å‚æ•°ï¼š
      innodb_ log _buffer_sizeï¼šç¼“å†²åŒºå¤§å°
      innodb_flush_log_at_trx_commitï¼šæ—¥å¿—åˆ·æ–°åˆ°ç£ç›˜æ—¶æœº
  æ—¥å¿—åˆ·æ–°åˆ°ç£ç›˜æ—¶æœº
      1:æ—¥å¿—åœ¨æ¯æ¬¡äº‹åŠ¡æäº¤æ—¶å†™å…¥å¹¶åˆ·æ–°åˆ°ç£ç›˜ï¼Œé»˜è®¤
      0:æ¯ç§’å°†æ—¥å¿—å†™å…¥å¹¶åˆ·æ–°åˆ°ç£ç›˜ä¸€æ¬¡ã€‚
      2:æ—¥å¿—åœ¨æ¯æ¬¡äº‹åŠ¡æäº¤åå†™å…¥ï¼Œäº•æ¯ç§’åˆ·æ–°åˆ°ç£ç›˜ä¸€æ¬¡ã€‚
</code></pre>
</li>
</ul>
<h4 id="ç£ç›˜æ¶æ„"><a href="#ç£ç›˜æ¶æ„" class="headerlink" title="ç£ç›˜æ¶æ„"></a><strong>ç£ç›˜æ¶æ„</strong></h4><ul>
<li>System Tablespaceï¼š<pre><code>  ç³»ç»Ÿè¡¨ç©ºé—´æ˜¯æ›´æ”¹ç¼“å†²åŒºçš„å­˜å‚¨åŒºåŸŸã€‚å¦‚æœè¡¨æ˜¯åœ¨ç³»ç»Ÿè¡¨ç©ºé—´è€Œä¸æ˜¯æ¯ä¸ªè¡¨æ–‡ä»¶æˆ–é€šç”¨è¡¨ç©ºé—´ä¸­åˆ›å»ºçš„ï¼Œå®ƒä¹Ÿå¯èƒ½åŒ…å«è¡¨å’Œç´¢å¼•æ•°æ®ã€‚
  ï¼ˆåœ¨MySQL5.xç‰ˆæœ¬ä¸­è¿˜åŒ…å«InnoDBæ•°æ®å­—å…¸ã€undologç­‰ï¼‰
  å‚æ•°ï¼šinnodb_data_ file_path
</code></pre>
</li>
<li>File-Per-Table Tablespacesï¼š<pre><code>  æ¯ä¸ªè¡¨çš„æ–‡ä»¶è¡¨ç©ºé—´åŒ…å«å•ä¸ªInnoDBè¡¨çš„æ•°æ®å’Œç´ å¼•ï¼Œå¹¶å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„å•ä¸ªæ•°æ®æ–‡ä»¶ä¸­ã€‚
  å‚æ•°ï¼šinnodb_file_per_table
</code></pre>
</li>
<li>General Tablespacesï¼š<pre><code>  é€šç”¨è¡¨ç©ºé—´ï¼Œéœ€è¦é€šè¿‡ CREATE TABLESPACE è¯­æ³•åˆ›å»ºé€šç”¨è¡¨ç©ºé—´ï¼Œåœ¨åˆ›å»ºè¡¨æ—¶ï¼Œå¯ä»¥æŒ‡å®šè¯¥è¡¨ç©ºé—´ã€‚
</code></pre>
</li>
<li>Undo Tablespaces<pre><code>  æ’¤é”€è¡¨ç©ºé—´ï¼ŒMySQLå®ä¾‹åœ¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸¤ä¸ªé»˜è®¤çš„undoè¡¨ç©ºé—´ï¼ˆåˆå§‹å¤§å°16Mï¼‰ï¼Œç”¨äºå­˜å‚¨undo logæ—¥å¿—ã€‚
</code></pre>
</li>
<li>Temporary Tablespacesï¼š <pre><code>  InnoDB ä½¿ç”¨ä¼šè¯ä¸´æ—¶è¡¨ç©ºé—´å’Œå…¨å±€ä¸´æ—¶è¡¨ç©ºé—´ã€‚å­˜å‚¨ç”¨æˆ·åˆ›å»ºçš„ä¸´æ—¶è¡¨ç­‰æ•°æ®ã€‚
</code></pre>
</li>
<li>Doublewrite Buffer Files<pre><code>  åŒå†™ç¼“å†²åŒºï¼ŒinnoDBå¼•æ“å°†æ•°æ®é¡µä»Buffer Poolåˆ·æ–°åˆ°ç£ç›˜å‰ï¼Œå…ˆå°†æ•°æ®é¡µå†™å…¥åŒå†™ç¼“å†²åŒºæ–‡ä»¶ä¸­ï¼Œä¾¿äºç³»ç»Ÿå¼‚å¸¸æ—¶æ¢å¤æ•°æ®ã€‚
</code></pre>
</li>
<li>Redo Logï¼š<pre><code>  é‡åšæ—¥å¿—ï¼Œæ˜¯ç”¨æ¥å®ç°äº‹åŠ¡çš„æŒä¹…æ€§ã€‚è¯¥æ—¥å¿—æ–‡ä»¶ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šé‡åšæ—¥å¿—ç¼“å†²(redo log bufferï¼‰ä»¥åŠé‡åšæ—¥å¿—æ–‡ä»¶ (redo logï¼‰,
  å‰è€…æ˜¯åœ¨å†…å­˜ä¸­ï¼Œåè€…åœ¨ç£ç›˜ä¸­ã€‚å½“äº‹åŠ¡æäº¤ä¹‹åä¼šæŠŠæ‰€æœ‰ä¿®æ”¹ä¿¡æ¯éƒ½ä¼šå­˜åˆ°è¯¥æ—¥å¿—ä¸­ï¼Œç”¨äºåœ¨åˆ·æ–°è„é¡µåˆ°ç£ç›˜æ—¶,å‘ç”Ÿé”™è¯¯æ—¶ï¼Œè¿›è¡Œæ•°æ®æ¢å¤ä½¿ç”¨ã€‚
  ä»¥å¾ªç¯æ–¹å¼å†™å…¥é‡åšæ—¥å¿—æ–‡ä»¶ï¼Œæ³•åŠä¸¤ä¸ªæ–‡ä»¶ï¼š
      ib logfileo
      ib logfile1
</code></pre>
</li>
</ul>
<h4 id="åå°çº¿ç¨‹"><a href="#åå°çº¿ç¨‹" class="headerlink" title="åå°çº¿ç¨‹"></a><strong>åå°çº¿ç¨‹</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220614010919117.png" width="100%" / loading="lazy">

<h3 id="äº‹åŠ¡åŸç†"><a href="#äº‹åŠ¡åŸç†" class="headerlink" title="äº‹åŠ¡åŸç†"></a><strong>äº‹åŠ¡åŸç†</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220614011234113.png" width="100%" / loading="lazy">

<h4 id="redo-log"><a href="#redo-log" class="headerlink" title="redo log"></a><strong>redo log</strong></h4><pre><code>    åˆ†ä¸ºä¿©å—ï¼š**é‡åšæ—¥å¿—ç¼“å†²åŒº**å’Œ**é‡åšæ—¥å¿—æ–‡ä»¶**

    å†…å®¹ï¼šç‰©ç†æ—¥å¿—ï¼Œè®°å½•æ•°æ®å†…å®¹

    ä½œç”¨ï¼šå½“å‘ç”Ÿæç«¯æƒ…å†µæ—¶ï¼Œå†…å­˜çš„ä¸­çš„æ•°æ®æ¥ä¸åŠåˆ·æ–°åˆ°ç£ç›˜ï¼Œredologå¯ä»¥é‡æ–°æ‰§è¡Œ

    åŸç†ï¼šå…ˆå†™æ—¥å¿—ï¼ˆWALï¼‰

    æ³¨æ„ï¼šé‡åšæ—¥å¿—æ–‡ä»¶æœ‰2ä¸ªæ–‡ä»¶ï¼Œæ¯æ¬¡éƒ½æ˜¯å¾ªç¯è¿½åŠ ï¼Œå®šæ—¶æ¸…ç†
</code></pre>
<img src="http://hexo.xuxin.world/mysql/image-20220620164103763.png" width="100%" / loading="lazy">

<h4 id="undo-log"><a href="#undo-log" class="headerlink" title="undo log"></a><strong>undo log</strong></h4><pre><code>    - ä½œç”¨ï¼šå›æ»šæ—¥å¿—ï¼Œç”¨äºè®°å½•æ•°æ®è¢«ä¿®æ”¹å‰çš„ä¿¡æ¯ï¼Œä½œç”¨åŒ…å«ä¸¤ä¸ªï¼šæä¾›å›æ»šå’Œ MVCC(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)

    - å†…å®¹ï¼šundo logå’Œredo logè®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ã€‚å¯ä»¥è®¤ä¸ºå½“deleteä¸€æ¡è®°å½•æ—¶ï¼Œundo logä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„insertè®°å½•ï¼Œ
    åä¹‹äº¦ç„¶ï¼Œå½“updateä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„updateè®°å½•ã€‚å½“æ‰§è¡Œrollbackæ—¶ï¼Œå°±å¯ä»¥ä»undo logä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å…§å®¹å¹¶è¿›è¡Œå›æ»šã€‚

    - Undo logé”€æ®µï¼šundo logåœ¨äº‹åŠ¡æ‰§è¡Œæ—¶äº§ç”Ÿï¼Œäº‹åŠ¡æäº¤æ—¶ï¼Œå¹¶ä¸ä¼šç«‹å³å·é™¤undo logï¼Œå› ä¸ºè¿™äº›æ—¥å¿—å¯èƒ½è¿˜ç”¨äºMVCCã€‚

    - Undo logå­˜å‚¨ï¼šundo logé‡‡ç”¨æ®µçš„æ–¹å¼è¿›è¡Œç®¡ç†å’Œè®°å½•ï¼Œå­˜æ”¾åœ¨å‰é¢ä»‹ç»çš„ rollback segment å›æ»šæ®µä¸­ï¼Œå†…éƒ¨åŒ…å«1024ä¸ªundo log segmentã€‚
</code></pre>
<h3 id="MVCC"><a href="#MVCC" class="headerlink" title="MVCC"></a><strong>MVCC</strong></h3><pre><code>    - å½“å‰è¯»
            è¯»å–çš„æ˜¯è®°å½•çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¯»å–æ—¶è¿˜è¦ä¿è¯å…¶ä»–å¹¶å‘äº‹åŠ¡ä¸èƒ½ä¿®æ”¹å½“å‰è®°å½•ï¼Œä¼šå¯¹è¯»å–çš„è®°å½•è¿›è¡ŒåŠ é”ã€‚å¯¹äºæˆ‘ä»¬æ—¥å¸¸çš„æ“ä½œï¼Œå¦‚ï¼š
            select... lock in share mode(å…±äº«é”)ï¼Œselect.. for updateã€ updateã€insertã€ delete(æ’ä»–é”)éƒ½æ˜¯ä¸€ç§å½“å‰è¯»ã€‚
    - å¿«ç…§è¯»
            ç®€å•çš„selectï¼ˆä¸åŠ é”ï¼‰å°±æ˜¯å¿«ç…§è¯»ï¼Œå¿«ç…§è¯»ï¼Œè¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„å¯è§ç‰ˆæœ¬ï¼Œæœ‰å¯èƒ½æ˜¯å†å²æ•°æ®ï¼Œä¸åŠ é”ï¼Œæ˜¯éé˜»å¡è¯»ã€‚
            Read Committedï¼šæ¯æ¬¡selectï¼Œéƒ½ç”Ÿæˆä¸€ä¸ªå¿«ç…§è¯»ã€‚
            Repeatable Readï¼šå¼€å¯äº‹åŠ¡åç¬¬ä¸€ä¸ªselectè¯­å¥æ‰æ˜¯å¿«ç…§è¯»çš„åœ°æ–¹ã€‚
            Serializableï¼šå¿«ç…§è¯»ä¼šé€€åŒ–ä¸ºå½“å‰è¯»ã€‚
    - MVCC
            å…¨ç§° Multi-Version Concurrency Controlï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚æŒ‡ç»´æŠ¤ä¸€ä¸ªæ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ï¼Œä½¿å¾—è¯»å†™æ“ä½œæ²¡æœ‰å†²çªï¼Œå¿«ç…§è¯»ä¸ºMySQLå®ç°ï¼ŒMVCCæä¾›äº†ä¸€ä¸ªéé˜»å¡è¯»åŠŸèƒ½ã€‚MVCCçš„å…·ä½“å®ç°ï¼Œè¿˜éœ€è¦ä¾èµ–äºæ•°æ®åº“è®°å½•ä¸­çš„ä¸‰ä¸ªéšå¼å­—æ®µã€undo logæ—¥å¿—ã€readViewã€‚
</code></pre>
<h4 id="éšå¼å­—æ®µ"><a href="#éšå¼å­—æ®µ" class="headerlink" title="éšå¼å­—æ®µ"></a><strong>éšå¼å­—æ®µ</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220620170315495.png" width="100%" / loading="lazy">

<blockquote>
<p><strong>æŸ¥çœ‹idbæ–‡ä»¶</strong>:ibd2sdi æ–‡ä»¶å</p>
</blockquote>
<h4 id="undo-log-1"><a href="#undo-log-1" class="headerlink" title="undo log"></a><strong>undo log</strong></h4><pre><code>    å›æ»šæ—¥å¿—ï¼Œåœ¨insertã€ updateã€ deleteçš„æ—¶å€™äº§ç”Ÿçš„ä¾¿äºæ•°æ®å›æ»šçš„æ—¥å¿—ã€‚
    å½“insertçš„æ—¶å€™ï¼Œäº§ç”Ÿçš„undo logæ—¥å¿—åªåœ¨å›æ»šæ—¶éœ€è¦ï¼Œåœ¨äº‹åŠ¡æäº¤åï¼Œå¯è¢«ç«‹å³åˆ é™¤ã€‚
    è€Œupdateã€ deleteçš„æ—¶å€™ï¼Œäº§ç”Ÿçš„undo logæ—¥å¿—ä¸ä»…åœ¨å›æ»šæ—¶éœ€è¦ï¼Œåœ¨å¿«ç…§è¯»æ—¶ä¹Ÿéœ€è¦ï¼Œä¸ä¼šç«‹å³è¢«åˆ é™¤ã€‚
</code></pre>
<img src="http://hexo.xuxin.world/mysql/image-20220620170930571.png" width="100%" / loading="lazy">

<h4 id="readview"><a href="#readview" class="headerlink" title="readview"></a><strong>readview</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220620171105766.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220620171422232.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220620171438199.png" width="100%" / loading="lazy">

<h3 id="äº‹åŠ¡åŸç†æ€»ç»“"><a href="#äº‹åŠ¡åŸç†æ€»ç»“" class="headerlink" title="äº‹åŠ¡åŸç†æ€»ç»“"></a><strong>äº‹åŠ¡åŸç†æ€»ç»“</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220620172159103.png" width="100%" / loading="lazy">


<ul>
<li>ä¸€è‡´æ€§ï¼š<pre><code>  undologè´Ÿè´£å¤±è´¥å›æ»šï¼Œredo logè´Ÿè´£æç«¯æƒ…å†µä¸‹ä»»åŠ¡é‡åš
</code></pre>
</li>
<li>éš”ç¦»æ€§ï¼š<pre><code>  è¯»å·²æäº¤ï¼šéšè—å­—æ®µè®°å½•äº‹ç‰©idï¼Œreadviewæ ¹æ®äº‹ç‰©idæ‰¾å‡ºå·²æäº¤çš„ç‰ˆæœ¬ï¼Œåœ¨undologç‰ˆæœ¬é“¾ä¸­æ‰¾åˆ°ç‰ˆæœ¬ï¼Œè¯»å‡ºå·²æäº¤ç‰ˆæœ¬
  å¯é‡å¤è¯»ï¼šrcä¸­æ¯æ¬¡å¿«ç…§è¯»éƒ½ç”Ÿæˆreadviewï¼Œrrä¸­åˆ™åªæœ‰ç¬¬ä¸€æ¬¡è¯»ç”Ÿæˆï¼Œåç»­å¤ç”¨
  ä¸²è¡ŒåŒ–ï¼šæ¯ä¸ªè¯»çš„æ•°æ®è¡Œä¸ŠåŠ ä¸Šå…±äº«é”ï¼ˆé™¤æ­¤ä¹‹å¤–ï¼Œæ¶ˆé™¤å¹»è¯»å¯ä»¥åˆ©ç”¨é—´éš™é”é”ä½åŒºåŸŸé¿å…å…¶ä»–äº‹ç‰©çš„æ“ä½œï¼‰
</code></pre>
</li>
<li>åŸå­æ€§ï¼š<pre><code>  undo logäº‹ç‰©å›æ»š
</code></pre>
</li>
<li>æŒä¹…æ€§ï¼š<pre><code>  redo logåœ¨åˆ·æ–°å¤±è´¥ä¸‹çš„ä»»åŠ¡é‡åš
</code></pre>
</li>
</ul>

<div class="markmap-container" style="height:700px">
  <svg data="{&quot;t&quot;:&quot;root&quot;,&quot;d&quot;:0,&quot;v&quot;:&quot;&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;&lt;em&gt;åŸå­æ€§&lt;/em&gt;&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[2,3],&quot;f&quot;:true},&quot;v&quot;:&quot;è§£é‡Šï¼šäº‹åŠ¡æ˜¯æœ€å°æ“ä½œå•å…ƒï¼ŒåŒæ—¶æˆåŠŸï¼ŒåŒæ—¶å¤±è´¥&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[3,4],&quot;f&quot;:true},&quot;v&quot;:&quot;å¦‚ä½•ä¿è¯ï¼šundo logï¼ˆå›æ»šæ—¥å¿—ï¼‰&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;ä¸€è‡´æ€§&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[6,7],&quot;f&quot;:true},&quot;v&quot;:&quot;è§£é‡Šï¼šäº‹åŠ¡æ“ä½œå‰åï¼Œæ•°æ®æ€»é‡ä¸€è‡´&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[7,8],&quot;f&quot;:true},&quot;v&quot;:&quot;å¦‚ä½•å®ç°ï¼šredo log å’Œ undo log&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[8,9],&quot;f&quot;:true},&quot;v&quot;:&quot;redo logï¼šä¿è¯äº† å¼‚å¸¸æƒ…å†µä¸‹æ•°æ®åŒæ­¥&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[9,10],&quot;f&quot;:true},&quot;v&quot;:&quot;undo logï¼šä¿è¯äº†å›æ»šæ•°æ®åŒæ­¥&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[11,12]},&quot;v&quot;:&quot;éš”ç¦»æ€§&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[12,13],&quot;f&quot;:true},&quot;v&quot;:&quot;è§£é‡Šï¼šæ•°æ®åº“æä¾›éš”ç¦»æœºåˆ¶ï¼Œæ¥ä¿è¯äº‹ç‰©ç‹¬ç«‹ç¯å¢ƒè¿è¡Œ&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[13,14],&quot;f&quot;:true},&quot;v&quot;:&quot;å¦‚ä½•å®ç°ï¼šé”+MVCC&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[14,15],&quot;f&quot;:true},&quot;v&quot;:&quot;éš”ç¦»é—®é¢˜&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[15,16],&quot;f&quot;:true},&quot;v&quot;:&quot;è„è¯»ï¼šè¯»ä¸€ä¸ªæ²¡æœ‰æäº¤çš„æ•°æ®&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[16,17],&quot;f&quot;:true},&quot;v&quot;:&quot;ä¸å¯é‡å¤è¯»ï¼š2æ¬¡è¯»ä¸­é—´ï¼Œåˆ«äººä¿®æ”¹æäº¤äº†ï¼Œå¯¼è‡´ç¬¬äºŒæ¬¡è¯»çš„ä¸ä¸€æ ·&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[17,18],&quot;f&quot;:true},&quot;v&quot;:&quot;å¹»è¯»ï¼š2æ¬¡è¯»çš„æ—¶å€™ï¼Œåˆ«äººæ’å…¥äº†æ–°çš„è®°å½•æäº¤äº†ï¼Œç”±äºå¯é‡å¤è¯»äº†ï¼Œç¬¬äºŒæ¬¡è¯»çš„ä¸€æ ·ï¼Œå¯¼è‡´ç¬¬ä¸€æ¬¡æ²¡æœ‰æ•°æ®ï¼Œæƒ³æ’å…¥ï¼Œç»“æœæ’å…¥å¤±è´¥ï¼Œç¬¬äºŒæ¬¡è¯»è¿˜æ˜¯æ²¡æœ‰ï¼Œå¥½åƒæœ‰å¹»è§‰äº†&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[18,19],&quot;f&quot;:true},&quot;v&quot;:&quot;éš”ç¦»çº§åˆ«&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[19,20],&quot;f&quot;:true},&quot;v&quot;:&quot;read uncommittedï¼šè¯»æœªæäº¤â€”â€”â€”â€”å½“å‰è¯»ï¼Œä½†ä¸åŠ é”ï¼Œå› ä¸ºæ˜¯å½“å‰è¯»æ‰€ä»¥ä¸å—MVCCæ§åˆ¶&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[20,21],&quot;f&quot;:true},&quot;v&quot;:&quot;read committedï¼šè¯»å·²æäº¤ ï¼ˆOracleé»˜è®¤ï¼‰â€”â€”â€”â€”æ¯æ¬¡è¯»éƒ½æ˜¯å¿«ç…§è¯»ï¼ŒMVCCæ§åˆ¶è¯»ä¸€å®šæ˜¯å·²ç»æäº¤äº†çš„&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[21,22],&quot;f&quot;:true},&quot;v&quot;:&quot;repeatable readï¼šå¯é‡å¤è¯» ï¼ˆMySQLé»˜è®¤ï¼‰â€”â€”â€”â€”â€”åªæœ‰ç¬¬ä¸€æ¬¡å¿«ç…§è¯»ï¼ŒMVCCæ§åˆ¶ï¼Œåç»­çš„ç›´æ¥æ²¿ç”¨å¿«ç…§&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[22,23],&quot;f&quot;:true},&quot;v&quot;:&quot;serializableï¼šä¸²è¡ŒåŒ–â€”â€”â€”â€”æ¯æ¬¡è¯»éƒ½æ˜¯å½“å‰è¯»ï¼ŒåŠ é”&quot;}]}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[23,24]},&quot;v&quot;:&quot;æŒä¹…æ€§&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[24,25],&quot;f&quot;:true},&quot;v&quot;:&quot;è§£é‡Šï¼šäº‹åŠ¡æäº¤æˆ–å›æ»šåï¼Œæ•°æ®åº“æ•°æ®çš„æ›´æ”¹æ˜¯æ°¸ä¹…çš„&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[25,26],&quot;f&quot;:true},&quot;v&quot;:&quot;å¦‚ä½•ä¿è¯ï¼šredo logï¼ˆé‡åšæ—¥å¿—ï¼‰&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:1,&quot;p&quot;:{&quot;lines&quot;:[27,28]},&quot;v&quot;:&quot;å…·ä½“ä»‹ç»&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[29,30],&quot;f&quot;:true},&quot;v&quot;:&quot;redo log&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[30,31],&quot;f&quot;:true},&quot;v&quot;:&quot;updateå·¥ä½œæµç¨‹&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[31,32],&quot;f&quot;:true},&quot;v&quot;:&quot;å…ˆå‘å†…å­˜ä¸­Buffer poolä¸­æ‹¿ç›®æ ‡å¯¹è±¡&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[32,33],&quot;f&quot;:true},&quot;v&quot;:&quot;å‘ç°æ²¡æœ‰ï¼Œä»ç£ç›˜æ•°æ®é¡µä¸­å–å‡ºï¼Œæ”¾å…¥ç¼“å†²åŒºä¸­&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[33,34],&quot;f&quot;:true},&quot;v&quot;:&quot;ç¼“å†²åŒºæ•°æ®å˜æ›´&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[34,35],&quot;f&quot;:true},&quot;v&quot;:&quot;å°†å˜æ›´è®°å½•åœ¨å†…å­˜redo log bufferä¸­&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[35,36],&quot;f&quot;:true},&quot;v&quot;:&quot;åŒæ­¥redo log bufferè‡³ redo logä¸­&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[36,37],&quot;f&quot;:true},&quot;v&quot;:&quot;éš”ä¸€æ®µæ—¶é—´å°†ç¼“å†²åŒºçš„æ•°æ®åŒæ­¥è‡³ç£ç›˜ä¸­&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[37,38],&quot;f&quot;:true},&quot;v&quot;:&quot;åŒæ­¥å¤±è´¥ï¼Œæ‰¾redo logé‡æ–°æ‰§è¡Œï¼Œä¿è¯æŒä¹…æ€§&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[38,39],&quot;f&quot;:true},&quot;v&quot;:&quot;å…ˆå†™æ—¥å¿—ï¼ˆWALï¼‰&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[39,40],&quot;f&quot;:true},&quot;v&quot;:&quot;updateåŒæ­¥ç¼“å†²åˆ°ç£ç›˜æ•°æ®é¡µä¸­&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[40,41],&quot;f&quot;:true},&quot;v&quot;:&quot;æ˜¯éšæœºioï¼Œè¦æ‰¾å¾ˆä¹…ï¼Œè€Œredo log buffer&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[41,42],&quot;f&quot;:true},&quot;v&quot;:&quot;åŒæ­¥åˆ°ç£ç›˜ä¸­redo logä¸­ æ˜¯ é¡ºåºioï¼Œç›´æ¥æ—¥å¿—è¿½åŠ &quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[42,43],&quot;f&quot;:true},&quot;v&quot;:&quot;ä½œç”¨ï¼šè„é¡µåˆ·æ–°å¤±è´¥åé‡åšï¼Œä¿è¯æŒä¹…æ€§&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[43,44],&quot;f&quot;:true},&quot;v&quot;:&quot;ç»„æˆï¼šredo log bufferï¼ˆå†…å­˜ï¼‰ å’Œ redo logï¼ˆç£ç›˜ï¼‰&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[44,45],&quot;f&quot;:true},&quot;v&quot;:&quot;ç‰¹æ€§ï¼š2ä¸ªæ–‡ä»¶ï¼Œå¾ªç¯è¿½åŠ ï¼Œå®šæ—¶æ¸…ç†&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[46,47],&quot;f&quot;:true},&quot;v&quot;:&quot;undo log&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[47,48],&quot;f&quot;:true},&quot;v&quot;:&quot;ä½œç”¨ï¼šæä¾›äº†äº‹åŠ¡å›æ»šæœºåˆ¶ï¼Œè¾…åŠ©MVCC&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[48,49],&quot;f&quot;:true},&quot;v&quot;:&quot;åˆ›å»ºï¼šå½“æ‰§è¡Œæ•°æ®å˜æ›´è¯­å¥æ—¶ï¼Œè®°å½•&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[49,50],&quot;f&quot;:true},&quot;v&quot;:&quot;é”€æ¯ï¼šäº‹åŠ¡æäº¤åä¸ä¼šç«‹åˆ»åˆ é™¤ï¼Œè¾…åŠ©MVCC&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[50,51],&quot;f&quot;:true},&quot;v&quot;:&quot;insertæ—¶ï¼Œäº‹åŠ¡æäº¤åç›´æ¥åˆ é™¤&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[51,52],&quot;f&quot;:true},&quot;v&quot;:&quot;updateå’Œdeleteæ—¶ï¼ŒMVCCåœ¨å¿«ç…§è¯»æ—¶éœ€è¦ï¼Œä¸åˆ é™¤&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[52,53],&quot;f&quot;:true},&quot;v&quot;:&quot;è®°å½•æœºåˆ¶ï¼šé€»è¾‘æ—¥å¿—ï¼Œdeleteæ—¶ï¼Œè®°å½•insert&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[54,55],&quot;f&quot;:true},&quot;v&quot;:&quot;MVCC&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[55,56],&quot;f&quot;:true},&quot;v&quot;:&quot;å½“å‰è¯»ï¼šè¯»å–æœ€æ–°æ•°æ®ï¼ŒåŒæ—¶å¯¹æ•°æ®åŠ é”ï¼Œå…¶ä»–äº‹ç‰©æ— æ³•ä¿®æ”¹&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[56,57],&quot;f&quot;:true},&quot;v&quot;:&quot;select in share mode&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[57,58],&quot;f&quot;:true},&quot;v&quot;:&quot;select for update&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[58,59],&quot;f&quot;:true},&quot;v&quot;:&quot;update,delete,insert&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[59,60],&quot;f&quot;:true},&quot;v&quot;:&quot;å¿«ç…§è¯»ï¼šç®€å•selectï¼Œä¸åŠ é”ï¼Œè¯»å–æ•°æ®å¯è§ç‰ˆæœ¬&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[60,61],&quot;f&quot;:true},&quot;v&quot;:&quot;Read Commitï¼šæ¯æ¬¡selectéƒ½ç”Ÿæˆä¸€ä¸ªå¿«ç…§&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[61,62],&quot;f&quot;:true},&quot;v&quot;:&quot;Repeatable Readï¼šå¼€å§‹äº‹ç‰©åç¬¬ä¸€ä¸ªselectç”Ÿæˆå¿«ç…§&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[62,63],&quot;f&quot;:true},&quot;v&quot;:&quot;Serializableï¼šå…¨æ˜¯å½“å‰è¯»&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[63,64],&quot;f&quot;:true},&quot;v&quot;:&quot;éšè—å­—æ®µ&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[64,65],&quot;f&quot;:true},&quot;v&quot;:&quot;DB_TRX_ID:æœ€æ–°ä¿®æ”¹äº‹ç‰©id&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[65,66],&quot;f&quot;:true},&quot;v&quot;:&quot;DB_ROLL_PTR:å›æ»šæŒ‡é’ˆï¼ŒæŒ‡å‘è®°å½•çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œundo logä¸­çš„åœ°å€&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[66,67],&quot;f&quot;:true},&quot;v&quot;:&quot;DB_ROW_ID:éšè—ä¸»é”®ï¼Œå½“æ²¡æœ‰ä¸»é”®æ—¶æ‰åˆ›å»º&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[67,68],&quot;f&quot;:true},&quot;v&quot;:&quot;undo log&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[68,69],&quot;f&quot;:true},&quot;v&quot;:&quot;ä½œç”¨ï¼šä¸åŒäº‹ç‰©æˆ–ç›¸åŒäº‹ç‰©å¯¹åŒä¸€æ¡è®°å½•ä¿®æ”¹&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[69,70],&quot;f&quot;:true},&quot;v&quot;:&quot;ä¼šå¯¼è‡´unlogç”Ÿæˆä¸€æ¡æŒ‰æ—¶é—´é¡ºåºçš„ç‰ˆæœ¬é“¾&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[70,71],&quot;f&quot;:true},&quot;v&quot;:&quot;é…åˆreadviewæ¥æ‰¾å‡ºå½“å‰è¯»æ—¶é€‰æ‹©çš„ç‰ˆæœ¬é“¾&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[71,72],&quot;f&quot;:true},&quot;v&quot;:&quot;rereadview&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[72,73],&quot;f&quot;:true},&quot;v&quot;:&quot;ä½œç”¨ï¼šç»™å¿«ç…§è¯»æä¾›ä¾æ®ï¼Œæ ¹æ®è§„åˆ™æ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬çš„undo logè®°å½•&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[73,74],&quot;f&quot;:true},&quot;v&quot;:&quot;åˆ›å»ºï¼šRCæ—¶ï¼Œæ¯æ¬¡è¯»éƒ½ä¼šç”Ÿæˆï¼ŒRRæ—¶ï¼Œç¬¬ä¸€æ¬¡æ‰ä¼šç”Ÿæˆï¼Œåç»­å¤ç”¨&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[74,75],&quot;f&quot;:true},&quot;v&quot;:&quot;æ ¸å¿ƒå­—æ®µ&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[75,76],&quot;f&quot;:true},&quot;v&quot;:&quot;m_ids:å½“å‰æ´»é±¼äº‹åŠ¡idé›†åˆ&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[76,77],&quot;f&quot;:true},&quot;v&quot;:&quot;min_trx_id:æœ€å°æ´»è·ƒäº‹åŠ¡id&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[77,78],&quot;f&quot;:true},&quot;v&quot;:&quot;max_trx_id:ä¸‹ä¸€ä¸ªäº‹ç‰©id&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[78,79],&quot;f&quot;:true},&quot;v&quot;:&quot;creator_trx_id : readViewåˆ›å»ºè€…çš„id&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[79,80],&quot;f&quot;:true},&quot;v&quot;:&quot;è§„åˆ™&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[80,81],&quot;f&quot;:true},&quot;v&quot;:&quot;trx_id == creator_trx_id å¯ä»¥è®¿é—®ã€‚è¯´æ˜è¿™ä¸ªæ•°æ®æ˜¯è‡ªå·±äº‹ç‰©æ”¹çš„&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[81,82],&quot;f&quot;:true},&quot;v&quot;:&quot;trx_id &amp;lt; min_trx_id å¯ä»¥è®¿é—®ã€‚è¯´æ˜è®¿é—®çš„æ•°æ®å·²ç»æäº¤äº†&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[82,83],&quot;f&quot;:true},&quot;v&quot;:&quot;trx_id &amp;gt; max_trx_id ä¸å¯ä»¥è®¿é—®ã€‚è¯´æ˜æ•°æ®æ˜¯åœ¨åˆ›å»ºä¹‹åäº‹ç‰©çš„&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[83,84],&quot;f&quot;:true},&quot;v&quot;:&quot;trx_id &amp;lt;= max_trx_id å¹¶ä¸” trx_id ä¸åœ¨m_idsä¸­ï¼Œå¯ä»¥è®¿é—®ï¼Œè¯´æ˜æ•°æ®å·²ç»æäº¤äº†&quot;}]}]}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[85,86],&quot;f&quot;:true},&quot;v&quot;:&quot;é”&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[86,87],&quot;f&quot;:true},&quot;v&quot;:&quot;ç­–ç•¥åˆ’åˆ†&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[87,88],&quot;f&quot;:true},&quot;v&quot;:&quot;ä¹è§‚é”ï¼šè‡ªä¸»ä»£ç å®ç°ï¼Œæ•°æ®åº“ä¸å‚ä¸&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[88,89],&quot;f&quot;:true},&quot;v&quot;:&quot;æ‚²è§‚é”ï¼šæ•°æ®åº“å†…éƒ¨å®ç°&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:3,&quot;p&quot;:{&quot;lines&quot;:[89,90],&quot;f&quot;:true},&quot;v&quot;:&quot;èŒƒå›´åˆ’åˆ†&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[90,91],&quot;f&quot;:true},&quot;v&quot;:&quot;å…¨å±€é”&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[91,92],&quot;f&quot;:true},&quot;v&quot;:&quot;ç”¨äºæ•°æ®åº“å¤‡ä»½ï¼Œéœ€è¦æ‰‹åŠ¨æ•²å‘½ä»¤&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[92,93],&quot;f&quot;:true},&quot;v&quot;:&quot;é—®é¢˜&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[93,94],&quot;f&quot;:true},&quot;v&quot;:&quot;ä¸»åº“ä¸Šï¼Œæ•°æ®æ— æ³•å˜æ›´ï¼Œå½±å“ä¸šåŠ¡&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[94,95],&quot;f&quot;:true},&quot;v&quot;:&quot;ä»åº“ä¸Šï¼Œä¸»ä»åŒæ­¥å»¶è¿Ÿï¼Œæ— æ³•ä¿éšœä¸€è‡´æ€§&quot;}]}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[95,96],&quot;f&quot;:true},&quot;v&quot;:&quot;è¡¨çº§é”&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[96,97],&quot;f&quot;:true},&quot;v&quot;:&quot;è¡¨é”&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[97,98],&quot;f&quot;:true},&quot;v&quot;:&quot;åŠ é”ï¼šlock table è¡¨å read/write&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[98,99],&quot;f&quot;:true},&quot;v&quot;:&quot;è§£é”ï¼šunlock tables è¡¨å / æ–­å¼€å®¢æˆ·ç«¯&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[99,100],&quot;f&quot;:true},&quot;v&quot;:&quot;åˆ†ç±»ï¼šè¡¨å…±äº«è¯»é”ï¼Œè¡¨å…±äº«å†™é”&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[100,101],&quot;f&quot;:true},&quot;v&quot;:&quot;è§„åˆ™ï¼šè¯»é”ï¼šæ‰€æœ‰å®¢æˆ·ç«¯å¯è¯»ä¸å¯å†™ï¼Œå†™é”ï¼šå½“å‰å¯è¯»å¯å†™&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[101,102],&quot;f&quot;:true},&quot;v&quot;:&quot;å…ƒæ•°æ®é”&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[102,103],&quot;f&quot;:true},&quot;v&quot;:&quot;ä½œç”¨ï¼šè®©å¢åˆ æ”¹ä¸ä¿®æ”¹è¡¨ç»“æ„ä¸å†²çª&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[103,104],&quot;f&quot;:true},&quot;v&quot;:&quot;åˆ†ç±»ï¼šå…±äº«é”ï¼Œæ’ä»–é”&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[104,105],&quot;f&quot;:true},&quot;v&quot;:&quot;åŠ é”ï¼šå¢åˆ æ”¹æŸ¥æ—¶å…±äº«é”ï¼Œä¿®æ”¹è¡¨ç»“æ„æ—¶æ’ä»–é”&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[105,106],&quot;f&quot;:true},&quot;v&quot;:&quot;è§„åˆ™ï¼šæ’ä»–é”å’Œå…¶ä»–äº’æ–¥&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[106,107],&quot;f&quot;:true},&quot;v&quot;:&quot;æ„å‘é”&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[107,108],&quot;f&quot;:true},&quot;v&quot;:&quot;ä½œç”¨ï¼šè¡¨é”è¡Œé”å†²çªæ—¶ï¼Œæ‰«ææ•´ä¸ªè¡¨æ¥åˆ¤æ–­æ˜¯å¦æœ‰è¡Œé”æ€§èƒ½å¤ªä½ï¼Œæ„å‘é”æ¥ç›´æ¥åˆ¤æ–­æ˜¯å¦å¯ä»¥åŠ é”&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[108,109],&quot;f&quot;:true},&quot;v&quot;:&quot;åˆ†ç±»ï¼šæ„å‘æ’ä»–é”ï¼ˆISï¼‰ï¼Œæ„å‘å…±äº«é”ï¼ˆIXï¼‰&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[109,110],&quot;f&quot;:true},&quot;v&quot;:&quot;åŠ é”ï¼šISï¼šselect share in mode IXï¼šå¢åˆ æ”¹ï¼Œselect for update&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[110,111],&quot;f&quot;:true},&quot;v&quot;:&quot;è§„åˆ™ï¼šISä¸è¡¨è¯»é”å…¼å®¹ï¼Œä¸è¡¨å†™é”äº’æ–¥ï¼ŒIXä¸è¡¨é”éƒ½äº’æ–¥ï¼Œæ„å‘é”ä¹‹é—´æ²¡å•¥åˆ¶çº¦å…³ç³»&quot;}]}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[111,112],&quot;f&quot;:true},&quot;v&quot;:&quot;è¡Œçº§é”&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[112,113],&quot;f&quot;:true},&quot;v&quot;:&quot;è¯´æ˜ï¼šInnoDBçš„æ•°æ®æ˜¯åŸºäºç´¢å¼•ç»„ç»‡çš„ï¼Œè¡Œé”æ˜¯é€šè¿‡å¯¹ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ï¼Œè€Œä¸æ˜¯å¯¹è®°å½•åŠ çš„é”&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[113,114],&quot;f&quot;:true},&quot;v&quot;:&quot;è¡Œé”ï¼šé”å•ä¸ªè¡Œè®°å½•ï¼Œé˜²æ­¢å…¶ä»–äº‹ç‰©ä¿®æ”¹ã€‚RCï¼ŒRRæ”¯æŒ&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[114,115],&quot;f&quot;:true},&quot;v&quot;:&quot;å…±äº«é”ï¼ˆSï¼‰ï¼šå…è®¸ä¸€ä¸ªäº‹åŠ¡å»è¯»ä¸€è¡Œï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„æ’å®ƒé”ã€‚&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[115,116],&quot;f&quot;:true},&quot;v&quot;:&quot;æ’ä»–é”ï¼ˆXï¼‰ï¼šå…è®¸è·å–æ’ä»–é”çš„äº‹åŠ¡æ›´æ–°æ•°æ®ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„å…±äº«é”å’Œæ’ä»–é”ã€‚&quot;}]},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[116,117],&quot;f&quot;:true},&quot;v&quot;:&quot;é—´éš™é”ï¼šé”è®°å½•çš„é—´éš™ï¼Œé˜²æ­¢å…¶ä»–äº‹ç‰©æ’å…¥ï¼Œäº§ç”Ÿå¹»è¯»ã€‚RRæ”¯æŒ&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[117,118],&quot;f&quot;:true},&quot;v&quot;:&quot;ä¸´é”®é”ï¼šè¡Œé”å’Œé—´éš™é”ç»„åˆï¼ŒRRæ”¯æŒ&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[118,119],&quot;f&quot;:true},&quot;v&quot;:&quot;é»˜è®¤æƒ…å†µä¸‹ï¼ŒInnoDBåœ¨ REPEATABLE READäº‹åŠ¡éš”ç¦»çº§åˆ«è¿è¡Œï¼ŒInnoDBä½¿ç”¨ next-key é”è¿›è¡Œæœç´¢å’Œç´¢å¼•|(æ‰«æï¼Œä»¥é˜²æ­¢å¹»è¯»ã€‚&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[119,120],&quot;f&quot;:true},&quot;v&quot;:&quot;1. é’ˆå¯¹å”¯ä¸€ç´¢å¼•è¿›è¡Œæ£€ç´¢æ—¶ï¼Œå¯¹å·²å­˜åœ¨çš„è®°å½•è¿›è¡Œç­‰å€¼åŒ¹é…æ—¶ï¼Œå°†ä¼šè‡ªåŠ¨ä¼˜åŒ–ä¸ºè¡Œé”ã€‚&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[120,121],&quot;f&quot;:true},&quot;v&quot;:&quot;2. InnoDBçš„è¡Œé”æ˜¯é’ˆå¯¹äºç´¢å¼•åŠ çš„é”ï¼Œä¸é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œé‚£ä¹ˆInnoDBå°†å¯¹è¡¨ä¸­çš„æ‰€æœ‰è®°å½•åŠ é”ï¼Œæ­¤æ—¶ å°±ä¼šå‡çº§ä¸ºè¡¨é”ã€‚&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[121,122],&quot;f&quot;:true},&quot;v&quot;:&quot;3. ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)ï¼Œç»™ä¸å­˜åœ¨çš„è®°å½•åŠ é”æ—¶ï¼Œä¼˜åŒ–ä¸ºé—´éš™é”ã€‚&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[122,123],&quot;f&quot;:true},&quot;v&quot;:&quot;4. ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(æ™®é€šç´¢å¼•)ï¼Œnext-key locké€€åŒ–ä¸ºé—´éš™é”ï¼Œé”è‡ªå·±å€¼å’Œå·¦å³é—´éš™&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[123,124],&quot;f&quot;:true},&quot;v&quot;:&quot;5. ç´¢å¼•ä¸Šçš„èŒƒå›´æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)ï¼Œå…¶èŒƒå›´å†…çš„ï¼Œåˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³çš„å€¼é—´éš™ï¼Œè‡ªå·±çš„å€¼éƒ½ä¼šåŠ é”&quot;},{&quot;t&quot;:&quot;heading&quot;,&quot;d&quot;:5,&quot;p&quot;:{&quot;lines&quot;:[124,125],&quot;f&quot;:true},&quot;v&quot;:&quot;6. é—´éš™é”å”¯ä¸€ç›®çš„æ˜¯é˜²æ­¢å…¶ä»–äº‹åŠ¡æ’å…¥é—´éš™ã€‚é—´éš™é”å¯ä»¥å…±å­˜ï¼Œä¸€ä¸ªäº‹åŠ¡é‡‡ç”¨çš„é—´éš™é”ä¸ä¼šé˜»æ­¢å¦ä¸€ä¸ªäº‹åŠ¡åœ¨åŒä¸€é—´éš™ä¸Šé‡‡ç”¨é—´éš™é”ã€‚&quot;}]}]}]}]}],&quot;p&quot;:{}}"></svg>
</div>





<h2 id="Mysqlç®¡ç†"><a href="#Mysqlç®¡ç†" class="headerlink" title="Mysqlç®¡ç†"></a><strong>Mysqlç®¡ç†</strong></h2><h3 id="ç³»ç»Ÿæ•°æ®åº“"><a href="#ç³»ç»Ÿæ•°æ®åº“" class="headerlink" title="ç³»ç»Ÿæ•°æ®åº“"></a><strong>ç³»ç»Ÿæ•°æ®åº“</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220621132624873.png" width="100%" / loading="lazy">

<h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a><strong>mysql</strong></h3><pre><code>    è¯­æ³•:
            mysql [options] [database]
    é€‰é¡¹:
            -u,--user=name                        #æŒ‡å®šç”¨æˆ·å
            -p,--password[=name]          #æŒ‡å®šå¯†ç 
            -h,--host=name                        #æŒ‡å®šæœåŠ¡å™¨ipå’ŒåŸŸå
            -P,--port=port                        #æŒ‡å®šè¿æ¥ç«¯å£ 
            -e,--execute=name                    #æ‰§è¡Œsqlè¯­å¥å¹¶é€€å‡º
    å®ä¾‹ï¼šä½¿ç”¨-eæ‰§è¡Œsqlè¯­å¥ï¼Œè€Œä¸ç”¨è¿æ¥mysqlå†æ‰§è¡Œï¼Œå¯¹å¤„ç†shellæ–¹ä¾¿
            mysql -uroot -p123456 db01 -e â€œselect * from stuâ€;    
</code></pre>
<h3 id="mysqladmin"><a href="#mysqladmin" class="headerlink" title="mysqladmin"></a><strong>mysqladmin</strong></h3><pre><code>    ä»‹ç»:
            mysqladmin æ˜¯ä¸€ä¸ªæ‰§è¡Œç®¡ç†æ“ä½œçš„å®¢æˆ·ç«¯ç¨‹åºã€‚å¯ä»¥ç”¨å®ƒæ¥æ£€æŸ¥æœåŠ¡å™¨çš„é…ç½®å’Œå½“å‰çŠ¶æ€ã€åˆ›å»ºå¹¶åˆ é™¤æ•°æ®åº“ç­‰ã€‚
    å®ä¾‹1:åˆ é™¤æ•°æ®åº“
            mysqladmin -uroot -p1234 drop db02
    å®ä¾‹2:æŸ¥çœ‹mysqlç‰ˆæœ¬
            mysqladmin -uroot -p1234 version
</code></pre>
<h3 id="mysqlbinlog"><a href="#mysqlbinlog" class="headerlink" title="mysqlbinlog"></a><strong>mysqlbinlog</strong></h3><pre><code>    è¯­æ³•:
            mysqlbinlog [options] log-files1 log-files2 ...
    é€‰é¡¹:
            -d,--database=name                æŒ‡å®šæ•°æ®åº“åç§°,åªåˆ—å‡ºæŒ‡å®šçš„æ•°æ®åº“ç›¸å…³æ“ä½œ
            -o,--offset=#                            å¿½ç•¥æ‰æ—¥å¿—ä¸­çš„å‰nè¡Œå‘½ä»¤
            -r,--result-file=name          å°†è¾“å‡ºçš„æ–‡æœ¬æ ¼å¼æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ã€‚
            -s, --short-form                    æ˜¾ç¤ºç®€å•æ ¼å¼ï¼Œçœç•¥æ‰ä¸€äº›ä¿¡æ¯ã€‚
            --start-datatime=datel --stop-datetime=date2     æŒ‡å®šæ—¥æœŸé—´éš”å†…çš„æ‰€æœ‰æ—¥å¿—ã€‚
            --start-position=posl --stop-position=pos2        æŒ‡å®šä½ç½®é—´éš”å†…çš„æ‰€æœ‰æ—¥å¿—ã€‚
</code></pre>
<h3 id="mysqlshow"><a href="#mysqlshow" class="headerlink" title="mysqlshow"></a><strong>mysqlshow</strong></h3><pre><code>    ä»‹ç»ï¼š        
            mysqlshow å®¢æˆ·ç«¯å¯¹è±¡æŸ¥æ‰¾å·¥å…·ï¼Œç”¨æ¥å¾ˆå¿«åœ°æŸ¥æ‰¾å­˜åœ¨å“ªäº›æ•°æ®åº“ã€æ•°æ®åº“ä¸­çš„è¡¨ã€è¡¨ä¸­çš„åˆ—æˆ–è€…ç´¢å¼•ã€‚
    è¯­æ³•ï¼š
            mysqlshow [options] [db_name[table_name[col_name]]
    é€‰é¡¹ï¼š 
            --count æ˜¾ç¤ºæ•°æ®åº“ï¼Œè¡¨ï¼Œçš„ç»Ÿè®¡ä¿¡æ¯
            -i            æ˜¾ç¤ºæŒ‡å®šæ•°æ®åº“æˆ–è€…æŒ‡å®šè¡¨çš„çŠ¶æ€ä¿¡æ¯
    å®ä¾‹ï¼š
            æŸ¥è¯¢mysqlæ•°æ®åº“ä¿¡æ¯
            mysqlshow -uroot -p1234 --count
            
            æŸ¥è¯¢teståº“ä¸­æ¯ä¸ªè¡¨ä¸­çš„å­—æ®µæ•°ï¼ŒåŠè¡Œæ•°
            mysqlshow -uroot -p1234 test --count
            
            æŸ¥è¯¢teståº“ä¸­bookè¡¨çš„è¯¦ç»†æƒ…å†µ
            mysqlshow -uroot -p1234 test book --count
</code></pre>
<h3 id="mysqldump"><a href="#mysqldump" class="headerlink" title="mysqldump"></a><strong>mysqldump</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220621162235073.png" width="100%" / loading="lazy">

<h3 id="mysqlimport-source"><a href="#mysqlimport-source" class="headerlink" title="mysqlimport/source"></a><strong>mysqlimport/source</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220621163153114.png" width="100%" / loading="lazy">

<h1 id="è¿ç»´ç¯‡"><a href="#è¿ç»´ç¯‡" class="headerlink" title="è¿ç»´ç¯‡"></a><strong>è¿ç»´ç¯‡</strong></h1><h2 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a><strong>æ—¥å¿—</strong></h2><h3 id="é”™è¯¯æ—¥å¿—"><a href="#é”™è¯¯æ—¥å¿—" class="headerlink" title="é”™è¯¯æ—¥å¿—"></a><strong>é”™è¯¯æ—¥å¿—</strong></h3><pre><code>    é”™è¯¯æ—¥å¿—æ˜¯ MySQL ä¸­æœ€é‡è¦çš„æ—¥å¿—ä¹‹ä¸€ï¼Œå®ƒè®°å½•äº†å½“mysqld å¯åŠ¨å’Œåœæ­¢æ—¶ï¼Œä»¥åŠæœåŠ¡å™¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•ä¸¥é‡é”™è¯¯æ—¶çš„ç›¸å…³ä¿¡æ¯
    å½“æ•°æ®åº“å‡ºç°ä»»ä½•æ•…éšœå¯¼è‡´æ— æ³•æ­£å¸¸ä½¿ç”¨æ—¶ï¼Œå»ºè®®é¦–å…ˆæŸ¥çœ‹æ­¤æ—¥å¿—ã€‚

    è¯¥æ—¥å¿—æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œé»˜è®¤å­˜æ”¾ç›®å½• /var/log/ï¼Œé»˜è®¤çš„æ—¥å¿—æ–‡ä»¶åä¸º mysqld.logã€‚æŸ¥çœ‹æ—¥å¿—ä½ç½®ï¼š
    show variables like&#39;%log_error%â€™
</code></pre>
<h3 id="äºŒè¿›åˆ¶æ—¥å¿—"><a href="#äºŒè¿›åˆ¶æ—¥å¿—" class="headerlink" title="äºŒè¿›åˆ¶æ—¥å¿—"></a><strong>äºŒè¿›åˆ¶æ—¥å¿—</strong></h3><pre><code>    äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBINLOGï¼‰è®°å½•äº†æ‰€æœ‰çš„ DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰è¯­å¥å’Œ DMLï¼ˆæ•°æ®æ“çºµè¯­è¨€ï¼‰è¯­å¥ï¼Œä½†ä¸åŒ…æ‹¬æ•°æ®æŸ¥è¯¢(SELECTã€ show)è¯­å¥ã€‚

    ä½œç”¨ï¼š
            â‘ ç¾éš¾æ—¶çš„æ•°æ®æ¢å¤ï¼›
            â‘¡MySQLçš„ä¸»ä»å¤åˆ¶ã€‚åœ¨MySQL3ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤äºŒè¿›åˆ¶æ—¥å¿—æ˜¯å¼€å¯ç€çš„ï¼Œæ¶‰åŠåˆ°çš„å‚æ•°å¦‚ä¸‹ï¼š
            show variables like&#39;%log_bin%
            æ–‡ä»¶ï¼š 
            | log_bin_basename                | /var/lib/mysql/binlog       | äºŒè¿›åˆ¶æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼Œbinlog001æ–‡ä»¶åç­‰ä¾æ¬¡é€’å¢
            | log_bin_index                   | /var/lib/mysql/binlog.index | ç´¢å¼•æ–‡ä»¶ï¼Œé‡Œé¢è®°å½•äº†æ‰€æœ‰çš„äºŒè¿›åˆ¶æ–‡ä»¶åˆ—è¡¨

    æ—¥å¿—æŸ¥çœ‹ï¼š
                ç”±äºæ—¥å¿—æ˜¯ä»¥äºŒè¿›åˆ¶æ–¹å¼å­˜å‚¨çš„ï¼Œä¸èƒ½ç›´æ¥è¯»å–ï¼Œéœ€è¦é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—æŸ¥è¯¢å·¥å…·mysqlbinlogæ¥æŸ¥çœ‹
            è¯­æ³•ï¼šmysqlbinlog [å‚æ•°é€‰é¡¹] logfilename    
            å‚æ•°é€‰é¡¹ï¼š
                -d        æŒ‡å®šæ•°æ®åº“åç§°,åªåˆ—å‡ºæŒ‡å®šçš„æ•°æ®åº“ç›¸å…³æ“ä½œ
                -o        å¿½ç•¥æ‰æ—¥å¿—ä¸­çš„å‰nè¡Œå‘½ä»¤ã€‚
                -v        å°†è¡Œäº‹ä»¶(æ•°æ®å˜æ›´)é‡æ„ä¸ºsqlè¯­å¥
                -W        å°†è¡Œäº‹ä»¶(æ•°æ®å˜æ›´)é‡æ„ä¸ºsqlè¯­å¥ï¼Œå¹¶è¾“å‡ºæ³¨é‡Šä¿¡æ¯
    æŸ¥çœ‹æ—¥å¿—æ ¼å¼ï¼š
            show variables like &#39;%binlog_format%â€™
    ä¿®æ”¹æ—¥å¿—æ ¼å¼:
            åœ¨/etc/my.cnf æ·»åŠ binlog_format=
    æ—¥å¿—åˆ é™¤
            å¯¹äºæ¯”è¾ƒç¹å¿™çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œæ¯å¤©ç”Ÿæˆçš„binlogæ•°æ®å·¨å¤§ï¼Œå¦‚æœé•¿æ—¶é—´ä¸æ¸…é™¤ï¼Œå°†ä¼šå ç”¨å¤§é‡ç£ç›˜ç©ºé—´ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¸…ç†æ—¥å¿—ï¼š
            ä¹Ÿå¯ä»¥åœ¨mysqlçš„é…ç½®æ–‡ä»¶ä¸­é…ç½®äºŒè¿›åˆ¶æ—¥å¿—çš„è¿‡æœŸæ—¶é—´ï¼Œè®¾ç½®äº†ä¹‹åï¼ŒäºŒè¿›åˆ¶æ—¥å¿—è¿‡æœŸä¼šè‡ªåŠ¨åˆ é™¤ã€‚é»˜è®¤30å¤©
            show variables like â€˜%binlog_expire_logs_seconds%â€™;
</code></pre>
<img src="http://hexo.xuxin.world/mysql/image-20220622101706490.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220622104826321.png" width="100%" / loading="lazy">

<h3 id="æŸ¥è¯¢æ—¥å¿—"><a href="#æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æŸ¥è¯¢æ—¥å¿—"></a><strong>æŸ¥è¯¢æ—¥å¿—</strong></h3><pre><code>    ä»‹ç»ï¼š
            ç”±äºäºŒè¿›åˆ¶æ—¥å¿—æ˜¯DDLä¸DMLè¯­å¥çš„è®°å½•ï¼ŒDQLåˆ™æ²¡æœ‰è®°å½•ï¼ŒæŸ¥è¯¢æ—¥å¿—è®°å½•äº†DQLè¯­å¥ï¼Œä½†é»˜è®¤æ˜¯å…³é—­çš„
    æŸ¥çœ‹æŸ¥è¯¢æ—¥å¿—ç›¸å…³
            show variables like â€˜%general%â€™;
    ä¿®æ”¹æŸ¥è¯¢æ—¥å¿—å‚æ•°
            vim /etc/my.cnf æ·»åŠ  å‚æ•°
    æŸ¥è¯¢æ—¥å¿—ç›¸å…³å‚æ•°
            general_log              è¡¨ç¤ºå…³è¿˜æ˜¯å¼€
            general_log_file          è¡¨ç¤ºå­˜æ”¾åœ¨å“ª
</code></pre>
<h3 id="æ…¢æŸ¥è¯¢æ—¥å¿—-1"><a href="#æ…¢æŸ¥è¯¢æ—¥å¿—-1" class="headerlink" title="æ…¢æŸ¥è¯¢æ—¥å¿—"></a><strong>æ…¢æŸ¥è¯¢æ—¥å¿—</strong></h3><pre><code>    æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡å‚æ•° long_query_time è®¾ç½®å€¼å¹¶ä¸”æ‰«æè®°å½•æ•°ä¸å°äº min_examined_row_limit
    çš„æ‰€æœ‰çš„SQLè¯­å¥çš„æ—¥å¿—ï¼Œé»˜è®¤æœªå¼€å¯ã€‚long_query_time é»˜è®¤ä¸º 10 ç§’ï¼Œæœ€å°ä¸º 0ï¼Œç²¾åº¦å¯ä»¥åˆ°å¾®ç§’ã€‚

        #æ…¢æŸ¥è¯¢æ—¥å¿—
        slow_query_log=1
        #æ‰§è¡Œæ—¶é—´å‚æ•°
        long_query_time=2

    é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ä¼šè®°å½•ç®¡ç†è¯­å¥ï¼Œä¹Ÿä¸ä¼šè®°å½•ä¸ä½¿ç”¨ç´¢å¼•è¿›è¡ŒæŸ¥æ‰¾çš„æŸ¥è¯¢ã€‚å¯ä»¥ä½¿ç”¨log_slow_admin_statementså’Œ
    æ›´æ”¹æ­¤è¡Œä¸º log_queries_not_using_indexesï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚

        #è®°å½•æ‰§è¡Œè¾ƒæ…¢çš„ç®¡ç†è¯­å¥
        log_slow_admin_ statements =1
        #è®°å½•æ‰§è¡Œè¾ƒæ…¢çš„æœªä½¿ç”¨ç´¢å¼•çš„è¯­å¥
        log_queries_ not_ using_indexes =1
</code></pre>
<h2 id="ä¸»ä»å¤åˆ¶"><a href="#ä¸»ä»å¤åˆ¶" class="headerlink" title="ä¸»ä»å¤åˆ¶"></a><strong>ä¸»ä»å¤åˆ¶</strong></h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a><strong>æ¦‚è¿°</strong></h3><pre><code>    - æ¦‚è¿°
        ä¸»ä»å¤åˆ¶æ˜¯æŒ‡å°†ä¸»æ•°æ®åº“çš„DDL å’Œ DMLæ“ä½œé€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¼ åˆ°ä»åº“æœåŠ¡å™¨ä¸­ï¼Œç„¶ååœ¨ä»åº“ä¸Šå¯¹è¿™äº›æ—¥å¿—é‡æ–°æ‰§è¡Œï¼ˆä¹Ÿå«é‡åšï¼‰ï¼Œä»è€Œä½¿å¾—ä»åº“å’Œä¸»åº“çš„æ•°æ®ä¿æŒåŒæ­¥ã€‚
        MySQLæ”¯æŒä¸€å°ä¸»åº“åŒæ—¶å‘å¤šå°ä»åº“è¿›è¡Œå¤åˆ¶ï¼Œä»åº“åŒæ—¶ä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–ä»æœåŠ¡å™¨çš„ä¸»åº“ï¼Œå®ç°é“¾çŠ¶å¤åˆ¶ã€‚

    - ä¼˜ç‚¹
        1.ä¸»åº“å‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ°ä»åº“æä¾›æœåŠ¡ã€‚
        2.å®ç°è¯»å†™åˆ†ç¦»ï¼Œé™ä½ä¸»åº“çš„è®¿é—®å‹åŠ›ã€‚
        3.å¯ä»¥åœ¨ä»åº“ä¸­æ‰§è¡Œå¤‡ä»½ï¼Œä»¥é¿å…å¤‡ä»½æœŸé—´å½±å“ä¸»åº“æœåŠ¡ã€‚
</code></pre>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a><strong>åŸç†</strong></h3><img src="http://hexo.xuxin.world/mysql/image-20220622144220884.png" width="100%" / loading="lazy">

<pre><code>    ä»ä¸Šå›¾æ¥çœ‹ï¼Œå¤åˆ¶åˆ†æˆä¸‰æ­¥ï¼š
        1.Master ä¸»åº“åœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œä¼šæŠŠæ•°æ®å˜æ›´è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ Binlog ä¸­
        2.ä»åº“è¯»å–ä¸»åº“çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ Binlogï¼Œå†™å…¥åˆ°ä»åº“çš„ä¸­ç»§æ—¥å¿— Relay Log
        3.slaveé‡åšä¸­ç»§æ—¥å¿—ä¸­çš„äº‹ä»¶ï¼Œå°†æ”¹å˜åæ˜ å®ƒè‡ªå·±çš„æ•°æ®ã€‚
</code></pre>
<h3 id="æ­å»º"><a href="#æ­å»º" class="headerlink" title="æ­å»º"></a><strong>æ­å»º</strong></h3><blockquote>
<ul>
<li>å‡†å¤‡å·¥ä½œ</li>
<li>ä¸»åº“é…ç½®</li>
<li>ä»åº“é…ç½®</li>
<li>éªŒè¯</li>
</ul>
</blockquote>
<ul>
<li><p>ä¸»åº“ä¿®æ”¹</p>
<pre><code>  - ä¿®æ”¹ä¸»åº“/etc/my.cnf
          #mysqlLæœåŠ¡IDï¼Œä¿è¯æ•´ä¸ªé›†ç¾¤ç¯å¢ƒä¸­å”¯ä¸€ï¼Œå–å€¼èŒƒå›´ï¼š1-232-1ï¼Œé»˜è®¤ä¸º1
          server-id=1
          #æ˜¯å¦åªè¯»,1ä»£è¡¨åªè¯»ï¼Œ0ä»£è¡¨è¯»å†™
          read-only=0
          
          #å¿½ç•¥çš„æ•°æ®ï¼ŒæŒ‡ä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“
          #binlog-ignore-db=mysql
          #æŒ‡å®šåŒæ­¥çš„æ•°æ®åº“
          #binlog-do-db=dbo1

  - é‡å¯mysql
          systemctl restart mysqld

  - ç™»å½•mysqlï¼Œåˆ›å»ºè¿œç¨‹è¿æ¥çš„è´¦å·ï¼Œå¹¶æˆäºˆä¸»ä»å¤åˆ¶æƒé™
          #åˆ›å»ºitcastç”¨æˆ·ï¼Œå¹¶è®¾ç½®å¯†ç ï¼Œè¯¥ç”¨æˆ·å¯åœ¨ä»»æ„ä¸»æœºè¿æ¥è¯¥MySQLæœåŠ¡
          CREATE USER &#39;xuxin&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;Xuxin@1234â€™;
          #ä¸ºxuxin&#39;@&#39;%ç”¨æˆ·åˆ†é…ä¸»ä»å¤åˆ¶æƒé™
          GRANT REPLICATION SLAVE ON *.* TO &#39;itcast&#39;@&#39;%&#39;;

  - æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—åæ ‡
          show master status;
          åŒ…å«ä»¥ä¸‹å­—æ®µï¼š
          fileï¼šä»å“ªä¸ªæ—¥å¿—æ–‡ä»¶å¼€å§‹æ¨é€æ—¥å¿—æ–‡ä»¶
          positionï¼šä»å“ªä¸ªä½ç½®å¼€å§‹æ¨é€æ—¥å¿—
          binlog_ignore_dbï¼šæŒ‡å®šä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“
</code></pre>
</li>
</ul>
<ul>
<li><p>ä»åº“ä¿®æ”¹</p>
<pre><code>  - ä¿®æ”¹ä»åº“/etc/my.cnf
          #mysqlLæœåŠ¡IDï¼Œä¿è¯æ•´ä¸ªé›†ç¾¤ç¯å¢ƒä¸­å”¯ä¸€ï¼Œå–å€¼èŒƒå›´ï¼š1-232-1ï¼Œé»˜è®¤ä¸º1
          server-id=2
          #æ˜¯å¦åªè¯»,1ä»£è¡¨åªè¯»ï¼Œ0ä»£è¡¨è¯»å†™
          read-only=1
          
          #å¿½ç•¥çš„æ•°æ®ï¼ŒæŒ‡ä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“
          #binlog-ignore-db=mysql
          #æŒ‡å®šåŒæ­¥çš„æ•°æ®åº“
          #binlog-do-db=dbo1
          #åªè¯»åªæ˜¯å¯¹äºæ™®é€šç”¨æˆ·æ¥è¯´çš„ï¼Œè¶…çº§ç®¡ç†å‘˜ä¹Ÿæ˜¯å¯ä»¥å†™çš„ï¼Œå¦‚æœç¦ç”¨éœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®
          #super-read-only=1

  - é‡å¯mysql
          systemctl restart mysqld

  - ç™»å½•mysqlï¼Œè®¾ç½®ä¸»åº“é…ç½®
          CHANGE REPLICATION SOURCE TO SOURCE_HOST=&#39;ä¸»åº“ip&#39;,SOURCE_USER=&#39;è¿æ¥ä¸»åº“ç”¨æˆ·å&#39;,SOURCE_PASSWORD=&#39;è¿æ¥ä¸»åº“çš„å¯†ç &#39;, SOURCE_LOG_FILE=&#39;å¼€å§‹ä¸»ä»å¤åˆ¶çš„binlogæ—¥å¿—æ–‡ä»¶å&#39;, SOURCE_LOG_POS=binlogæ–‡ä»¶ä½ç½®;
      
          æ³¨æ„ï¼šä¸Šè¿°æ˜¯8.0.23ä¸­çš„è¯­æ³•ã€‚å¦‚æœmysqlæ˜¯8.0.23ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæ‰§è¡Œå¦‚ä¸‹sql
          CHANGE MASRTER TO MASTER_HOST=&#39;ä¸»åº“ip&#39;,MASTER_USER=&#39;ç”¨æˆ·å&#39;,MASTER_PASSWORD=&#39;å¯†ç &#39;,MASTER_LOG_FILE=&#39;binlogæ–‡ä»¶å&#39;,MASTER_LOG_POS=&#39;binlogä½ç½®&#39;;
          
  - å¼€å¯åŒæ­¥æ“ä½œ
          start replica;        #8.0.22ä¹‹å
          start slave;            #8.0.22ä¹‹å‰

  - æŸ¥çœ‹ä¸»ä»åŒæ­¥çŠ¶æ€
          show replica status\G;        #8.0.22ä¹‹å
          show slave status\G;            #8.0.22ä¹‹å‰
          æ³¨æ„ï¼šåªè¦ä»¥ä¸‹2ä¸ªå‚æ•°æ­£å¸¸å³å¯ï¼Œä»£è¡¨ä¸€ä¸ªæ˜¯ioçº¿ç¨‹è¿è¡Œæ­£å¸¸ï¼Œä¸€ä¸ªæ˜¯sqlçº¿ç¨‹æ­£å¸¸
          replica_IO_Running:Yes
          Replica_SQL_Running:Yes
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220622151841459.png" width="100%" / loading="lazy">

<blockquote>
<p><strong>æ³¨æ„äº‹é¡¹ï¼šä¸»ä»å¤åˆ¶æ˜¯ä»å½“å‰ä½ç½®å¼€å§‹çš„ï¼Œå¦‚æœä¸»åº“ä¹‹å‰æœ‰æ•°æ®ï¼Œåº”è¯¥å…ˆè½¬æˆsqlè„šæœ¬åœ¨ä»åº“ä¸­è¿è¡Œï¼Œå†è¿›è¡Œä¸»ä»å¤åˆ¶</strong></p>
</blockquote>
<h2 id="åˆ†åº“åˆ†è¡¨"><a href="#åˆ†åº“åˆ†è¡¨" class="headerlink" title="åˆ†åº“åˆ†è¡¨"></a><strong>åˆ†åº“åˆ†è¡¨</strong></h2><h3 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="headerlink" title="æ¦‚è¿°"></a><strong>æ¦‚è¿°</strong></h3><ul>
<li>åŸå§‹æ•°æ®åº“çš„é—®é¢˜<pre><code>  ç£ç›˜ioï¼Œç½‘ç»œioï¼Œcpuå‹åŠ›å¤§
</code></pre>
</li>
<li>æ‹†åˆ†ç­–ç•¥<pre><code>  å‚ç›´æ‹†åˆ†åº“ï¼šä»¥è¡¨ä¸ºå•ä½ï¼Œæ”¾åˆ°ä¸åŒçš„æ•°æ®åº“ä¸­
  æ°´å¹³æ‹†åˆ†åº“ï¼šä»¥å­—æ®µä¸ºå•ä½ï¼Œå°†ä¸åŒå­—æ®µåˆ†åˆ°ä¸åŒçš„è¡¨ä¸­
  å‚ç›´æ‹†åˆ†è¡¨ï¼šä»¥æ•°æ®ä¸ºå•ä½ï¼ŒæŠŠåº“ä¸­æ•°æ®åˆ†æ•£åˆ°å…¶ä»–åº“ä¸­ï¼Œåº“ä¸­æœ‰å¤šä¸ªè¡¨
  æ°´å¹³æ‹†åˆ†è¡¨ï¼šä»¥æ•°æ®ä¸ºå•ä½ï¼ŒæŠŠè¡¨ä¸­æ•°æ®åˆ†æ•£åˆ°å…¶ä»–åº“ä¸­ï¼Œåº“ä¸­æœ‰1ä¸ªè¡¨
</code></pre>
</li>
<li>å®ç°æŠ€æœ¯<pre><code>  shardingJDBCï¼š åŸºäºAOPåŸç†ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­å¯¹æœ¬åœ°æ‰§è¡Œçš„SQLè¿›è¡Œæ‹¦æˆªï¼Œè§£æã€æ”¹å†™ã€è·¯ç”±å¤„ç†ã€‚éœ€è¦è‡ªè¡Œç¼–ç é…ç½®å®ç°ï¼Œåªæ”¯æŒjavaè¯­è¨€ï¼Œæ€§èƒ½è¾ƒé«˜ã€‚
  Mycatï¼šæ•°æ®åº“åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶ï¼Œä¸ç”¨è°ƒæ•´ä»£ç å³å¯å®ç°åˆ†åº“åˆ†è¡¨ï¼Œæ”¯æŒå¤šç§è¯­è¨€ï¼Œæ€§èƒ½ä¸åŠå‰è€…ã€‚
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220622163256618.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220622163615173.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220622164125006.png" width="100%" / loading="lazy">


<h3 id="mycat"><a href="#mycat" class="headerlink" title="mycat"></a><strong>mycat</strong></h3><ul>
<li>ä»‹ç»<pre><code>  Mycatæ˜¯å¼€æºçš„ã€æ´»è·ƒçš„ã€åŸºäºJavaè¯­è¨€ç¼–å†™çš„MySQLæ•°æ®åº“ä¸­é—´ä»¶ã€‚å¯ä»¥åƒä½¿ç”¨mysqlä¸€æ ·æ¥ä½¿ç”¨mycatï¼Œå¯¹äºå¼€å‘äººå‘˜æ¥è¯´æ ¹æœ¬æ„Ÿè§‰ä¸åˆ°mycatçš„å­˜åœ¨ã€‚
</code></pre>
</li>
<li>ä¼˜åŠ¿<pre><code>  æ€§èƒ½å¯é ç¨³å®š
  å¼ºå¤§çš„æŠ€æœ¯å›¢é˜Ÿ
  ä½“ç³»å®Œå–„
  ç¤¾åŒºæ´»è·ƒ
</code></pre>
</li>
<li>ä¸‹è½½<pre><code>  1.å®˜ç½‘ä¸‹è½½http://www.mycat.org.cn/
  2.è§£å‹åˆ°/usr/localä¸‹
  3.è¿›å…¥mycatçš„libç›®å½•ä¸‹ï¼Œæ‰¾åˆ°mysqlé©±åŠ¨jaråŒ…åˆ é™¤
  4.ä¸Šä¼ mysql8.0ä»¥ä¸Šçš„jaråŒ…åˆ°libç›®å½•
</code></pre>
</li>
<li>ç›®å½•ç»“æ„<pre><code>  bin ï¼š å­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç”¨äºå¯åŠ¨åœæ­¢mycat
  confï¼šå­˜æ”¾mycatçš„é…ç½®æ–‡ä»¶
  libï¼š å­˜æ”¾mycatçš„é¡¹ç›®ä¾èµ–åŒ… ï¼ˆjar)
  logsï¼šå­˜æ”¾mycatçš„æ—¥å¿—æ–‡ä»¶
</code></pre>
</li>
</ul>
<blockquote>
<p><strong>å®‰è£…jdkâ€”-é…ç½®ç¯å¢ƒå˜é‡</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">JAVA_HOME=/usr/local/jdk1.8.0_171</span><br><span class="line">PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<p><strong>mycatæ¦‚å¿µå›¾</strong></p>
<img src="http://hexo.xuxin.world/mysql/image-20220623092713677.png" width="100%" / loading="lazy">

<blockquote>
<p><strong>mychaté…ç½®</strong></p>
</blockquote>
<p><strong>schema.xmlé…ç½®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;</span><br><span class="line">&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;schema name=&quot;TESTDB&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot; randomDataNode=&quot;dn1&quot;&gt;</span><br><span class="line">		&lt;table name=&quot;travelrecord,address&quot; dataNode=&quot;dn1,dn2&quot; rule=&quot;auto-sharding-long&quot; splitTableNames =&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/schema&gt;</span><br><span class="line"></span><br><span class="line">	&lt;dataNode name=&quot;dn1&quot; dataHost=&quot;dhost1&quot; database=&quot;db01&quot; /&gt;</span><br><span class="line">	&lt;dataNode name=&quot;dn2&quot; dataHost=&quot;dhost2&quot; database=&quot;db01&quot; /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;dataHost name=&quot;dhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;</span><br><span class="line">			  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;</span><br><span class="line">		&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;</span><br><span class="line">		&lt;writeHost host=&quot;hostM1&quot; url=&quot;jdbc:mysql://43.142.107.197?useSSL=false&amp;amp;serverTimezone=Asiz/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot;</span><br><span class="line">				   password=&quot;1234&quot;&gt;</span><br><span class="line">		&lt;/writeHost&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/dataHost&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;dataHost name=&quot;dhost2&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;</span><br><span class="line">			  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;</span><br><span class="line">		&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;</span><br><span class="line">		&lt;writeHost host=&quot;hostM1&quot; url=&quot;jdbc:mysql://101.200.39.91?useSSL=false&amp;amp;serverTimezone=Asiz/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot;</span><br><span class="line">				   password=&quot;hxuxingy12&quot;&gt;</span><br><span class="line">		&lt;/writeHost&gt;</span><br><span class="line">	&lt;/dataHost&gt;</span><br><span class="line">&lt;/mycat:schema&gt;</span><br></pre></td></tr></table></figure>

<p><strong>é…ç½®server.xmlï¼Œä¿®æ”¹å¯†ç å’Œschemas</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;user name=&quot;root&quot; defaultAccount=&quot;true&quot;&gt;</span><br><span class="line">	&lt;property name=&quot;password&quot;&gt;123456&lt;/property&gt;</span><br><span class="line">	&lt;property name=&quot;schemas&quot;&gt;TESTDB&lt;/property&gt;</span><br><span class="line">	&lt;property name=&quot;defaultSchema&quot;&gt;TESTDB&lt;/property&gt;</span><br><span class="line">&lt;/user&gt;</span><br><span class="line"></span><br><span class="line">&lt;user name=&quot;user&quot;&gt;</span><br><span class="line">	&lt;property name=&quot;password&quot;&gt;123456&lt;/property&gt;</span><br><span class="line">	&lt;property name=&quot;schemas&quot;&gt;TESTDB&lt;/property&gt;</span><br><span class="line">	&lt;property name=&quot;readOnly&quot;&gt;true&lt;/property&gt;</span><br><span class="line">	&lt;property name=&quot;defaultSchema&quot;&gt;TESTDB&lt;/property&gt;</span><br><span class="line">&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<h4 id="mycaté…ç½®æ–‡ä»¶"><a href="#mycaté…ç½®æ–‡ä»¶" class="headerlink" title="mycaté…ç½®æ–‡ä»¶"></a><strong>mycaté…ç½®æ–‡ä»¶</strong></h4><p><strong>schema.xml</strong></p>
<pre><code>    schema.xml ä½œä¸ºMyCatä¸­æœ€é‡è¦çš„é…ç½®æ–‡ä»¶ä¹‹ä¸€ï¼Œæ¶µç›–äº†MyCatçš„é€»è¾‘åº“ã€é€»è¾‘è¡¨ã€åˆ†ç‰‡è§„åˆ™ã€åˆ†ç‰‡èŠ‚ç‚¹åŠæ•°æ®æºçš„é…ç½®ã€‚
    ä¸»è¦åŒ…å«ä»¥ä¸‹ä¸‰ç»„æ ‡ç­¾ï¼š
    schemaæ ‡ç­¾            --é€»è¾‘åº“ã€é€»è¾‘è¡¨ã€åŒ…å«çš„ç»“ç‚¹ã€ç”¨ä»€ä¹ˆè§„åˆ™
    datanodeæ ‡ç­¾        --ç»“ç‚¹ä¿¡æ¯
    datahostæ ‡ç­¾        --æ•°æ®æºä¿¡æ¯
</code></pre>
<ul>
<li>schema<pre><code>  æ ¸å¿ƒå±æ€§ï¼š
  nameï¼š æŒ‡å®šè‡ªå®šä¹‰çš„é€»è¾‘åº“åº“åï¼ŒåŒºåˆ†å¤§å°å†™
  checkSQLschemaï¼šåœ¨SQLè¯­å¥æ“ä½œæ—¶æŒ‡å®šäº†æ•°æ®åº“åç§°ï¼Œæ‰§è¡Œæ—¶æ˜¯å¦è‡ªåŠ¨å»é™¤ï¼›trueï¼šè‡ªåŠ¨å»é™¤ï¼Œfalseï¼šä¸è‡ªåŠ¨å»é™¤
  sqlMaxLimitï¼šå¦‚æœæœªæŒ‡å®šlimitè¿›è¡ŒæŸ¥è¯¢ï¼Œåˆ™åªæŸ¥è¿™ä¸ªæ•°
</code></pre>
</li>
<li>table<pre><code>  æ ¸å¿ƒå±æ€§ï¼š
  nameï¼šå®šä¹‰é€»è¾‘è¡¨è¡¨åï¼Œåœ¨è¯¥é€»è¾‘åº“ä¸‹å”¯ä¸€
  dataNodeï¼šå®šä¹‰é€»è¾‘è¡¨æ‰€å±çš„dataNodeï¼Œè¯¥å±æ€§éœ€è¦ä¸dataNodeæ ‡ç­¾ä¸­nameå¯¹åº”ï¼›å¤šä¸ªdataNodeé€—å·åˆ†éš”
  ruleï¼šåˆ†ç‰‡è§„åˆ™çš„åå­—ï¼Œåˆ†ç‰‡è§„åˆ™åå­—æ˜¯åœ¨rule.xm[ä¸­å®šä¹‰çš„
  primarykeyï¼š é€»è¾‘è¡¨å¯¹åº”çœŸå®è¡¨çš„ä¸»é”®
  typeï¼šé€»è¾‘è¡¨çš„ç±»å‹ï¼Œç›®å‰é€»è¾‘è¡¨åªæœ‰å…¨å±€è¡¨å’Œæ™®é€šè¡¨ï¼Œå¦‚æœæœªé…ç½®ï¼Œå°±æ˜¯æ™®é€šè¡¨ï¼›å…¨å±€è¡¨ï¼Œé…ç½®ä¸º global
</code></pre>
</li>
<li>dataNode<pre><code>  æ ¸å¿ƒå±æ€§ï¼š
  nameï¼šå®šä¹‰æ•°æ®èŠ‚ç‚¹åç§°
  dataHostï¼šæ•°æ®åº“å®ä¾‹ä¸»æœºåç§°ï¼Œå¼•ç”¨è‡ª dataHost æ ‡ç­¾ä¸­nameå±æ€§
  databaseï¼š å®šä¹‰åˆ†ç‰‡æ‰€å±æ•°æ®åº“
</code></pre>
</li>
<li>dbDriver<pre><code>  æ ¸å¿ƒå±æ€§ï¼š
  nameï¼šå”¯ä¸€æ ‡è¯†ï¼Œä¾›ä¸Šå±‚æ ‡ç­¾ä½¿ç”¨
  maxCon/minConï¼šæœ€å¤§è¿æ¥æ•°/æœ€å°è¿æ¥æ•°
  balanceï¼šè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå–å€¼0,1,2,3ï¼‰
  writeTypeï¼šå†™æ“ä½œåˆ†å‘æ–¹å¼ï¼ˆ0ï¼šå†™æ“ä½œè½¬å‘åˆ°ç¬¬ä¸€ä¸ªwriteHostï¼Œç¬¬ä¸€ä¸ªæŒ‚äº†ï¼Œåˆ‡æ¢åˆ°ç¬¬äºŒä¸ªï¼›1ï¼šå†™æ“ä½œéšæœºåˆ†å‘åˆ°é…ç½®çš„writeHostï¼‰
  dbDriverï¼šæ•°æ®åº“é©±åŠ¨ï¼Œæ”¯æŒ nativeã€ jdbc
</code></pre>
</li>
</ul>
<img src="http://hexo.xuxin.world/mysql/image-20220628223754338.png" width="100%" / loading="lazy">

<p><strong>rule.xml</strong></p>
<pre><code>    rule.xm/ä¸­å®šä¹‰æ‰€æœ‰æ‹†åˆ†è¡¨çš„è§„åˆ™,åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¯ä»¥çµæ´»çš„ä½¿ç”¨åˆ†ç‰‡ç®—æ³•ï¼Œæˆ–è€…å¯¹åŒä¸€ä¸ªåˆ†ç‰‡ç®—æ³•ä½¿ç”¨ä¸åŒçš„å‚æ•°ï¼Œå®ƒè®©åˆ†ç‰‡è¿‡ç¨‹å¯é…
    ç½®åŒ–ã€‚ä¸»è¦åŒ…å«ä¸¤ç±»æ ‡ç­¾ï¼štableRuleã€ Functionã€‚
</code></pre>
<p><strong>server.xml</strong></p>
<img src="http://hexo.xuxin.world/mysql/image-20220628224340402.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628224315561.png" width="100%" / loading="lazy">

<h4 id="å‚ç›´åˆ†åº“"><a href="#å‚ç›´åˆ†åº“" class="headerlink" title="å‚ç›´åˆ†åº“"></a><strong>å‚ç›´åˆ†åº“</strong></h4><blockquote>
<ul>
<li>å¤šè¡¨è”æŸ¥ä¸­æ‰€æœ‰çš„è¡¨åªèƒ½åœ¨åŒä¸€ä¸ªç»“ç‚¹ä¸Š</li>
<li>å¯ä»¥å°†å­—å…¸ç±»å‹çš„è¡¨è®¾ç½®ä¸ºå…¨å±€è¡¨ï¼Œä»¥æ–¹ä¾¿å¤šè¡¨è”æŸ¥</li>
<li>å…¨å±€è¡¨åœ¨æ‰€æœ‰ç»“ç‚¹ä¸Šéƒ½å­˜åœ¨ä¸”ä¿®æ”¹åŠ¨å…¨éƒ¨</li>
</ul>
</blockquote>
<h4 id="åˆ†ç‰‡è§„åˆ™"><a href="#åˆ†ç‰‡è§„åˆ™" class="headerlink" title="åˆ†ç‰‡è§„åˆ™"></a><strong>åˆ†ç‰‡è§„åˆ™</strong></h4><h5 id="èŒƒå›´åˆ†ç‰‡"><a href="#èŒƒå›´åˆ†ç‰‡" class="headerlink" title="èŒƒå›´åˆ†ç‰‡"></a><strong>èŒƒå›´åˆ†ç‰‡</strong></h5><img src="http://hexo.xuxin.world/mysql/image-20220628231518331.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628231651860.png" width="100%" / loading="lazy">


<h5 id="å–æ¨¡åˆ†ç‰‡"><a href="#å–æ¨¡åˆ†ç‰‡" class="headerlink" title="å–æ¨¡åˆ†ç‰‡"></a><strong>å–æ¨¡åˆ†ç‰‡</strong></h5><img src="http://hexo.xuxin.world/mysql/image-20220628231810340.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628231854778.png" width="100%" / loading="lazy">

<h5 id="ä¸€è‡´æ€§å“ˆå¸Œ"><a href="#ä¸€è‡´æ€§å“ˆå¸Œ" class="headerlink" title="ä¸€è‡´æ€§å“ˆå¸Œ"></a><strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong></h5><img src="http://hexo.xuxin.world/mysql/image-20220628232121270.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628232444533.png" width="100%" / loading="lazy">


<h5 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a><strong>æšä¸¾</strong></h5><img src="http://hexo.xuxin.world/mysql/image-20220628232759934.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628232708998.png" width="100%" / loading="lazy">


<h4 id="åº”ç”¨æŒ‡å®š"><a href="#åº”ç”¨æŒ‡å®š" class="headerlink" title="åº”ç”¨æŒ‡å®š"></a><strong>åº”ç”¨æŒ‡å®š</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220628233248849.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628233304222.png" width="100%" / loading="lazy">


<h4 id="å›ºå®šåˆ†ç‰‡-hashç®—æ³•"><a href="#å›ºå®šåˆ†ç‰‡-hashç®—æ³•" class="headerlink" title="å›ºå®šåˆ†ç‰‡-hashç®—æ³•"></a><strong>å›ºå®šåˆ†ç‰‡-hashç®—æ³•</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220628233820501.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628234023488.png" width="100%" / loading="lazy">


<h4 id="å­—ç¬¦ä¸²hashè§£æ"><a href="#å­—ç¬¦ä¸²hashè§£æ" class="headerlink" title="å­—ç¬¦ä¸²hashè§£æ"></a><strong>å­—ç¬¦ä¸²hashè§£æ</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220628234640756.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628234944579.png" width="100%" / loading="lazy">


<h4 id="æŒ‰å¤©åˆ†ç‰‡"><a href="#æŒ‰å¤©åˆ†ç‰‡" class="headerlink" title="æŒ‰å¤©åˆ†ç‰‡"></a><strong>æŒ‰å¤©åˆ†ç‰‡</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220628235201813.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628235320598.png" width="100%" / loading="lazy">


<h4 id="æŒ‰è‡ªç„¶æœˆåˆ†ç‰‡"><a href="#æŒ‰è‡ªç„¶æœˆåˆ†ç‰‡" class="headerlink" title="æŒ‰è‡ªç„¶æœˆåˆ†ç‰‡"></a><strong>æŒ‰è‡ªç„¶æœˆåˆ†ç‰‡</strong></h4><img src="http://hexo.xuxin.world/mysql/image-20220628235538984.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220628235633481.png" width="100%" / loading="lazy">


<h3 id="mycatçš„ç®¡ç†ä¸ç›‘æ§"><a href="#mycatçš„ç®¡ç†ä¸ç›‘æ§" class="headerlink" title="mycatçš„ç®¡ç†ä¸ç›‘æ§"></a><strong>mycatçš„ç®¡ç†ä¸ç›‘æ§</strong></h3><p><strong>æ’å…¥æµç¨‹</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629000323248.png" width="100%" / loading="lazy"></p>
<p><strong>æŸ¥è¯¢æµç¨‹</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629000358001.png" width="100%" / loading="lazy"></p>
<p><strong>mycatç®¡ç†</strong></p>
<pre><code>    Mycaté»˜è®¤å¼€é€š2ä¸ªç«¯å£ï¼Œå¯ä»¥åœ¨serverxmlä¸­è¿›è¡Œä¿®æ”¹ã€‚
        - 8066 æ•°æ®è®¿é—®ç«¯å£ï¼Œå³è¿›è¡Œ DML å’Œ DDLæ“ä½œã€‚
        - 9066æ•°æ®åº“ç®¡ç†ç«¯å£ï¼Œå³ mycat æœåŠ¡ç®¡ç†æ§åˆ¶åŠŸèƒ½ï¼Œç”¨äºç®¡ç†mycatçš„æ•´ä¸ªé›†ç¾¤çŠ¶æ€
    mysql -h 192.168.200.210 -p 9066 -uroot -p123456
</code></pre>
<img src="http://hexo.xuxin.world/mysql/image-20220629000638443.png" width="100%" / loading="lazy">

<p><strong>mycatç®¡ç†çš„å›¾å½¢åŒ–ç•Œé¢</strong></p>
<pre><code>    Mycat-eye
    - ä»‹ç»
            Myeatwecb(ryateye)æ˜¯å¯¹myatsevesæä¾›è”¬æ§æœåŠ¡ï¼ŒåŠŸèƒ½ä¸å±€é™äºå¯¹myatseverä½¿ç”¨ï¼Œ
            ä»–é€šè¿‡IDecè²æ¥å¯¹wveatã€ MAeAç›‘æ§ï¼Œç›‘æ§è¿œç¨‹æœåŠ¡å™¨(ç›®å‰ä»…é™äºlinuxç³»ç»Ÿ)çš„cpuã€å†…å­˜ã€ç½‘ç»œã€ç£ç›˜ã€‚
            Mycat-eyeè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦ä¾èµ–zookeeperï¼Œå› æ­¤éœ€è¦å…ˆå®‰è£…zookeeperã€‚
    - å®‰è£…
            Zookeeperå®‰è£…
            MyCat-webå®‰è£…
    - è®¿é—®
            ip:ç«¯å£/mycat
</code></pre>
<img src="http://hexo.xuxin.world/mysql/image-20220629002311075.png" width="100%" / loading="lazy">

<h2 id="è¯»å†™åˆ†ç¦»"><a href="#è¯»å†™åˆ†ç¦»" class="headerlink" title="è¯»å†™åˆ†ç¦»"></a><strong>è¯»å†™åˆ†ç¦»</strong></h2><img src="http://hexo.xuxin.world/mysql/image-20220629093836872.png" width="100%" / loading="lazy">
<img src="http://hexo.xuxin.world/mysql/image-20220629094116269.png" width="100%" / loading="lazy">

<ul>
<li>ä»‹ç»<pre><code>  è¯»å†™åˆ†ç¦»,ç®€å•åœ°è¯´æ˜¯æŠŠå¯¹æ•°æ®åº“çš„è¯»å’Œå†™æ“ä½œåˆ†å¼€,ä»¥å¯¹åº”ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨ã€‚
  ä¸»æ•°æ®åº“æä¾›å†™æ“ä½œï¼Œä»æ•°æ®åº“æä¾›è¯»æ“ä½œï¼Œè¿™æ ·èƒ½æœ‰æ•ˆåœ°å‡è½»å•å°æ•°æ®åº“çš„å‹åŠ›ã€‚
  é€šè¿‡MyCatå³å¯è½»æ˜“å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œä¸ä»…å¯ä»¥æ”¯æŒMySQLï¼Œä¹Ÿå¯ä»¥æ”¯æŒOracleå’ŒSQL Server
</code></pre>
</li>
</ul>
<h3 id="ä¸€ä¸»ä¸€ä¸›"><a href="#ä¸€ä¸»ä¸€ä¸›" class="headerlink" title="ä¸€ä¸»ä¸€ä¸›"></a><strong>ä¸€ä¸»ä¸€ä¸›</strong></h3><blockquote>
<ul>
<li><strong>å…ˆæ­å»ºä¸»ä»å¤åˆ¶</strong></li>
<li><strong>å†æ­å»ºè¯»å†™åˆ†ç¦»</strong></li>
</ul>
</blockquote>
<p><strong>é…ç½®ä¸»ä»å®¿ä¸»æœº</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629094621248.png" width="100%" / loading="lazy"></p>
<p><strong>é…ç½®è´Ÿè½½å‡è¡¡ç­–ç•¥</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629094823250.png" width="100%" / loading="lazy"></p>
<p><strong>é—®é¢˜ï¼šä¸»èŠ‚ç‚¹Masterå®•æœºä¹‹åï¼Œä¸šåŠ¡ç³»ç»Ÿå°±åªèƒ½å¤Ÿè¯»ï¼Œè€Œä¸èƒ½å†™å…¥æ•°æ®äº†ã€‚</strong></p>
<h3 id="åŒä¸»åŒä»"><a href="#åŒä¸»åŒä»" class="headerlink" title="åŒä¸»åŒä»"></a><strong>åŒä¸»åŒä»</strong></h3><pre><code>    ä¸€ä¸ªä¸»æœº Master1 ç”¨äºå¤„ç†æ‰€æœ‰å†™è¯·æ±‚ï¼Œå®ƒçš„ä»æœº Slave1 å’Œå¦ä¸€å°ä¸»æœº Master2 è¿˜æœ‰å®ƒçš„ä»æœº Slave2 è´Ÿè´£æ‰€æœ‰è¯»è¯·æ±‚ã€‚
    å½“ Master1ä¸»æœºå®•æœºåï¼ŒMaster2 ä¸»æœºè´Ÿè´£å†™è¯·æ±‚ï¼ŒMaster1ã€Master2 äº’ä¸ºå¤‡æœºã€‚æ¶æ„å›¾å¦‚ä¸‹ï¼š
</code></pre>
<img src="http://hexo.xuxin.world/mysql/image-20220629095747304.png" width="100%" / loading="lazy">

<p><strong>æ­å»º</strong></p>
<p><strong>ä¸»1é…ç½®</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629100215918.png" width="100%" / loading="lazy"></p>
<p> <strong>ä¸»2é…ç½®</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629100315109.png" width="100%" / loading="lazy"></p>
<p><strong>ä¸»åº“åˆ†åˆ«åˆ›å»ºç”¨æˆ·å¹¶æˆæƒ</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629100402781.png" width="100%" / loading="lazy"></p>
<p><strong>ä»åº“é…ç½®</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629100529260.png" width="100%" / loading="lazy"></p>
<p><strong>ä»åº“å…³è”ä¸»åº“å¹¶æŸ¥çœ‹çŠ¶æ€</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629100630444.png" width="100%" / loading="lazy"></p>
<p><strong>ä¸»ä¸»ä¹‹é—´ä¸»ä»å¤åˆ¶</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629100842850.png" width="100%" / loading="lazy"></p>
<p><strong>mycatè¯»å†™åˆ†ç¦»çš„é…ç½®</strong><br><img src="http://hexo.xuxin.world/mysql/image-20220629101204517.png" width="100%" / loading="lazy"><br><img src="http://hexo.xuxin.world/mysql/image-20220629101426171.png" width="100%" / loading="lazy"></p>
<h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a><strong>å…¶ä»–</strong></h1><h2 id="AOPè®°å½•æ—¥å¿—"><a href="#AOPè®°å½•æ—¥å¿—" class="headerlink" title="AOPè®°å½•æ—¥å¿—"></a><strong>AOPè®°å½•æ—¥å¿—</strong></h2><h2 id="ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–"><a href="#ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–"></a><strong>ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–</strong></h2><h2 id="MySQLä¸­çš„ORDER-BY-field"><a href="#MySQLä¸­çš„ORDER-BY-field" class="headerlink" title="MySQLä¸­çš„ORDER BY field"></a><strong>MySQLä¸­çš„ORDER BY field</strong></h2><pre><code>    MySQLå¯ä»¥é€šè¿‡field()å‡½æ•°è‡ªå®šä¹‰æ’åº

    - æ ¼å¼
            field(value,str1,str2,str3,str4)
    - è¯´æ˜
            valueä¸str1ã€str2ã€str3ã€str4æ¯”è¾ƒï¼Œè¿”å›1ã€2ã€3ã€ 4
            å¦‚é‡åˆ°ä¸åœ¨åˆ—è¡¨ä¸­çš„æ•°æ®åˆ™æ’åºåœ¨æœ€å‰ï¼Œä¸”æŒ‰ç…§ä¸»é”®é€’å¢æ’åº

            å¦‚æœdescå€’åºäº†ï¼Œå€’åºæ—¶ï¼ŒæŒ‰ç…§str3ï¼Œstr2ï¼Œstr1çš„é¡ºåºé€†å‘æ’åºï¼Œä¸åœ¨str1ï¼Œstr2ï¼Œstr3ä¸­çš„è®°å½•æ”¾åˆ°æœ€åï¼›strå€¼ç›¸åŒæŒ‰ä¸»é”®é¡ºåºæ’åˆ—
</code></pre>
<h2 id="é…ç½®æ–‡ä»¶å‚æ•°"><a href="#é…ç½®æ–‡ä»¶å‚æ•°" class="headerlink" title="é…ç½®æ–‡ä»¶å‚æ•°"></a><strong>é…ç½®æ–‡ä»¶å‚æ•°</strong></h2><h2 id="äº‹ä»¶-å®šæ—¶ä»»åŠ¡"><a href="#äº‹ä»¶-å®šæ—¶ä»»åŠ¡" class="headerlink" title="äº‹ä»¶(å®šæ—¶ä»»åŠ¡)"></a><strong>äº‹ä»¶(å®šæ—¶ä»»åŠ¡)</strong></h2><ul>
<li><p>æ¦‚å¿µ</p>
<pre><code>  MySQL5.1ç‰ˆæœ¬å¼€å§‹å¼•è¿›eventæ¦‚å¿µï¼ŒMySQL ä¸­çš„äº‹ä»¶(eventï¼šæ—¶é—´è§¦å‘å™¨)æ˜¯ç”¨äºæ‰§è¡Œå®šæ—¶æˆ–å‘¨æœŸæ€§çš„ä»»åŠ¡ï¼Œç±»ä¼¼Linuxä¸­çš„crontab
  ä½†æ˜¯åè€…åªèƒ½ç²¾ç¡®åˆ°åˆ†é’Ÿï¼Œäº‹ä»¶å¯ä»¥ç²¾ç¡®åˆ°ç§’ã€‚é€šè¿‡å•ç‹¬æˆ–è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ä½¿ç”¨ï¼Œåœ¨æŸä¸€ç‰¹å®šçš„æ—¶é—´ç‚¹ï¼Œè§¦å‘ç›¸å…³çš„SQLè¯­å¥æˆ–å­˜å‚¨è¿‡ç¨‹ã€‚
  äº‹ä»¶ç”±ä¸€ä¸ªç‰¹å®šçš„çº¿ç¨‹æ¥ç®¡ç†çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„äº‹ä»¶è°ƒåº¦å™¨ï¼Œä½†æ˜¯äº‹ä»¶ä¸èƒ½ç›´æ¥è°ƒç”¨ã€‚
</code></pre>
</li>
<li><p>ä½¿ç”¨</p>
<pre><code>  MySQLä¸­è°ƒåº¦å™¨event_schedulerè´Ÿè´£è°ƒç”¨äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯ç”±å…¨å±€å˜é‡event_schedulerçš„çŠ¶æ€å†³å®šï¼Œå®ƒé»˜è®¤æ˜¯OFF, ä¸€èˆ¬æ˜¯OFFã€‚

      æ‰“å¼€ï¼šSET GLOBAL event_scheduler=1/ON
      å…³é—­ï¼šSET GLOBAL event_scheduler=0/OFF
      åˆ›å»ºï¼š
          --è¯­æ³•
              CREATE
                  [DEFINER=&#123;user | CURRENT_USER&#125;]            å¯é€‰ï¼Œç”¨äºå®šä¹‰äº‹ä»¶æ‰§è¡Œæ—¶æ£€æŸ¥æƒé™çš„ç”¨æˆ·
                  EVENT [IF NOT EXISTS] event_name        
                  ON SCHEDULE schedule                    ç”¨äºå®šä¹‰æ‰§è¡Œçš„æ—¶é—´å’Œæ—¶é—´é—´éš”
                  [ON COMPLETION [NOT] PRESERVE]            ç”¨äºå®šä¹‰äº‹ä»¶æ˜¯å¦å¾ªç¯æ‰§è¡Œ
                  [ENABLE | DISABLE | DISABLE ON SLAVE]    ç”¨äºå®šä¹‰äº‹ä»¶æ˜¯å¦æ´»åŠ¨çš„
                  [COMMENT &#39;comment&#39;]                        ç”¨äºå®šä¹‰äº‹ä»¶çš„æ³¨é‡Š
                  DO event_body;                            event_bodyè¡¨ç¤ºSQLï¼Œå­˜å‚¨è¿‡ç¨‹æˆ–è€…begin...end

          --scheduleè¯´æ˜

              AT timestamp [+ INTERVAL interval] ...
              | EVERY interval
                  [STARTS timestamp [+ INTERVAL interval] ...]
                  [ENDS timestamp [+ INTERVAL interval] ...]

          --å‚æ•°è¯´æ˜ï¼š

              ï¼ˆ1ï¼‰timestampï¼šè¡¨ç¤ºä¸€ä¸ªå…·ä½“çš„æ—¶é—´ç‚¹ï¼Œåé¢åŠ ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œè¡¨ç¤ºåœ¨è¿™ä¸ªæ—¶é—´é—´éš”åäº‹ä»¶å‘ç”Ÿã€‚

              ï¼ˆ2ï¼‰EVERYå­å¥ï¼šç”¨äºè¡¨ç¤ºäº‹ä»¶åœ¨æŒ‡å®šæ—¶é—´åŒºé—´å†…æ¯éš”å¤šé•¿æ—¶é—´å‘ç”Ÿä¸€æ¬¡ï¼Œå…¶ä¸­ SELECTå­å¥ç”¨äºæŒ‡å®šå¼€å§‹æ—¶é—´ï¼›
               ENDSå­å¥ç”¨äºæŒ‡å®šç»“æŸæ—¶é—´ã€‚

              ï¼ˆ3ï¼‰intervalï¼šè¡¨ç¤ºä¸€ä¸ªä»ç°åœ¨å¼€å§‹çš„æ—¶é—´ï¼Œå…¶å€¼ç”±ä¸€ä¸ªæ•°å€¼å’Œå•ä½æ„æˆã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨â€œ4 WEEKâ€è¡¨ç¤º4å‘¨ï¼›
               ä½¿ç”¨â€œâ€˜1:10â€™ HOUR_MINUTEâ€è¡¨ç¤º1å°æ—¶10åˆ†é’Ÿã€‚é—´éš”çš„è·ç¦»ç”¨DATE_ADD()å‡½æ•°æ¥æ”¯é…ã€‚

          --intervalå‚æ•°å€¼çš„è¯­æ³•æ ¼å¼ï¼š
              quantity &#123;YEAR | QUARTER | MONTH | DAY | HOUR | MINUTE |
                          WEEK | SECOND | YEAR_MONTH | DAY_HOUR | DAY_MINUTE |
                          DAY_SECOND | HOUR_MINUTE | HOUR_SECOND | MINUTE_SECOND&#125;

          --äº›å¸¸ç”¨çš„æ—¶é—´é—´éš”è®¾ç½®ï¼š

              ï¼ˆ1ï¼‰æ¯éš”5ç§’é’Ÿæ‰§è¡Œ
                      ON SCHEDULE EVERY 5 SECOND
              ï¼ˆ2ï¼‰æ¯éš”1åˆ†é’Ÿæ‰§è¡Œ
                      ON SCHEDULE EVERY 1 MINUTE
              ï¼ˆ3ï¼‰æ¯å¤©å‡Œæ™¨1ç‚¹æ‰§è¡Œ
                      ON SCHEDULE EVERY 1 DAY STARTS DATE_ADD(DATE_ADD(CURDATE(), INTERVAL 1 DAY), 
                      INTERVAL 1 HOUR)
              ï¼ˆ4ï¼‰æ¯ä¸ªæœˆçš„ç¬¬ä¸€å¤©å‡Œæ™¨1ç‚¹æ‰§è¡Œ
                      ON SCHEDULE EVERY 1 MONTH STARTS DATE_ADD(DATE_ADD(DATE_SUB(CURDATE(),
                      INTERVAL DAY(CURDATE())-1 DAY),INTERVAL 1 MONTH),INTERVAL 1 HOUR)

      å¯åŠ¨ä¸å…³é—­: ALTER EVENT event_user ENABLE/DISABLE;        
      åˆ é™¤äº‹ä»¶: DROP EVENT IF EXISTS event_user;        
      ä¿®æ”¹äº‹ä»¶:
              ALTER
                  [DEFINER=&#123;user | CURRENT_USER&#125;]
                  EVENT [IF NOT EXISTS] event_name
                  ON SCHEDULE schedule
                  [ON COMPLETION [NOT] PRESERVE]
                  [ENABLE | DISABLE | DISABLE ON SLAVE]
                  [COMMENT &#39;comment&#39;]
                  DO event_body;
     æŸ¥è¯¢äº‹ä»¶: SELECT * FROM information_schema.events; 
</code></pre>
</li>
<li><p>è¾…åŠ©å‘½ä»¤</p>
<pre><code>  æŸ¥çœ‹äº‹ä»¶è°ƒåº¦å™¨æ˜¯å¦å¼€å¯
          show variables like &#39;%event_scheduler%&#39;;
  æŸ¥çœ‹è°ƒåº¦å™¨çº¿ç¨‹
          show processlist;
</code></pre>
</li>
<li><p>æ³¨æ„äº‹é¡¹</p>
<pre><code>  1 ä¸»åº“å·²æ‰§è¡Œè¿‡ï¼Œä»åº“ä¸ŠåŠ¡å¿…ä¿è¯eventä¸ä¼šæ‰§è¡Œ(é™¤éæ•…æ„åœ¨slaveä¸Šåˆ›å»ºçš„event)
  2 åˆ›å»ºï¼Œåˆ é™¤ç­‰æ“ä½œä¸¥ç¦ç›´æ¥æ“ä½œmysql.eventè¡¨ï¼Œè€Œæ˜¯é€šè¿‡createç­‰æ­£è§„è¯­æ³•å®ç°
  3 åˆ›å»ºçš„eventæ¶‰åŠåˆ°æµ·é‡æ•°æ®å˜æ›´çš„è¯ï¼Œè¦åšå¥½å……åˆ†æµ‹è¯•ï¼Œç¡®ä¿ä¸å½±å“ç°ç½‘æœåŠ¡
  4 å¦‚æœéœ€è¦å¤‡ä»½å¸¦æœ‰eventçš„DBï¼Œmysqldumpæ—¶éœ€è¦åŠ ä¸Š--eventå‚æ•°
</code></pre>
</li>
</ul>
<h2 id="åˆ†åŒº"><a href="#åˆ†åŒº" class="headerlink" title="åˆ†åŒº"></a>åˆ†åŒº</h2><ol>
<li><p>ä»‹ç»</p>
<pre><code> è¡¨åˆ†åŒºï¼Œæ˜¯æŒ‡æ ¹æ®ä¸€å®šè§„åˆ™ï¼Œå°†æ•°æ®åº“ä¸­çš„ä¸€å¼ è¡¨åˆ†è§£æˆå¤šä¸ªæ›´å°çš„ï¼Œå®¹æ˜“ç®¡ç†çš„éƒ¨åˆ†ã€‚
 ä»é€»è¾‘ä¸Šçœ‹ï¼Œåªæœ‰ä¸€å¼ è¡¨ï¼Œä½†æ˜¯åº•å±‚å´æ˜¯ç”±å¤šä¸ªç‰©ç†åˆ†åŒºç»„æˆã€‚
 
</code></pre>
</li>
<li><p>è¡¨åˆ†åŒºä¸åˆ†è¡¨çš„åŒºåˆ«</p>
<pre><code> åˆ†è¡¨ï¼šæŒ‡çš„æ˜¯é€šè¿‡ä¸€å®šè§„åˆ™ï¼Œå°†ä¸€å¼ è¡¨åˆ†è§£æˆå¤šå¼ ä¸åŒçš„è¡¨ã€‚æ¯”å¦‚å°†ç”¨æˆ·è®¢å•è®°å½•æ ¹æ®æ—¶é—´æˆå¤šä¸ªè¡¨ã€‚ 
 åˆ†è¡¨ä¸åˆ†åŒºçš„åŒºåˆ«åœ¨äºï¼šåˆ†åŒºä»é€»è¾‘ä¸Šæ¥è®²åªæœ‰ä¸€å¼ è¡¨ï¼Œè€Œåˆ†è¡¨åˆ™æ˜¯å°†ä¸€å¼ è¡¨åˆ†è§£æˆå¤šå¼ è¡¨ã€‚
</code></pre>
</li>
<li><p>ä¸ºä»€ä¹ˆç”¨åˆ†åŒºè¡¨çš„å°‘</p>
<pre><code> 1 åˆ†åŒºè¡¨ï¼Œåˆ†åŒºé”®è®¾è®¡ä¸å¤ªçµæ´»ï¼Œå¦‚æœä¸èµ°åˆ†åŒºé”®ï¼Œå¾ˆå®¹æ˜“å‡ºç°å…¨è¡¨é”
 2 ä¸€æ—¦æ•°æ®é‡å¹¶å‘é‡ä¸Šæ¥ï¼Œå¦‚æœåœ¨åˆ†åŒºè¡¨å®æ–½å…³è”ï¼Œå°±æ˜¯ä¸€ä¸ªç¾éš¾
 3 è‡ªå·±åˆ†åº“åˆ†è¡¨ï¼Œè‡ªå·±æŒæ§ä¸šåŠ¡åœºæ™¯ä¸è®¿é—®æ¨¡å¼ï¼Œå¯æ§ã€‚åˆ†åŒºè¡¨ï¼Œç ”å‘å†™äº†ä¸€ä¸ªsqlï¼Œéƒ½ä¸ç¡®å®šmysqlæ˜¯æ€ä¹ˆç©çš„ï¼Œä¸å¤ªå¯æ§
 4 è¿ç»´éº»çƒ¦
</code></pre>
</li>
<li><p>åˆ†åŒºè¡¨çš„é™åˆ¶å› ç´ </p>
<pre><code> ï¼ˆ1ï¼‰ä¸€ä¸ªè¡¨æœ€å¤šåªèƒ½æœ‰1024ä¸ªåˆ†åŒºã€‚
 ï¼ˆ2ï¼‰æŸ¥è¯¢æ¡ä»¶é‡Œéœ€åŒ…å«åˆ†åŒºé”®
 ï¼ˆ3ï¼‰åˆ†åŒºé”®å¿…é¡»ä½œä¸ºä¸»é”®çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤åˆ†åŒºé”®å»ºè®®ä¸åŸæ¥è¡¨idä½œä¸ºè”åˆä¸»é”®ã€‚
 ï¼ˆ4ï¼‰åˆ†åŒºè¡¨ä¸­æ— æ³•ä½¿ç”¨å¤–é”®çº¦æŸã€‚
 ï¼ˆ5ï¼‰åˆ†åŒºçš„å­—æ®µï¼Œå¿…é¡»æ˜¯è¡¨ä¸Šæ‰€æœ‰çš„å”¯ä¸€ç´¢å¼•ï¼ˆæˆ–è€…ä¸»é”®ç´¢å¼•ï¼‰åŒ…å«çš„å­—æ®µçš„å­é›†
 ï¼ˆ6ï¼‰rangeåˆ†åŒºï¼šåˆ†åŒºå­—æ®µå¿…é¡»æ˜¯æ•´å‹æˆ–è€…è½¬æ¢ä¸ºæ•´å‹ï¼Œ
</code></pre>
</li>
<li><p>å®ä¾‹ï¼šæ¯æ—¥æŒ‰ç…§æ—¥æœŸå¢åŠ åˆ†åŒº</p>
<pre><code> - æŸ¥çœ‹æ˜¯å¦æ”¯æŒè¡¨åˆ†åŒº
     SHOW VARIABLES LIKE &#39;%partition%&#39;

 - åˆ›å»ºè¡¨
     create table time_partition
     (
         id   int auto_increment,
         data varchar(255) null,
         time datetime     not null,
         primary key (id, time)
     )partition by range (to_days(`time`));

 - æŸ¥è¯¢è¡¨çš„æ‰€æœ‰åˆ†åŒºå
     SELECT a.PARTITION_NAME
     FROM information_schema.PARTITIONS a
     WHERE a.table_name = &#39;time_partition&#39;
     ORDER BY partition_ordinal_position DESC;
     
 - æ·»åŠ æ–°åˆ†åŒº
     alter table time_partition add partition(partition p19800101 values less than (&#39;19800101&#39;))

 - æ›´æ”¹ä¸»é”®
     ALTER TABLE time_partition DROP PRIMARY KEY, ADD PRIMARY KEY (`id`, `insert_time`);

 - æ¯æ—¥è‡ªåŠ¨åˆ›å»ºæ–°åˆ†åŒº
     
</code></pre>
</li>
</ol>
<h2 id="å¤åˆä¸»é”®"><a href="#å¤åˆä¸»é”®" class="headerlink" title="å¤åˆä¸»é”®"></a>å¤åˆä¸»é”®</h2><blockquote>
</blockquote>
<h2 id="å…¶ä»–å‡½æ•°"><a href="#å…¶ä»–å‡½æ•°" class="headerlink" title="å…¶ä»–å‡½æ•°"></a><strong>å…¶ä»–å‡½æ•°</strong></h2><h2 id="å…¶ä»–æŒ‡ä»¤"><a href="#å…¶ä»–æŒ‡ä»¤" class="headerlink" title="å…¶ä»–æŒ‡ä»¤"></a><strong>å…¶ä»–æŒ‡ä»¤</strong></h2><h3 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a><strong>æ•°æ®åº“</strong></h3><table>
<thead>
<tr>
<th>æŒ‡ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>create database db;</td>
<td>åˆ›å»ºæ•°æ®åº“</td>
</tr>
<tr>
<td><code>show databases;</code></td>
<td>åˆ—å‡ºæ•°æ®åº“</td>
</tr>
<tr>
<td><code>use</code> db<code>;</code></td>
<td>åˆ‡æ¢åˆ°æ•°æ®åº“</td>
</tr>
<tr>
<td><code>drop database</code> db<code>;</code></td>
<td>åˆ é™¤æ•°æ®åº“</td>
</tr>
</tbody></table>
<h3 id="æ•°æ®è¡¨"><a href="#æ•°æ®è¡¨" class="headerlink" title="æ•°æ®è¡¨"></a><strong>æ•°æ®è¡¨</strong></h3><table>
<thead>
<tr>
<th>æŒ‡ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>show tables;</code></td>
<td>åˆ—å‡ºå½“å‰æ•°æ®åº“çš„è¡¨</td>
</tr>
<tr>
<td><code>show fields from</code> t<code>;</code></td>
<td>åˆ—å‡ºè¡¨çš„å­—æ®µ</td>
</tr>
<tr>
<td><code>desc</code> t<code>;</code></td>
<td>æ˜¾ç¤ºè¡¨ç»“æ„</td>
</tr>
<tr>
<td><code>show create table t``;</code></td>
<td>æ˜¾ç¤ºåˆ›å»ºè¡¨sql</td>
</tr>
<tr>
<td><code>truncate table t``;</code></td>
<td>åˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®</td>
</tr>
<tr>
<td><code>drop table t``;</code></td>
<td>åˆ é™¤è¡¨</td>
</tr>
</tbody></table>
<h3 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a><strong>è¿›ç¨‹</strong></h3><table>
<thead>
<tr>
<th>æŒ‡ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>kill</code> è¿›ç¨‹å·<code>;</code></td>
<td>æ€æ­»è¿›ç¨‹</td>
</tr>
<tr>
<td><code>show processlist;</code></td>
<td>åˆ—å‡ºè¿›ç¨‹</td>
</tr>
</tbody></table>
<h3 id="å…¶ä»–-1"><a href="#å…¶ä»–-1" class="headerlink" title="å…¶ä»–"></a><strong>å…¶ä»–</strong></h3><blockquote>
<p>è·³è¿‡è¡Œçš„åç§»é‡å¹¶è¿”å›æ¥ä¸‹æ¥çš„ n è¡Œ</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT c1, c2 FROM t</span><br><span class="line">ORDER BY c1 </span><br><span class="line">LIMIT n OFFSET offset</span><br></pre></td></tr></table></figure>

<h2 id="CSVå­˜å‚¨å¼•æ“çš„ä½¿ç”¨"><a href="#CSVå­˜å‚¨å¼•æ“çš„ä½¿ç”¨" class="headerlink" title="CSVå­˜å‚¨å¼•æ“çš„ä½¿ç”¨"></a><strong>CSVå­˜å‚¨å¼•æ“çš„ä½¿ç”¨</strong></h2><p>ä½¿ç”¨åœºæ™¯ï¼šä½œä¸ºä¸­é—´è¡¨</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">I'm so cute. Please give me money.</div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>å¾é‘«</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://example.com/2022/10/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/" title="mysql">http://example.com/2022/10/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2022/12/28/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E6%9C%AC%E5%86%85%E5%AE%B9/" rel="prev" title="å‰ç«¯åŸºæœ¬å†…å®¹"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">å‰ç«¯åŸºæœ¬å†…å®¹</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/10/20/javaweb/spring/" rel="next" title="spring"><span class="post-nav-text">spring</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2023 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> å¾é‘«</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script src="/js/markmap.js"></script></body></html>